var jb=Object.defineProperty;var qb=(i,t,e)=>t in i?jb(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var ua=(i,t,e)=>qb(i,typeof t!="symbol"?t+"":t,e);import{r as zn,_ as _s,o as Ri,c as Hn,a as hg,d as Va,b as jt,e as fr,F as Jb,f as Qb,n as lg,g as Yu,t as tE,w as Xf,h as Zf,i as eE,j as iE,k as nE,l as yl,m as vl}from"./index-Bjgywmgn.js";const V={toURL(i,t){let e=encodeURIComponent(i);return t==="text"?e="data:text/plain;charset=utf-8,"+e:t==="svg"&&(e="data:image/svg+xml,"+e),e},image:{hitCanvasSize:100,maxCacheSize:2560*1600,maxPatternSize:4096*2160,crossOrigin:"anonymous",getRealURL(i){const{prefix:t,suffix:e}=V.image;return e&&!i.startsWith("data:")&&!i.startsWith("blob:")&&(i+=(i.includes("?")?"&":"?")+e),t&&i[0]==="/"&&(i=t+i),i}}},qt={},pn={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(i){const{types:t}=rE;return t[i]?t[i]++:(t[i]=1,0)}},rE=pn,{round:sE,pow:oE,PI:Xu}=Math,fe={within(i,t,e){return typeof t=="object"&&(e=t.max,t=t.min),t!==void 0&&i<t&&(i=t),e!==void 0&&i>e&&(i=e),i},fourNumber(i,t){let e;if(i instanceof Array)switch(i.length){case 4:e=t===void 0?i:[...i];break;case 2:e=[i[0],i[1],i[0],i[1]];break;case 3:e=[i[0],i[1],i[2],i[1]];break;case 1:i=i[0];break;default:i=0}if(e||(e=[i,i,i,i]),t)for(let n=0;n<4;n++)e[n]>t&&(e[n]=t);return e},formatRotation(i,t){return i%=360,t?i<0&&(i+=360):(i>180&&(i-=360),i<-180&&(i+=360)),fe.float(i)},getGapRotation(i,t,e=0){let n=i+e;if(t>1){const o=Math.abs(n%t);(o<1||o>t-1)&&(n=Math.round(n/t)*t)}return n-e},float(i,t){const e=t?oE(10,t):1e12;return i=sE(i*e)/e,i===-0?0:i},getScaleData(i,t,e,n){return n||(n={}),t?(n.scaleX=(typeof t=="number"?t:t.width)/e.width,n.scaleY=(typeof t=="number"?t:t.height)/e.height):i&&fe.assignScale(n,i),n},assignScale(i,t){typeof t=="number"?i.scaleX=i.scaleY=t:(i.scaleX=t.x,i.scaleY=t.y)}},kt=Xu/180,di=Xu*2,ts=Xu/2;function Zu(){return{x:0,y:0}}function ug(){return{x:0,y:0,width:0,height:0}}function $a(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:ml,cos:wl,acos:ca,sqrt:xl}=Math,{float:Hr}=fe,Nr={};function Kf(){return Object.assign(Object.assign(Object.assign({},$a()),ug()),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const ot={defaultMatrix:$a(),defaultWorld:Kf(),tempMatrix:{},set(i,t=1,e=0,n=0,o=1,a=0,h=0){i.a=t,i.b=e,i.c=n,i.d=o,i.e=a,i.f=h},get:$a,getWorld:Kf,copy(i,t){i.a=t.a,i.b=t.b,i.c=t.c,i.d=t.d,i.e=t.e,i.f=t.f},translate(i,t,e){i.e+=t,i.f+=e},translateInner(i,t,e,n){i.e+=i.a*t+i.c*e,i.f+=i.b*t+i.d*e,n&&(i.e-=t,i.f-=e)},scale(i,t,e=t){i.a*=t,i.b*=t,i.c*=e,i.d*=e},scaleOfOuter(i,t,e,n){Ut.toInnerPoint(i,t,Nr),Ut.scaleOfInner(i,Nr,e,n)},scaleOfInner(i,t,e,n=e){Ut.translateInner(i,t.x,t.y),Ut.scale(i,e,n),Ut.translateInner(i,-t.x,-t.y)},rotate(i,t){const{a:e,b:n,c:o,d:a}=i;t*=kt;const h=wl(t),u=ml(t);i.a=e*h-n*u,i.b=e*u+n*h,i.c=o*h-a*u,i.d=o*u+a*h},rotateOfOuter(i,t,e){Ut.toInnerPoint(i,t,Nr),Ut.rotateOfInner(i,Nr,e)},rotateOfInner(i,t,e){Ut.translateInner(i,t.x,t.y),Ut.rotate(i,e),Ut.translateInner(i,-t.x,-t.y)},skew(i,t,e){const{a:n,b:o,c:a,d:h}=i;e&&(e*=kt,i.a=n+a*e,i.b=o+h*e),t&&(t*=kt,i.c=a+n*t,i.d=h+o*t)},skewOfOuter(i,t,e,n){Ut.toInnerPoint(i,t,Nr),Ut.skewOfInner(i,Nr,e,n)},skewOfInner(i,t,e,n=0){Ut.translateInner(i,t.x,t.y),Ut.skew(i,e,n),Ut.translateInner(i,-t.x,-t.y)},multiply(i,t){const{a:e,b:n,c:o,d:a,e:h,f:u}=i;i.a=t.a*e+t.b*o,i.b=t.a*n+t.b*a,i.c=t.c*e+t.d*o,i.d=t.c*n+t.d*a,i.e=t.e*e+t.f*o+h,i.f=t.e*n+t.f*a+u},multiplyParent(i,t,e,n,o,a){let{e:h,f:u}=i;if(a&&(h+=a.scrollX,u+=a.scrollY),e||(e=i),n===void 0&&(n=i.a!==1||i.b||i.c||i.d!==1),n){const{a:d,b:f,c:y,d:x}=i;e.a=d*t.a+f*t.c,e.b=d*t.b+f*t.d,e.c=y*t.a+x*t.c,e.d=y*t.b+x*t.d,o&&(e.scaleX=t.scaleX*o.scaleX,e.scaleY=t.scaleY*o.scaleY)}else e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,o&&(e.scaleX=t.scaleX,e.scaleY=t.scaleY);e.e=h*t.a+u*t.c+t.e,e.f=h*t.b+u*t.d+t.f},divide(i,t){Ut.multiply(i,Ut.tempInvert(t))},divideParent(i,t){Ut.multiplyParent(i,Ut.tempInvert(t))},tempInvert(i){const{tempMatrix:t}=Ut;return Ut.copy(t,i),Ut.invert(t),t},invert(i){const{a:t,b:e,c:n,d:o,e:a,f:h}=i;if(!e&&!n)if(t===1&&o===1)i.e=-a,i.f=-h;else{const u=1/(t*o);i.a=o*u,i.d=t*u,i.e=-a*o*u,i.f=-h*t*u}else{const u=1/(t*o-e*n);i.a=o*u,i.b=-e*u,i.c=-n*u,i.d=t*u,i.e=-(a*o-h*n)*u,i.f=-(h*t-a*e)*u}},toOuterPoint(i,t,e,n){const{x:o,y:a}=t;e||(e=t),e.x=o*i.a+a*i.c,e.y=o*i.b+a*i.d,n||(e.x+=i.e,e.y+=i.f)},toInnerPoint(i,t,e,n){const{a:o,b:a,c:h,d:u}=i,d=1/(o*u-a*h),{x:f,y}=t;if(e||(e=t),e.x=(f*u-y*h)*d,e.y=(y*o-f*a)*d,!n){const{e:x,f:E}=i;e.x-=(x*u-E*h)*d,e.y-=(E*o-x*a)*d}},setLayout(i,t,e,n,o){const{x:a,y:h,scaleX:u,scaleY:d}=t;if(o===void 0&&(o=t.rotation||t.skewX||t.skewY),o){const{rotation:f,skewX:y,skewY:x}=t,E=f*kt,m=wl(E),S=ml(E);if(y||x){const B=y*kt,P=x*kt;i.a=(m+P*-S)*u,i.b=(S+P*m)*u,i.c=(-S+B*m)*d,i.d=(m+B*S)*d}else i.a=m*u,i.b=S*u,i.c=-S*d,i.d=m*d}else i.a=u,i.b=0,i.c=0,i.d=d;i.e=a,i.f=h,(e=e||n)&&Ut.translateInner(i,-e.x,-e.y,!n)},getLayout(i,t,e,n){const{a:o,b:a,c:h,d:u,e:d,f}=i;let y=d,x=f,E,m,S,B,P;if(a||h){const $=o*u-a*h;if(h&&!n){E=xl(o*o+a*a),m=$/E;const L=o/E;S=a>0?ca(L):-ca(L)}else{m=xl(h*h+u*u),E=$/m;const L=h/m;S=ts-(u>0?ca(-L):-ca(L))}const I=Hr(wl(S)),F=ml(S);E=Hr(E),m=Hr(m),B=I?Hr((h/m+F)/I/kt,9):0,P=I?Hr((a/E-F)/I/kt,9):0,S=Hr(S/kt)}else E=o,m=u,S=B=P=0;return(t=e||t)&&(y+=t.x*o+t.y*h,x+=t.x*a+t.y*u,e||(y-=t.x,x-=t.y)),{x:y,y:x,scaleX:E,scaleY:m,rotation:S,skewX:B,skewY:P}},withScale(i,t,e=t){const n=i;if(!t||!e){const{a:o,b:a,c:h,d:u}=i;a||h?(t=xl(o*o+a*a),e=(o*u-a*h)/t):(t=o,e=u)}return n.scaleX=t,n.scaleY=e,n},reset(i){Ut.set(i)}},Ut=ot,{toInnerPoint:bl,toOuterPoint:jf}=ot,{sin:qf,cos:Jf,abs:Qf,sqrt:aE,atan2:El,min:hE,PI:lE}=Math,rt={defaultPoint:Zu(),tempPoint:{},tempRadiusPoint:{},set(i,t=0,e=0){i.x=t,i.y=e},setRadius(i,t,e){i.radiusX=t,i.radiusY=e===void 0?t:e},copy(i,t){i.x=t.x,i.y=t.y},copyFrom(i,t,e){i.x=t,i.y=e},move(i,t,e){i.x+=t,i.y+=e},scale(i,t,e=t){i.x&&(i.x*=t),i.y&&(i.y*=e)},scaleOf(i,t,e,n=e){i.x+=(i.x-t.x)*(e-1),i.y+=(i.y-t.y)*(n-1)},rotate(i,t,e){e||(e=ur.defaultPoint),t*=kt;const n=Jf(t),o=qf(t),a=i.x-e.x,h=i.y-e.y;i.x=e.x+a*n-h*o,i.y=e.y+a*o+h*n},tempToInnerOf(i,t){const{tempPoint:e}=ur;return Sl(e,i),bl(t,e,e),e},tempToOuterOf(i,t){const{tempPoint:e}=ur;return Sl(e,i),jf(t,e,e),e},tempToInnerRadiusPointOf(i,t){const{tempRadiusPoint:e}=ur;return Sl(e,i),ur.toInnerRadiusPointOf(i,t,e),e},toInnerRadiusPointOf(i,t,e){e||(e=i),bl(t,i,e),e.radiusX=Math.abs(i.radiusX/t.scaleX),e.radiusY=Math.abs(i.radiusY/t.scaleY)},toInnerOf(i,t,e){bl(t,i,e)},toOuterOf(i,t,e){jf(t,i,e)},getCenter(i,t){return{x:i.x+(t.x-i.x)/2,y:i.y+(t.y-i.y)/2}},getCenterX(i,t){return i+(t-i)/2},getCenterY(i,t){return i+(t-i)/2},getDistance(i,t){return Cl(i.x,i.y,t.x,t.y)},getDistanceFrom(i,t,e,n){const o=Qf(e-i),a=Qf(n-t);return aE(o*o+a*a)},getMinDistanceFrom(i,t,e,n,o,a){return hE(Cl(i,t,e,n),Cl(e,n,o,a))},getAngle(i,t){return t_(i,t)/kt},getRotation(i,t,e,n){return n||(n=t),ur.getRadianFrom(i.x,i.y,t.x,t.y,e.x,e.y,n.x,n.y)/kt},getRadianFrom(i,t,e,n,o,a,h,u){h===void 0&&(h=e,u=n);let d=El(t-n,i-e);const y=El(a-u,o-h)-d;return y<-lE?y+di:y},getAtan2(i,t){return El(t.y-i.y,t.x-i.x)},getDistancePoint(i,t,e,n){const o=t_(i,t);return t=n?t:{},t.x=i.x+Jf(o)*e,t.y=i.y+qf(o)*e,t},toNumberPoints(i){let t=i;return typeof i[0]=="object"&&(t=[],i.forEach(e=>t.push(e.x,e.y))),t},reset(i){}},ur=rt,{getDistanceFrom:Cl,copy:Sl,getAtan2:t_}=ur;class eo{constructor(t,e){this.set(t,e)}set(t,e){return typeof t=="object"?rt.copy(this,t):rt.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new eo(this)}move(t,e){return rt.move(this,t,e),this}scale(t,e){return rt.scale(this,t,e),this}scaleOf(t,e,n){return rt.scaleOf(this,t,e,n),this}rotate(t,e){return rt.rotate(this,t,e),this}rotateOf(t,e){return rt.rotate(this,e,t),this}getRotation(t,e,n){return rt.getRotation(this,t,e,n)}toInnerOf(t,e){return rt.toInnerOf(this,t,e),this}toOuterOf(t,e){return rt.toOuterOf(this,t,e),this}getCenter(t){return new eo(rt.getCenter(this,t))}getDistance(t){return rt.getDistance(this,t)}getDistancePoint(t,e,n){return new eo(rt.getDistancePoint(this,t,e,n))}getAngle(t){return rt.getAngle(this,t)}getAtan2(t){return rt.getAtan2(this,t)}reset(){return this}}new eo;class ze{constructor(t,e,n,o,a,h){this.set(t,e,n,o,a,h)}set(t,e,n,o,a,h){return typeof t=="object"?ot.copy(this,t):ot.set(this,t,e,n,o,a,h),this}setWith(t){return ot.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:n,d:o,e:a,f:h}=this;return{a:t,b:e,c:n,d:o,e:a,f:h}}clone(){return new ze(this)}translate(t,e){return ot.translate(this,t,e),this}translateInner(t,e){return ot.translateInner(this,t,e),this}scale(t,e){return ot.scale(this,t,e),this}scaleWith(t,e){return ot.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,n){return ot.scaleOfOuter(this,t,e,n),this}scaleOfInner(t,e,n){return ot.scaleOfInner(this,t,e,n),this}rotate(t){return ot.rotate(this,t),this}rotateOfOuter(t,e){return ot.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return ot.rotateOfInner(this,t,e),this}skew(t,e){return ot.skew(this,t,e),this}skewOfOuter(t,e,n){return ot.skewOfOuter(this,t,e,n),this}skewOfInner(t,e,n){return ot.skewOfInner(this,t,e,n),this}multiply(t){return ot.multiply(this,t),this}multiplyParent(t){return ot.multiplyParent(this,t),this}divide(t){return ot.divide(this,t),this}divideParent(t){return ot.divideParent(this,t),this}invert(){return ot.invert(this),this}invertWith(){return ot.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,n){ot.toOuterPoint(this,t,e,n)}toInnerPoint(t,e,n){ot.toInnerPoint(this,t,e,n)}setLayout(t,e,n){return ot.setLayout(this,t,e,n),this}getLayout(t,e,n){return ot.getLayout(this,t,e,n)}withScale(t,e){return ot.withScale(this,t,e)}reset(){ot.reset(this)}}new ze;const co={tempPointBounds:{},setPoint(i,t,e){i.minX=i.maxX=t,i.minY=i.maxY=e},addPoint(i,t,e){i.minX=t<i.minX?t:i.minX,i.minY=e<i.minY?e:i.minY,i.maxX=t>i.maxX?t:i.maxX,i.maxY=e>i.maxY?e:i.maxY},addBounds(i,t,e,n,o){e_(i,t,e),e_(i,t+n,e+o)},copy(i,t){i.minX=t.minX,i.minY=t.minY,i.maxX=t.maxX,i.maxY=t.maxY},addPointBounds(i,t){i.minX=t.minX<i.minX?t.minX:i.minX,i.minY=t.minY<i.minY?t.minY:i.minY,i.maxX=t.maxX>i.maxX?t.maxX:i.maxX,i.maxY=t.maxY>i.maxY?t.maxY:i.maxY},toBounds(i,t){t.x=i.minX,t.y=i.minY,t.width=i.maxX-i.minX,t.height=i.maxY-i.minY}},{addPoint:e_}=co,{tempPointBounds:In,setPoint:i_,addPoint:da,toBounds:n_}=co,{toOuterPoint:fa}=ot,{float:_a,fourNumber:uE}=fe,{floor:r_,ceil:pa}=Math;let $i,zi,nr,rr;const an={},hi={},q={tempBounds:{},set(i,t=0,e=0,n=0,o=0){i.x=t,i.y=e,i.width=n,i.height=o},copy(i,t){i.x=t.x,i.y=t.y,i.width=t.width,i.height=t.height},copyAndSpread(i,t,e,n,o){const{x:a,y:h,width:u,height:d}=t;if(e instanceof Array){const f=uE(e);n?bt.set(i,a+f[3],h+f[0],u-f[1]-f[3],d-f[2]-f[0]):bt.set(i,a-f[3],h-f[0],u+f[1]+f[3],d+f[2]+f[0])}else n&&(e=-e),bt.set(i,a-e,h-e,u+e*2,d+e*2);o&&(o==="width"?(i.y=h,i.height=d):(i.x=a,i.width=u))},minX(i){return i.width>0?i.x:i.x+i.width},minY(i){return i.height>0?i.y:i.y+i.height},maxX(i){return i.width>0?i.x+i.width:i.x},maxY(i){return i.height>0?i.y+i.height:i.y},move(i,t,e){i.x+=t,i.y+=e},getByMove(i,t,e){return i=Object.assign({},i),bt.move(i,t,e),i},toOffsetOutBounds(i,t,e){t?o_(t,i):t=i,e?(t.offsetX=-(bt.maxX(e)-i.x),t.offsetY=-(bt.maxY(e)-i.y)):(t.offsetX=i.x+i.width,t.offsetY=i.y+i.height),bt.move(t,-t.offsetX,-t.offsetY)},scale(i,t,e=t){rt.scale(i,t,e),i.width*=t,i.height*=e},scaleOf(i,t,e,n=e){rt.scaleOf(i,t,e,n),i.width*=e,i.height*=n},tempToOuterOf(i,t){return bt.copy(bt.tempBounds,i),bt.toOuterOf(bt.tempBounds,t),bt.tempBounds},getOuterOf(i,t){return i=Object.assign({},i),bt.toOuterOf(i,t),i},toOuterOf(i,t,e){if(e||(e=i),t.b===0&&t.c===0){const{a:n,d:o}=t;n>0?(e.width=i.width*n,e.x=t.e+i.x*n):(e.width=i.width*-n,e.x=t.e+i.x*n-e.width),o>0?(e.height=i.height*o,e.y=t.f+i.y*o):(e.height=i.height*-o,e.y=t.f+i.y*o-e.height)}else an.x=i.x,an.y=i.y,fa(t,an,hi),i_(In,hi.x,hi.y),an.x=i.x+i.width,fa(t,an,hi),da(In,hi.x,hi.y),an.y=i.y+i.height,fa(t,an,hi),da(In,hi.x,hi.y),an.x=i.x,fa(t,an,hi),da(In,hi.x,hi.y),n_(In,e)},toInnerOf(i,t,e){e||(e=i),bt.move(e,-t.e,-t.f),bt.scale(e,1/t.a,1/t.d)},getFitMatrix(i,t,e=1){const n=Math.min(e,Math.min(i.width/t.width,i.height/t.height));return new ze(n,0,0,n,-t.x*n,-t.y*n)},getSpread(i,t,e){const n={};return bt.copyAndSpread(n,i,t,!1,e),n},spread(i,t,e){bt.copyAndSpread(i,i,t,!1,e)},shrink(i,t,e){bt.copyAndSpread(i,i,t,!0,e)},ceil(i){const{x:t,y:e}=i;i.x=r_(i.x),i.y=r_(i.y),i.width=t>i.x?pa(i.width+t-i.x):pa(i.width),i.height=e>i.y?pa(i.height+e-i.y):pa(i.height)},unsign(i){i.width<0&&(i.x+=i.width,i.width=-i.width),i.height<0&&(i.y+=i.height,i.height=-i.height)},float(i,t){i.x=_a(i.x,t),i.y=_a(i.y,t),i.width=_a(i.width,t),i.height=_a(i.height,t)},add(i,t,e){$i=i.x+i.width,zi=i.y+i.height,nr=t.x,rr=t.y,e||(nr+=t.width,rr+=t.height),$i=$i>nr?$i:nr,zi=zi>rr?zi:rr,i.x=i.x<t.x?i.x:t.x,i.y=i.y<t.y?i.y:t.y,i.width=$i-i.x,i.height=zi-i.y},addList(i,t){bt.setListWithFn(i,t,void 0,!0)},setList(i,t,e=!1){bt.setListWithFn(i,t,void 0,e)},addListWithFn(i,t,e){bt.setListWithFn(i,t,e,!0)},setListWithFn(i,t,e,n=!1){let o,a=!0;for(let h=0,u=t.length;h<u;h++)o=e?e(t[h]):t[h],o&&(o.width||o.height)&&(a?(a=!1,n||o_(i,o)):s_(i,o));a&&bt.reset(i)},setPoints(i,t){t.forEach((e,n)=>n===0?i_(In,e.x,e.y):da(In,e.x,e.y)),n_(In,i)},setPoint(i,t){bt.set(i,t.x,t.y)},addPoint(i,t){s_(i,t,!0)},getPoints(i){const{x:t,y:e,width:n,height:o}=i;return[{x:t,y:e},{x:t+n,y:e},{x:t+n,y:e+o},{x:t,y:e+o}]},hitRadiusPoint(i,t,e){return e&&(t=rt.tempToInnerRadiusPointOf(t,e)),t.x>=i.x-t.radiusX&&t.x<=i.x+i.width+t.radiusX&&t.y>=i.y-t.radiusY&&t.y<=i.y+i.height+t.radiusY},hitPoint(i,t,e){return e&&(t=rt.tempToInnerOf(t,e)),t.x>=i.x&&t.x<=i.x+i.width&&t.y>=i.y&&t.y<=i.y+i.height},hit(i,t,e){return e&&(t=bt.tempToOuterOf(t,e)),!(i.y+i.height<t.y||t.y+t.height<i.y||i.x+i.width<t.x||t.x+t.width<i.x)},includes(i,t,e){return e&&(t=bt.tempToOuterOf(t,e)),i.x<=t.x&&i.y<=t.y&&i.x+i.width>=t.x+t.width&&i.y+i.height>=t.y+t.height},getIntersectData(i,t,e){if(e&&(t=bt.tempToOuterOf(t,e)),!bt.hit(i,t))return ug();let{x:n,y:o,width:a,height:h}=t;return $i=n+a,zi=o+h,nr=i.x+i.width,rr=i.y+i.height,n=n>i.x?n:i.x,o=o>i.y?o:i.y,$i=$i<nr?$i:nr,zi=zi<rr?zi:rr,a=$i-n,h=zi-o,{x:n,y:o,width:a,height:h}},intersect(i,t,e){bt.copy(i,bt.getIntersectData(i,t,e))},isSame(i,t){return i.x===t.x&&i.y===t.y&&i.width===t.width&&i.height===t.height},isEmpty(i){return i.x===0&&i.y===0&&i.width===0&&i.height===0},reset(i){bt.set(i)}},bt=q,{add:s_,copy:o_}=bt;class zt{get minX(){return q.minX(this)}get minY(){return q.minY(this)}get maxX(){return q.maxX(this)}get maxY(){return q.maxY(this)}constructor(t,e,n,o){this.set(t,e,n,o)}set(t,e,n,o){return typeof t=="object"?q.copy(this,t):q.set(this,t,e,n,o),this}get(){const{x:t,y:e,width:n,height:o}=this;return{x:t,y:e,width:n,height:o}}clone(){return new zt(this)}move(t,e){return q.move(this,t,e),this}scale(t,e){return q.scale(this,t,e),this}scaleOf(t,e,n){return q.scaleOf(this,t,e,n),this}toOuterOf(t,e){return q.toOuterOf(this,t,e),this}toInnerOf(t,e){return q.toInnerOf(this,t,e),this}getFitMatrix(t,e){return q.getFitMatrix(this,t,e)}spread(t,e){return q.spread(this,t,e),this}shrink(t,e){return q.shrink(this,t,e),this}ceil(){return q.ceil(this),this}unsign(){return q.unsign(this),this}float(t){return q.float(this,t),this}add(t){return q.add(this,t),this}addList(t){return q.setList(this,t,!0),this}setList(t){return q.setList(this,t),this}addListWithFn(t,e){return q.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return q.setListWithFn(this,t,e),this}setPoint(t){return q.setPoint(this,t),this}setPoints(t){return q.setPoints(this,t),this}addPoint(t){return q.addPoint(this,t),this}getPoints(){return q.getPoints(this)}hitPoint(t,e){return q.hitPoint(this,t,e)}hitRadiusPoint(t,e){return q.hitRadiusPoint(this,t,e)}hit(t,e){return q.hit(this,t,e)}includes(t,e){return q.includes(this,t,e)}intersect(t,e){return q.intersect(this,t,e),this}getIntersect(t,e){return new zt(q.getIntersectData(this,t,e))}isSame(t){return q.isSame(this,t)}isEmpty(){return q.isEmpty(this)}reset(){q.reset(this)}}const Lt=new zt;class cE{constructor(t,e,n,o,a,h){typeof t=="object"?this.copy(t):this.set(t,e,n,o,a,h)}set(t=0,e=0,n=0,o=0,a=0,h=0){this.top=t,this.right=e,this.bottom=n,this.left=o,this.width=a,this.height=h}copy(t){const{top:e,right:n,bottom:o,left:a,width:h,height:u}=t;this.set(e,n,o,a,h,u)}getBoundsFrom(t){const{top:e,right:n,bottom:o,left:a,width:h,height:u}=this;return new zt(a,e,h||t.width-a-n,u||t.height-e-o)}}var Lu;(function(i){i[i.top=0]="top",i[i.right=1]="right",i[i.bottom=2]="bottom",i[i.left=3]="left"})(Lu||(Lu={}));var as;(function(i){i[i.topLeft=0]="topLeft",i[i.top=1]="top",i[i.topRight=2]="topRight",i[i.right=3]="right",i[i.bottomRight=4]="bottomRight",i[i.bottom=5]="bottom",i[i.bottomLeft=6]="bottomLeft",i[i.left=7]="left",i[i.center=8]="center",i[i["top-left"]=0]="top-left",i[i["top-right"]=2]="top-right",i[i["bottom-right"]=4]="bottom-right",i[i["bottom-left"]=6]="bottom-left"})(as||(as={}));const Ku=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];Ku.forEach(i=>i.type="percent");const gn={directionData:Ku,tempPoint:{},get:a_,toPoint(i,t,e,n,o){const a=a_(i);e.x=a.x,e.y=a.y,a.type==="percent"&&(e.x*=t.width,e.y*=t.height,o&&(e.x-=o.x,e.y-=o.y,a.x&&(e.x-=a.x===1?o.width:a.x===.5?a.x*o.width:0),a.y&&(e.y-=a.y===1?o.height:a.y===.5?a.y*o.height:0))),n||(e.x+=t.x,e.y+=t.y)}};function a_(i){return typeof i=="string"?Ku[as[i]]:i}const{toPoint:dE}=gn,fE={toPoint(i,t,e,n,o){dE(i,e,n,o,t)}},_E={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1};class Tt{constructor(t){this.repeatMap={},this.name=t}static get(t){return new Tt(t)}static set filter(t){this.filterList=h_(t)}static set exclude(t){this.excludeList=h_(t)}log(...t){if(sr.enable){if(sr.filterList.length&&sr.filterList.every(e=>e!==this.name)||sr.excludeList.length&&sr.excludeList.some(e=>e===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){sr.enable&&this.warn(...t)}warn(...t){sr.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}Tt.filterList=[];Tt.excludeList=[];Tt.showWarn=!0;function h_(i){return i?typeof i=="string"&&(i=[i]):i=[],i}const sr=Tt,pE=Tt.get("RunTime"),Li={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(i,t){const e=pn.create(pn.RUNTIME);return li.currentId=li.idMap[e]=t?performance.now():Date.now(),li.currentName=li.nameMap[e]=i,li.nameToIdMap[i]=e,e},end(i,t){const e=li.idMap[i],n=li.nameMap[i],o=t?(performance.now()-e)/1e3:Date.now()-e;li.idMap[i]=li.nameMap[i]=li.nameToIdMap[n]=void 0,pE.log(n,o,"ms")},endOfName(i,t){const e=li.nameToIdMap[i];e!==void 0&&li.end(e,t)}},li=Li;function hs(i){console.error("need plugin: @leafer-in/"+i)}const gE=Tt.get("UICreator"),Ya={list:{},register(i){const{__tag:t}=i.prototype;Tl[t]?gE.repeat(t):Tl[t]=i},get(i,t,e,n,o,a){const h=new Tl[i](t);return e!==void 0&&(h.x=e,n&&(h.y=n),o&&(h.width=o),a&&(h.height=a)),h}},{list:Tl}=Ya,yE=Tt.get("EventCreator"),ls={nameList:{},register(i){let t;Object.keys(i).forEach(e=>{t=i[e],typeof t=="string"&&(Ms[t]?yE.repeat(t):Ms[t]=i)})},changeName(i,t){const e=Ms[i];if(e){const n=Object.keys(e).find(o=>e[o]===i);n&&(e[n]=t,Ms[t]=e)}},has(i){return!!this.nameList[i]},get(i,...t){return new Ms[i](...t)}},{nameList:Ms}=ls;class cg{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let e;const{list:n}=this;for(let a=0,h=n.length;a<h;a++)if(e=n[a],e.recycled&&e.isSameSize(t))return e.recycled=!1,e.manager||(e.manager=this),e;const o=qt.canvas(t);return this.add(o),o}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let n=0,o=this.list.length;n<o;n++)t=this.list[n],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}}const ie={default(i,t){return Rl(t,i),Rl(i,t),i},assign(i,t){let e;Object.keys(t).forEach(n=>{var o;e=t[n],(e==null?void 0:e.constructor)===Object&&((o=i[n])===null||o===void 0?void 0:o.constructor)===Object?Rl(i[n],t[n]):i[n]=t[n]})},copyAttrs(i,t,e){return e.forEach(n=>{t[n]!==void 0&&(i[n]=t[n])}),i},clone(i){return JSON.parse(JSON.stringify(i))},toMap(i){const t={};for(let e=0,n=i.length;e<n;e++)t[i[e]]=!0;return t}},{assign:Rl}=ie;class dg{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&t.length===6&&t[0]===1}get __blendMode(){if(this.eraser&&this.eraser!=="path")return"destination-out";const{blendMode:t}=this;return t==="pass-through"?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let n;for(let o in this)o[0]!=="_"&&(n=e?e[o]:void 0,t[o]=n===void 0?this[o]:n);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}if(!(t==="path"&&!this.__pathInputed))return this["_"+t]}__removeInput(t){this.__input&&this.__input[t]!==void 0&&(this.__input[t]=void 0)}__getInputData(t,e){const n={};if(t)if(t instanceof Array)for(let o of t)n[o]=this.__getInput(o);else for(let o in t)n[o]=this.__getInput(o);else{let o,a,{__input:h}=this;n.tag=this.__leaf.tag;for(let u in this)if(u[0]!=="_"&&(o=this["_"+u],o!==void 0)){if(u==="path"&&!this.__pathInputed)continue;a=h?h[u]:void 0,n[u]=a===void 0?o:a}}if(e&&e.matrix){const{a:o,b:a,c:h,d:u,e:d,f}=this.__leaf.__localMatrix;n.matrix={a:o,b:a,c:h,d:u,e:d,f}}return n}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if(t.blendMode==="pass-through"){const e=this.__leaf;t.opacity<1&&e.isBranch||e.__hasEraser||t.eraser?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}var za;(function(i){i[i.No=0]="No",i[i.Yes=1]="Yes",i[i.NoAndSkip=2]="NoAndSkip",i[i.YesAndSkip=3]="YesAndSkip"})(za||(za={}));function X(i,t,e,n){var o=arguments.length,a=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(h=i[u])&&(a=(o<3?h(a):o>3?h(t,e,a):h(t,e))||a);return o>3&&a&&Object.defineProperty(t,e,a),a}function fg(i,t,e,n){function o(a){return a instanceof e?a:new e(function(h){h(a)})}return new(e||(e=Promise))(function(a,h){function u(y){try{f(n.next(y))}catch(x){h(x)}}function d(y){try{f(n.throw(y))}catch(x){h(x)}}function f(y){y.done?a(y.value):o(y.value).then(u,d)}f((n=n.apply(i,[])).next())})}function Ht(i){return(t,e)=>{i||(i=e),Object.defineProperty(t,e,{get(){return this.context[i]},set(n){this.context[i]=n}})}}const _g=[];function wt(){return(i,t)=>{_g.push(t)}}const vE=[];let K=class{set blendMode(t){t==="normal"&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||vE)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;_g.forEach(e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,e,n,o,a,h){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,n,o,a,h){typeof t=="object"?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,n,o,a,h)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,n,o){}strokeRect(t,e,n,o){}clearRect(t,e,n,o){}drawImage(t,e,n,o,a,h,u,d,f){switch(arguments.length){case 9:if(e<0){const y=-e/o*d;o+=e,e=0,h+=y,d-=y}if(n<0){const y=-n/a*f;a+=n,n=0,u+=y,f-=y}this.context.drawImage(t,e,n,o,a,h,u,d,f);break;case 5:this.context.drawImage(t,e,n,o,a);break;case 3:this.context.drawImage(t,e,n)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,n,o,a,h){}quadraticCurveTo(t,e,n,o){}closePath(){}arc(t,e,n,o,a,h){}arcTo(t,e,n,o,a){}ellipse(t,e,n,o,a,h,u,d){}rect(t,e,n,o){}roundRect(t,e,n,o,a){}createConicGradient(t,e,n){}createLinearGradient(t,e,n,o){}createPattern(t,e){}createRadialGradient(t,e,n,o,a,h){}fillText(t,e,n,o){}measureText(t){}strokeText(t,e,n,o){}destroy(){this.context=null}};X([Ht("imageSmoothingEnabled")],K.prototype,"smooth",void 0);X([Ht("imageSmoothingQuality")],K.prototype,"smoothLevel",void 0);X([Ht("globalAlpha")],K.prototype,"opacity",void 0);X([Ht()],K.prototype,"fillStyle",void 0);X([Ht()],K.prototype,"strokeStyle",void 0);X([Ht("lineWidth")],K.prototype,"strokeWidth",void 0);X([Ht("lineCap")],K.prototype,"strokeCap",void 0);X([Ht("lineJoin")],K.prototype,"strokeJoin",void 0);X([Ht("lineDashOffset")],K.prototype,"dashOffset",void 0);X([Ht()],K.prototype,"miterLimit",void 0);X([Ht()],K.prototype,"shadowBlur",void 0);X([Ht()],K.prototype,"shadowColor",void 0);X([Ht()],K.prototype,"shadowOffsetX",void 0);X([Ht()],K.prototype,"shadowOffsetY",void 0);X([Ht()],K.prototype,"filter",void 0);X([Ht()],K.prototype,"font",void 0);X([Ht()],K.prototype,"fontKerning",void 0);X([Ht()],K.prototype,"fontStretch",void 0);X([Ht()],K.prototype,"fontVariantCaps",void 0);X([Ht()],K.prototype,"textAlign",void 0);X([Ht()],K.prototype,"textBaseline",void 0);X([Ht()],K.prototype,"textRendering",void 0);X([Ht()],K.prototype,"wordSpacing",void 0);X([Ht()],K.prototype,"letterSpacing",void 0);X([Ht()],K.prototype,"direction",void 0);X([wt()],K.prototype,"setTransform",null);X([wt()],K.prototype,"resetTransform",null);X([wt()],K.prototype,"getTransform",null);X([wt()],K.prototype,"save",null);X([wt()],K.prototype,"restore",null);X([wt()],K.prototype,"translate",null);X([wt()],K.prototype,"scale",null);X([wt()],K.prototype,"rotate",null);X([wt()],K.prototype,"fill",null);X([wt()],K.prototype,"stroke",null);X([wt()],K.prototype,"clip",null);X([wt()],K.prototype,"fillRect",null);X([wt()],K.prototype,"strokeRect",null);X([wt()],K.prototype,"clearRect",null);X([wt()],K.prototype,"beginPath",null);X([wt()],K.prototype,"moveTo",null);X([wt()],K.prototype,"lineTo",null);X([wt()],K.prototype,"bezierCurveTo",null);X([wt()],K.prototype,"quadraticCurveTo",null);X([wt()],K.prototype,"closePath",null);X([wt()],K.prototype,"arc",null);X([wt()],K.prototype,"arcTo",null);X([wt()],K.prototype,"ellipse",null);X([wt()],K.prototype,"rect",null);X([wt()],K.prototype,"roundRect",null);X([wt()],K.prototype,"createConicGradient",null);X([wt()],K.prototype,"createLinearGradient",null);X([wt()],K.prototype,"createPattern",null);X([wt()],K.prototype,"createRadialGradient",null);X([wt()],K.prototype,"fillText",null);X([wt()],K.prototype,"measureText",null);X([wt()],K.prototype,"strokeText",null);const{copy:mE}=ot,wE={width:1,height:1,pixelRatio:1},Ni=["width","height","pixelRatio"];class ju extends K{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio}get pixelHeight(){return this.height*this.pixelRatio}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,e){super(),this.size={},this.worldTransform={},t||(t=wE),t.pixelRatio||(t.pixelRatio=V.devicePixelRatio),this.manager=e,this.innerId=pn.create(pn.CNAVAS);const{width:n,height:o,pixelRatio:a}=t;this.autoLayout=!n||!o,this.size.pixelRatio=a,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t){if(this.isSameSize(t))return;let e;this.context&&!this.unreal&&this.width&&(e=this.getSameCanvas(),e.copyWorld(this)),ie.copyAttrs(this.size,t,Ni),this.size.pixelRatio||(this.size.pixelRatio=1),this.bounds=new zt(0,0,this.width,this.height),this.context&&!this.unreal&&(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&e&&(this.clearWorld(e.bounds),this.copyWorld(e),e.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:n}=this,o=this.worldTransform;if(e){const{a,b:h,c:u,d,e:f,f:y}=e;this.setTransform(o.a=(t.a*a+t.b*u)*n,o.b=(t.a*h+t.b*d)*n,o.c=(t.c*a+t.d*u)*n,o.d=(t.c*h+t.d*d)*n,o.e=(t.e*a+t.f*u+f)*n,o.f=(t.e*h+t.f*d+y)*n)}else this.setTransform(o.a=t.a*n,o.b=t.b*n,o.c=t.c*n,o.d=t.d*n,o.e=t.e*n,o.f=t.f*n)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,n){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),n&&this.setStrokeOptions(n)}setStrokeOptions(t){this.strokeCap=t.strokeCap==="none"?"butt":t.strokeCap,this.strokeJoin=t.strokeJoin,this.dashPattern=t.dashPattern,this.dashOffset=t.dashOffset,this.miterLimit=t.miterLimit}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,n=1){return!0}setWorldShadow(t,e,n,o){const{pixelRatio:a}=this;this.shadowOffsetX=t*a,this.shadowOffsetY=e*a,this.shadowBlur=n*a,this.shadowColor=o||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,n,o){if(o&&(this.blendMode=o),e){const{pixelRatio:a}=this;n||(n=e),this.drawImage(t.view,e.x*a,e.y*a,e.width*a,e.height*a,n.x*a,n.y*a,n.width*a,n.height*a)}else this.drawImage(t.view,0,0);o&&(this.blendMode="source-over")}copyWorldToInner(t,e,n,o){if(o&&(this.blendMode=o),e.b||e.c)this.save(),this.resetTransform(),this.copyWorld(t,e,q.tempToOuterOf(n,e)),this.restore();else{const{pixelRatio:a}=this;this.drawImage(t.view,e.x*a,e.y*a,e.width*a,e.height*a,n.x,n.y,n.width,n.height)}o&&(this.blendMode="source-over")}copyWorldByReset(t,e,n,o,a){this.resetTransform(),this.copyWorld(t,e,n,o),a||this.useWorldTransform()}useMask(t,e,n){this.copyWorld(t,e,n,"destination-in")}useEraser(t,e,n){this.copyWorld(t,e,n,"destination-out")}fillWorld(t,e,n){n&&(this.blendMode=n),this.fillStyle=e,Lt.set(t).scale(this.pixelRatio),this.fillRect(Lt.x,Lt.y,Lt.width,Lt.height),n&&(this.blendMode="source-over")}strokeWorld(t,e,n){n&&(this.blendMode=n),this.strokeStyle=e,Lt.set(t).scale(this.pixelRatio),this.strokeRect(Lt.x,Lt.y,Lt.width,Lt.height),n&&(this.blendMode="source-over")}clearWorld(t,e){Lt.set(t).scale(this.pixelRatio),e&&Lt.ceil(),this.clearRect(Lt.x,Lt.y,Lt.width,Lt.height)}clipWorld(t,e){this.beginPath(),Lt.set(t).scale(this.pixelRatio),e&&Lt.ceil(),this.rect(Lt.x,Lt.y,Lt.width,Lt.height),this.clip()}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}isSameSize(t){return this.width===t.width&&this.height===t.height&&this.pixelRatio===t.pixelRatio}getSameCanvas(t,e){const n=this.manager?this.manager.get(this.size):qt.canvas(Object.assign({},this.size));return n.save(),t&&(mE(n.worldTransform,this.worldTransform),n.useWorldTransform()),e&&(n.smooth=this.smooth),n}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t,!0):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const Ui={creator:{},parse(i,t){},convertToCanvasData(i,t){}},pg={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},_i=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},pg),gg={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},yg={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},xE=Object.assign(Object.assign({},yg),pg),Ha=_i,vg={};for(let i in Ha)vg[Ha[i]]=i;const mg={};for(let i in Ha)mg[Ha[i]]=gg[i];const wg={drawRoundRect(i,t,e,n,o,a){const h=fe.fourNumber(a,Math.min(n/2,o/2)),u=t+n,d=e+o;h[0]?i.moveTo(t+h[0],e):i.moveTo(t,e),h[1]?i.arcTo(u,e,u,d,h[1]):i.lineTo(u,e),h[2]?i.arcTo(u,d,t,d,h[2]):i.lineTo(u,d),h[3]?i.arcTo(t,d,t,e,h[3]):i.lineTo(t,d),h[0]?i.arcTo(t,e,u,e,h[0]):i.lineTo(t,e)}},{sin:Ur,cos:Is,atan2:l_,ceil:bE,abs:Ll,PI:u_,sqrt:c_,pow:ga}=Math,{setPoint:kl,addPoint:ya}=co,{set:va,toNumberPoints:EE}=rt,{M:d_,L:Bl,C:Ol,Q:f_,Z:CE}=_i,Pl={},_r={points(i,t,e,n){let o=EE(t);if(i.push(d_,o[0],o[1]),e&&o.length>5){let a,h,u,d,f,y,x,E,m,S,B,P,$,I=o.length;const F=e===!0?.5:e;n&&(o=[o[I-2],o[I-1],...o,o[0],o[1],o[2],o[3]],I=o.length);for(let L=2;L<I-2;L+=2)a=o[L-2],h=o[L-1],u=o[L],d=o[L+1],f=o[L+2],y=o[L+3],B=c_(ga(u-a,2)+ga(d-h,2)),P=c_(ga(f-u,2)+ga(y-d,2)),$=B+P,B=F*B/$,P=F*P/$,f-=a,y-=h,x=u-B*f,E=d-B*y,L===2?n||i.push(f_,x,E,u,d):i.push(Ol,m,S,x,E,u,d),m=u+P*f,S=d+P*y;n||i.push(f_,m,S,o[I-2],o[I-1])}else for(let a=2,h=o.length;a<h;a+=2)i.push(Bl,o[a],o[a+1]);n&&i.push(CE)},rect(i,t,e,n,o){Ui.creator.path=i,Ui.creator.moveTo(t,e).lineTo(t+n,e).lineTo(t+n,e+o).lineTo(t,e+o).lineTo(t,e)},roundRect(i,t,e,n,o,a){Ui.creator.path=[],wg.drawRoundRect(Ui.creator,t,e,n,o,a),i.push(...Ui.convertToCanvasData(Ui.creator.path,!0))},arcTo(i,t,e,n,o,a,h,u,d,f,y){const x=n-t,E=o-e,m=a-n,S=h-o;let B=l_(E,x),P=l_(S,m),$=P-B;if($<0&&($+=di),$===u_||Ll(x+E)<1e-12||Ll(m+S)<1e-12){i&&i.push(Bl,n,o),d&&(kl(d,t,e),ya(d,n,o)),y&&va(y,t,e),f&&va(f,n,o);return}const I=x*S-m*E<0,F=I?-1:1,L=u/Is($/2),T=n+L*Is(B+$/2+ts*F),U=o+L*Ur(B+$/2+ts*F);return B-=ts*F,P-=ts*F,g_(i,T,U,u,u,0,B/kt,P/kt,I,d,f,y)},arc(i,t,e,n,o,a,h,u,d,f){return g_(i,t,e,n,n,0,o,a,h,u,d,f)},ellipse(i,t,e,n,o,a,h,u,d,f,y,x){const E=a*kt,m=Ur(E),S=Is(E);let B=h*kt,P=u*kt;B>u_&&(B-=di),P<0&&(P+=di);let $=P-B;$<0?$+=di:$>di&&($-=di),d&&($-=di);const I=bE(Ll($/ts)),F=$/I,L=Ur(F/4),T=8/3*L*L/Ur(F/2);P=B+F;let U=Is(B),W=Ur(B),nt,pt,Q,J,Z,ct,Dt,Wt,le=Q=S*n*U-m*o*W,ne=J=m*n*U+S*o*W,vt=t+Q,xe=e+J;i&&i.push(i.length?Bl:d_,vt,xe),f&&kl(f,vt,xe),x&&va(x,vt,xe);for(let gi=0;gi<I;gi++)nt=Is(P),pt=Ur(P),Q=S*n*nt-m*o*pt,J=m*n*nt+S*o*pt,Z=t+le-T*(S*n*W+m*o*U),ct=e+ne-T*(m*n*W-S*o*U),Dt=t+Q+T*(S*n*pt+m*o*nt),Wt=e+J+T*(m*n*pt-S*o*nt),i&&i.push(Ol,Z,ct,Dt,Wt,t+Q,e+J),f&&p_(t+le,e+ne,Z,ct,Dt,Wt,t+Q,e+J,f,!0),le=Q,ne=J,U=nt,W=pt,B=P,P+=F;y&&va(y,t+Q,e+J)},quadraticCurveTo(i,t,e,n,o,a,h){i.push(Ol,(t+2*n)/3,(e+2*o)/3,(a+2*n)/3,(h+2*o)/3,a,h)},toTwoPointBoundsByQuadraticCurve(i,t,e,n,o,a,h,u){p_(i,t,(i+2*e)/3,(t+2*n)/3,(o+2*e)/3,(a+2*n)/3,o,a,h,u)},toTwoPointBounds(i,t,e,n,o,a,h,u,d,f){const y=[];let x,E,m,S,B,P,$,I,F=i,L=e,T=o,U=h;for(let W=0;W<2;++W){if(W==1&&(F=t,L=n,T=a,U=u),x=-3*F+9*L-9*T+3*U,E=6*F-12*L+6*T,m=3*L-3*F,Math.abs(x)<1e-12){if(Math.abs(E)<1e-12)continue;S=-m/E,0<S&&S<1&&y.push(S);continue}$=E*E-4*m*x,I=Math.sqrt($),!($<0)&&(B=(-E+I)/(2*x),0<B&&B<1&&y.push(B),P=(-E-I)/(2*x),0<P&&P<1&&y.push(P))}f?ya(d,i,t):kl(d,i,t),ya(d,h,u);for(let W=0,nt=y.length;W<nt;W++)__(y[W],i,t,e,n,o,a,h,u,Pl),ya(d,Pl.x,Pl.y)},getPointAndSet(i,t,e,n,o,a,h,u,d,f){const y=1-i,x=y*y*y,E=3*y*y*i,m=3*y*i*i,S=i*i*i;f.x=x*t+E*n+m*a+S*u,f.y=x*e+E*o+m*h+S*d},getPoint(i,t,e,n,o,a,h,u,d){const f={};return __(i,t,e,n,o,a,h,u,d,f),f}},{getPointAndSet:__,toTwoPointBounds:p_,ellipse:g_}=_r,{sin:SE,cos:TE,sqrt:y_,atan2:v_}=Math,{ellipse:RE}=_r,LE={ellipticalArc(i,t,e,n,o,a,h,u,d,f,y){const x=(d-t)/2,E=(f-e)/2,m=a*kt,S=SE(m),B=TE(m),P=-B*x-S*E,$=-B*E+S*x,I=n*n,F=o*o,L=$*$,T=P*P,U=I*F-I*L-F*T;let W=0;if(U<0){const le=y_(1-U/(I*F));n*=le,o*=le}else W=(h===u?-1:1)*y_(U/(I*L+F*T));const nt=W*n*$/o,pt=-W*o*P/n,Q=v_(($-pt)/o,(P-nt)/n),J=v_((-$-pt)/o,(-P-nt)/n);let Z=J-Q;u===0&&Z>0?Z-=di:u===1&&Z<0&&(Z+=di);const ct=t+x+B*nt-S*pt,Dt=e+E+S*nt+B*pt,Wt=Z<0?1:0;y||V.ellipseToCurve?RE(i,ct,Dt,n,o,a,Q/kt,J/kt,Wt):n===o&&!a?i.push(_i.O,ct,Dt,n,Q/kt,J/kt,Wt):i.push(_i.G,ct,Dt,n,o,a,Q/kt,J/kt,Wt)}},{M:Al,m:kE,L:Ds,l:BE,H:OE,h:PE,V:AE,v:ME,C:Gr,c:IE,S:Ml,s:DE,Q:Vr,q:WE,T:Il,t:FE,A:$E,a:zE,Z:Dl,z:HE,N:NE,D:UE,X:GE,G:VE,F:YE,O:XE,P:ZE,U:KE}=_i,{rect:jE,roundRect:m_,arcTo:qE,arc:w_,ellipse:x_,quadraticCurveTo:b_}=_r,{ellipticalArc:JE}=LE,QE=Tt.get("PathConvert"),hn={},gr={current:{dot:0},stringify(i,t){let e=0,n=i.length,o,a="",h,u;for(;e<n;){h=i[e],o=mg[h],h===u?a+=" ":a+=vg[h];for(let d=1;d<o;d++)a+=fe.float(i[e+d],t),d===o-1||(a+=" ");u=h,e+=o}return a},parse(i,t){let e,n,o,a="";const h=[],u=t?xE:yg;for(let d=0,f=i.length;d<f;d++)n=i[d],_E[n]?(n==="."&&(ui.dot&&(or(h,a),a=""),ui.dot++),a==="0"&&n!=="."&&(or(h,a),a=""),a+=n):_i[n]?(a&&(or(h,a),a=""),ui.name=_i[n],ui.length=gg[n],ui.index=0,or(h,ui.name),!e&&u[n]&&(e=!0)):n==="-"||n==="+"?o==="e"||o==="E"?a+=n:(a&&or(h,a),a=n):a&&(or(h,a),a=""),o=n;return a&&or(h,a),e?gr.toCanvasData(h,t):h},toCanvasData(i,t){let e=0,n=0,o=0,a=0,h=0,u=i.length,d,f,y,x,E;const m=[];for(;h<u;){switch(y=i[h],y){case kE:i[h+1]+=e,i[h+2]+=n;case Al:e=i[h+1],n=i[h+2],m.push(Al,e,n),h+=3;break;case PE:i[h+1]+=e;case OE:e=i[h+1],m.push(Ds,e,n),h+=2;break;case ME:i[h+1]+=n;case AE:n=i[h+1],m.push(Ds,e,n),h+=2;break;case BE:i[h+1]+=e,i[h+2]+=n;case Ds:e=i[h+1],n=i[h+2],m.push(Ds,e,n),h+=3;break;case DE:i[h+1]+=e,i[h+2]+=n,i[h+3]+=e,i[h+4]+=n,y=Ml;case Ml:E=x===Gr||x===Ml,o=E?e*2-d:i[h+1],a=E?n*2-f:i[h+2],d=i[h+1],f=i[h+2],e=i[h+3],n=i[h+4],m.push(Gr,o,a,d,f,e,n),h+=5;break;case IE:i[h+1]+=e,i[h+2]+=n,i[h+3]+=e,i[h+4]+=n,i[h+5]+=e,i[h+6]+=n,y=Gr;case Gr:d=i[h+3],f=i[h+4],e=i[h+5],n=i[h+6],m.push(Gr,i[h+1],i[h+2],d,f,e,n),h+=7;break;case FE:i[h+1]+=e,i[h+2]+=n,y=Il;case Il:E=x===Vr||x===Il,d=E?e*2-d:i[h+1],f=E?n*2-f:i[h+2],t?b_(m,e,n,d,f,i[h+1],i[h+2]):m.push(Vr,d,f,i[h+1],i[h+2]),e=i[h+1],n=i[h+2],h+=3;break;case WE:i[h+1]+=e,i[h+2]+=n,i[h+3]+=e,i[h+4]+=n,y=Vr;case Vr:d=i[h+1],f=i[h+2],t?b_(m,e,n,d,f,i[h+3],i[h+4]):m.push(Vr,d,f,i[h+3],i[h+4]),e=i[h+3],n=i[h+4],h+=5;break;case zE:i[h+6]+=e,i[h+7]+=n;case $E:JE(m,e,n,i[h+1],i[h+2],i[h+3],i[h+4],i[h+5],i[h+6],i[h+7],t),e=i[h+6],n=i[h+7],h+=8;break;case HE:case Dl:m.push(Dl),h++;break;case NE:e=i[h+1],n=i[h+2],t?jE(m,e,n,i[h+3],i[h+4]):Dn(m,i,h,5),h+=5;break;case UE:e=i[h+1],n=i[h+2],t?m_(m,e,n,i[h+3],i[h+4],[i[h+5],i[h+6],i[h+7],i[h+8]]):Dn(m,i,h,9),h+=9;break;case GE:e=i[h+1],n=i[h+2],t?m_(m,e,n,i[h+3],i[h+4],i[h+5]):Dn(m,i,h,6),h+=6;break;case VE:x_(t?m:Dn(m,i,h,9),i[h+1],i[h+2],i[h+3],i[h+4],i[h+5],i[h+6],i[h+7],i[h+8],null,hn),e=hn.x,n=hn.y,h+=9;break;case YE:t?x_(m,i[h+1],i[h+2],i[h+3],i[h+4],0,0,360,!1):Dn(m,i,h,5),e=i[h+1]+i[h+3],n=i[h+2],h+=5;break;case XE:w_(t?m:Dn(m,i,h,7),i[h+1],i[h+2],i[h+3],i[h+4],i[h+5],i[h+6],null,hn),e=hn.x,n=hn.y,h+=7;break;case ZE:t?w_(m,i[h+1],i[h+2],i[h+3],0,360,!1):Dn(m,i,h,4),e=i[h+1]+i[h+3],n=i[h+2],h+=4;break;case KE:qE(t?m:Dn(m,i,h,6),e,n,i[h+1],i[h+2],i[h+3],i[h+4],i[h+5],null,hn),e=hn.x,n=hn.y,h+=6;break;default:return QE.error(`command: ${y} [index:${h}]`,i),m}x=y}return m},objectToCanvasData(i){const t=[];return i.forEach(e=>{switch(e.name){case"M":t.push(Al,e.x,e.y);break;case"L":t.push(Ds,e.x,e.y);break;case"C":t.push(Gr,e.x1,e.y1,e.x2,e.y2,e.x,e.y);break;case"Q":t.push(Vr,e.x1,e.y1,e.x,e.y);break;case"Z":t.push(Dl)}}),t},copyData(i,t,e,n){for(let o=e,a=e+n;o<a;o++)i.push(t[o])},pushData(i,t){ui.index===ui.length&&(ui.index=1,i.push(ui.name)),i.push(Number(t)),ui.index++,ui.dot=0}},{current:ui,pushData:or,copyData:Dn}=gr,{M:Wl,L:tC,C:eC,Q:iC,Z:nC,N:E_,D:rC,X:sC,G:oC,F:aC,O:hC,P:lC,U:C_}=_i,{getMinDistanceFrom:uC,getRadianFrom:cC}=rt,{tan:dC,min:fC,abs:_C}=Math,Yr={},wr={beginPath(i){i.length=0},moveTo(i,t,e){i.push(Wl,t,e)},lineTo(i,t,e){i.push(tC,t,e)},bezierCurveTo(i,t,e,n,o,a,h){i.push(eC,t,e,n,o,a,h)},quadraticCurveTo(i,t,e,n,o){i.push(iC,t,e,n,o)},closePath(i){i.push(nC)},rect(i,t,e,n,o){i.push(E_,t,e,n,o)},roundRect(i,t,e,n,o,a){if(typeof a=="number")i.push(sC,t,e,n,o,a);else{const h=fe.fourNumber(a);h?i.push(rC,t,e,n,o,...h):i.push(E_,t,e,n,o)}},ellipse(i,t,e,n,o,a,h,u,d){a===void 0?i.push(aC,t,e,n,o):(h===void 0&&(h=0),u===void 0&&(u=360),i.push(oC,t,e,n,o,a,h,u,d?1:0))},arc(i,t,e,n,o,a,h){o===void 0?i.push(lC,t,e,n):(a===void 0&&(a=360),i.push(hC,t,e,n,o,a,h?1:0))},arcTo(i,t,e,n,o,a,h,u){if(h!==void 0){const d=dC(cC(h,u,t,e,n,o)/2)*(uC(h,u,t,e,n,o)/2);i.push(C_,t,e,n,o,fC(a,_C(d)))}else i.push(C_,t,e,n,o,a)},drawEllipse(i,t,e,n,o,a,h,u,d){_r.ellipse(null,t,e,n,o,a===void 0?0:a,h===void 0?0:h,u===void 0?360:u,d,null,null,Yr),i.push(Wl,Yr.x,Yr.y),pC(i,t,e,n,o,a,h,u,d)},drawArc(i,t,e,n,o,a,h){_r.arc(null,t,e,n,o===void 0?0:o,a===void 0?360:a,h,null,null,Yr),i.push(Wl,Yr.x,Yr.y),gC(i,t,e,n,o,a,h)},drawPoints(i,t,e,n){_r.points(i,t,e,n)}},{ellipse:pC,arc:gC}=wr,{moveTo:yC,lineTo:vC,quadraticCurveTo:mC,bezierCurveTo:wC,closePath:xC,beginPath:bC,rect:EC,roundRect:CC,ellipse:SC,arc:TC,arcTo:RC,drawEllipse:LC,drawArc:kC,drawPoints:BC}=wr;class qu{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return t?this.__path=typeof t=="string"?Ui.parse(t):t:this.__path=[],this}beginPath(){return bC(this.__path),this.paint(),this}moveTo(t,e){return yC(this.__path,t,e),this.paint(),this}lineTo(t,e){return vC(this.__path,t,e),this.paint(),this}bezierCurveTo(t,e,n,o,a,h){return wC(this.__path,t,e,n,o,a,h),this.paint(),this}quadraticCurveTo(t,e,n,o){return mC(this.__path,t,e,n,o),this.paint(),this}closePath(){return xC(this.__path),this.paint(),this}rect(t,e,n,o){return EC(this.__path,t,e,n,o),this.paint(),this}roundRect(t,e,n,o,a){return CC(this.__path,t,e,n,o,a),this.paint(),this}ellipse(t,e,n,o,a,h,u,d){return SC(this.__path,t,e,n,o,a,h,u,d),this.paint(),this}arc(t,e,n,o,a,h){return TC(this.__path,t,e,n,o,a,h),this.paint(),this}arcTo(t,e,n,o,a){return RC(this.__path,t,e,n,o,a),this.paint(),this}drawEllipse(t,e,n,o,a,h,u,d){return LC(this.__path,t,e,n,o,a,h,u,d),this.paint(),this}drawArc(t,e,n,o,a,h){return kC(this.__path,t,e,n,o,a,h),this.paint(),this}drawPoints(t,e,n){return BC(this.__path,t,e,n),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:OC,L:PC,C:AC,Q:MC,Z:IC,N:DC,D:WC,X:FC,G:$C,F:zC,O:HC,P:NC,U:UC}=_i,GC=Tt.get("PathDrawer"),VC={drawPathByData(i,t){if(!t)return;let e,n=0,o=t.length;for(;n<o;)switch(e=t[n],e){case OC:i.moveTo(t[n+1],t[n+2]),n+=3;break;case PC:i.lineTo(t[n+1],t[n+2]),n+=3;break;case AC:i.bezierCurveTo(t[n+1],t[n+2],t[n+3],t[n+4],t[n+5],t[n+6]),n+=7;break;case MC:i.quadraticCurveTo(t[n+1],t[n+2],t[n+3],t[n+4]),n+=5;break;case IC:i.closePath(),n+=1;break;case DC:i.rect(t[n+1],t[n+2],t[n+3],t[n+4]),n+=5;break;case WC:i.roundRect(t[n+1],t[n+2],t[n+3],t[n+4],[t[n+5],t[n+6],t[n+7],t[n+8]]),n+=9;break;case FC:i.roundRect(t[n+1],t[n+2],t[n+3],t[n+4],t[n+5]),n+=6;break;case $C:i.ellipse(t[n+1],t[n+2],t[n+3],t[n+4],t[n+5]*kt,t[n+6]*kt,t[n+7]*kt,t[n+8]),n+=9;break;case zC:i.ellipse(t[n+1],t[n+2],t[n+3],t[n+4],0,0,di,!1),n+=5;break;case HC:i.arc(t[n+1],t[n+2],t[n+3],t[n+4]*kt,t[n+5]*kt,t[n+6]),n+=7;break;case NC:i.arc(t[n+1],t[n+2],t[n+3],0,di,!1),n+=4;break;case UC:i.arcTo(t[n+1],t[n+2],t[n+3],t[n+4],t[n+5]),n+=6;break;default:GC.error(`command: ${e} [index:${n}]`,t);return}}},{M:YC,L:XC,C:S_,Q:T_,Z:R_,N:ZC,D:L_,X:KC,G:jC,F:qC,O:JC,P:QC,U:tS}=_i,{toTwoPointBounds:eS,toTwoPointBoundsByQuadraticCurve:iS,arcTo:nS,arc:rS,ellipse:sS}=_r,{addPointBounds:Ws,copy:Fl,addPoint:oS,setPoint:$l,addBounds:ma,toBounds:aS}=co,hS=Tt.get("PathBounds");let Xr,wa,zl;const je={},k_={},ln={},Ju={toBounds(i,t){Ju.toTwoPointBounds(i,k_),aS(k_,t)},toTwoPointBounds(i,t){if(!i||!i.length)return $l(t,0,0);let e=0,n=0,o=0,a,h,u,d,f;const y=i.length;for(;e<y;)switch(f=i[e],e===0&&(f===R_||f===S_||f===T_?$l(t,n,o):$l(t,i[e+1],i[e+2])),f){case YC:case XC:n=i[e+1],o=i[e+2],oS(t,n,o),e+=3;break;case S_:u=i[e+5],d=i[e+6],eS(n,o,i[e+1],i[e+2],i[e+3],i[e+4],u,d,je),Ws(t,je),n=u,o=d,e+=7;break;case T_:a=i[e+1],h=i[e+2],u=i[e+3],d=i[e+4],iS(n,o,a,h,u,d,je),Ws(t,je),n=u,o=d,e+=5;break;case R_:e+=1;break;case ZC:n=i[e+1],o=i[e+2],ma(t,n,o,i[e+3],i[e+4]),e+=5;break;case L_:case KC:n=i[e+1],o=i[e+2],ma(t,n,o,i[e+3],i[e+4]),e+=f===L_?9:6;break;case jC:sS(null,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],i[e+7],i[e+8],je,ln),e===0?Fl(t,je):Ws(t,je),n=ln.x,o=ln.y,e+=9;break;case qC:n=i[e+1],o=i[e+2],wa=i[e+3],zl=i[e+4],ma(t,n-wa,o-zl,wa*2,zl*2),n+=wa,e+=5;break;case JC:rS(null,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],je,ln),e===0?Fl(t,je):Ws(t,je),n=ln.x,o=ln.y,e+=7;break;case QC:n=i[e+1],o=i[e+2],Xr=i[e+3],ma(t,n-Xr,o-Xr,Xr*2,Xr*2),n+=Xr,e+=4;break;case tS:nS(null,n,o,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],je,ln),e===0?Fl(t,je):Ws(t,je),n=ln.x,o=ln.y,e+=6;break;default:hS.error(`command: ${f} [index:${e}]`,i);return}}},{M:Hl,L:xa,C:B_,Z:ba}=_i,{getCenterX:lS,getCenterY:uS}=rt,{arcTo:Nl}=wr,cS={smooth(i,t,e){let n,o=0,a=0,h=0,u=0,d=0,f=0,y=0,x=0,E=0;const m=i.length,S=[];for(;o<m;)switch(n=i[o],n){case Hl:u=x=i[o+1],d=E=i[o+2],o+=3,i[o]===xa?(f=i[o+1],y=i[o+2],S.push(Hl,lS(u,f),uS(d,y))):S.push(Hl,u,d);break;case xa:switch(a=i[o+1],h=i[o+2],o+=3,i[o]){case xa:Nl(S,a,h,i[o+1],i[o+2],t,x,E);break;case ba:Nl(S,a,h,u,d,t,x,E);break;default:S.push(xa,a,h)}x=a,E=h;break;case B_:S.push(B_,i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],i[o+6]),o+=7;break;case ba:Nl(S,u,d,f,y,t,x,E),S.push(ba),o+=1;break}return n!==ba&&(S[1]=u,S[2]=d),S}};Ui.creator=new qu;Ui.parse=gr.parse;Ui.convertToCanvasData=gr.toCanvasData;const Fs=new qu,{drawRoundRect:dS}=wg;function fS(i){i&&!i.roundRect&&(i.roundRect=function(t,e,n,o,a){dS(this,t,e,n,o,a)})}function xg(i){fS(i)}const _n={opacityTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType(i){return!i||i.startsWith("image")?i:(i==="jpg"&&(i="jpeg"),"image/"+i)},fileType(i){const t=i.split(".");return t[t.length-1]},isOpaqueImage(i){const t=ku.fileType(i);return["jpg","jpeg"].some(e=>e===t)},getExportOptions(i){switch(typeof i){case"object":return i;case"number":return{quality:i};case"boolean":return{blob:i};default:return{}}}},ku=_n;ku.opacityTypes.forEach(i=>ku.upperCaseTypeMap[i]=i.toUpperCase());const _S=Tt.get("TaskProcessor");class pS{constructor(t){this.parallel=!0,this.time=1,this.id=pn.create(pn.TASK),this.task=t}run(){return fg(this,void 0,void 0,function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){_S.error(t)}})}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class Bu{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,n=0;for(let o=0;o<t;o++)o<=this.finishedIndex?(n+=this.list[o].time,o===this.finishedIndex&&(e=n)):e+=this.list[o].time;return this.isComplete?1:n/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&ie.assign(this.config,t),this.empty()}add(t,e){let n,o,a,h;const u=new pS(t);return u.parent=this,typeof e=="number"?h=e:e&&(o=e.parallel,n=e.start,a=e.time,h=e.delay),a&&(u.time=a),o===!1&&(u.parallel=!1),h===void 0?this.push(u,n):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(u,n))},h)),this.isComplete=!1,u}push(t,e){this.list.push(t),e!==!1&&!this.timer&&(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];if(!t){this.nextTask();return}t.run().then(()=>{this.onTask(t),this.index++,this.nextTask()}).catch(e=>{this.onError(e)})}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(e=>{this.onParallelError(e)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let n=this.index;n<e&&(t=this.list[n],t.parallel);n++)this.parallelList.push(t)}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const n=e.length,o=this.finishedIndex+n;if(e.length){if(!this.running)return;o<this.total&&(t=this.list[o],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(e=>{e.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const He={map:{},recycledList:[],tasker:new Bu,patternTasker:new Bu,get isComplete(){return un.tasker.isComplete},get(i){let t=un.map[i.url];return t||(t=qt.image(i),un.map[i.url]=t),t.use++,t},recycle(i){i.use--,setTimeout(()=>{i.use||un.recycledList.push(i)})},clearRecycled(){const i=un.recycledList;i.length>100&&(i.forEach(t=>{!t.use&&t.url&&(delete un.map[t.url],t.destroy())}),i.length=0)},hasOpacityPixel(i){return _n.opacityTypes.some(t=>un.isFormat(t,i))},isFormat(i,t){if(t.format===i)return!0;const{url:e}=t;if(e.startsWith("data:")){if(e.startsWith("data:"+_n.mineType(i)))return!0}else{if(e.includes("."+i)||e.includes("."+_n.upperCaseTypeMap[i]))return!0;if(i==="png"&&!e.includes("."))return!0}return!1},destroy(){un.map={},un.recycledList=[]}},un=He,{IMAGE:gS,create:yS}=pn;class bg{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){this.use=0,this.waitComplete=[],this.innerId=yS(gS),this.config=t||{url:""},this.isSVG=He.isFormat("svg",t),this.hasOpacityPixel=He.hasOpacityPixel(t)}load(t,e){return this.loading||(this.loading=!0,He.tasker.add(()=>fg(this,void 0,void 0,function*(){return yield V.origin.loadImage(this.url).then(n=>{this.ready=!0,this.width=n.naturalWidth||n.width,this.height=n.naturalHeight||n.height,this.view=n,this.onComplete(!0)}).catch(n=>{this.error=n,this.onComplete(!1)})}))),this.waitComplete.push(t,e),this.waitComplete.length-2}unload(t,e){const n=this.waitComplete;if(e){const o=n[t+1];o&&o({type:"stop"})}n[t]=n[t+1]=void 0}onComplete(t){let e;this.waitComplete.forEach((n,o)=>{e=o%2,n&&(t?e||n(this):e&&n(this.error))}),this.waitComplete.length=0,this.loading=!1}getCanvas(t,e,n,o){if(t||(t=this.width),e||(e=this.height),this.cache){let{params:u,data:d}=this.cache;for(let f in u)if(u[f]!==arguments[f]){d=null;break}if(d)return d}const a=V.origin.createCanvas(t,e),h=a.getContext("2d");return n&&(h.globalAlpha=n),h.drawImage(this.view,0,0,t,e),this.cache=this.use>1?{data:a,params:arguments}:null,a}getPattern(t,e,n,o){const a=V.canvas.createPattern(t,e);try{n&&a.setTransform&&(a.setTransform(n),n=null)}catch{}return o&&(o.transform=n),a}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function qe(i,t,e,n){e.configurable=e.enumerable=!0,Object.defineProperty(i,t,e)}function Eg(i,t){return Object.getOwnPropertyDescriptor(i,t)}function vS(i){return Object.getOwnPropertyNames(i)}function re(i,t){return(e,n)=>mS(e,n,i,t&&t(n))}function mS(i,t,e,n){qe(i,t,Object.assign({get(){return this.__getAttr(t)},set(a){this.__setAttr(t,a)}},n||{})),Rg(i,t,e)}function Pi(i){return re(i)}function ps(i,t){return re(i,e=>({set(n){this.__setAttr(e,n,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function Cg(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal())}}))}function Sg(i,t){return re(i,e=>({set(n){this.__setAttr(e,n,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function Qu(i,t){return re(i,e=>({set(n){this.__setAttr(e,n,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function It(i,t){return re(i,e=>({set(n){this.__setAttr(e,n,t)&&fo(this)}}))}function wS(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&(fo(this),this.__.__removeNaturalSize())}}))}function fo(i){i.__layout.boxChanged||i.__layout.boxChange(),i.__hasAutoLayout&&(i.__layout.matrixChanged||i.__layout.matrixChange())}function xS(i){return re(i,t=>({set(e){const n=this.__;n.__pathInputed!==2&&(n.__pathInputed=e?1:0),e||(n.__pathForRender=void 0),this.__setAttr(t,e),fo(this)}}))}const Oe=It;function Xa(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&bS(this)}}))}function bS(i){i.__layout.strokeChanged||i.__layout.strokeChange(),i.__.__useArrow&&fo(i)}const Xi=Xa;function Tg(i){return re(i,t=>({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}}))}function _o(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function ES(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange())}}))}function CS(i){return re(i,t=>({set(e){const n=this.visible;if(n===!0&&e===0){if(this.animationOut)return this.__runAnimation("out",()=>O_(this,t,e,n))}else n===0&&e===!0&&this.animation&&this.__runAnimation("in");O_(this,t,e,n)}}))}function O_(i,t,e,n){i.__setAttr(t,e)&&(i.__layout.opacityChanged||i.__layout.opacityChange(),(n===0||e===0)&&fo(i))}function SS(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function TS(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(e)}))}}))}function RS(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&this.waitParent(()=>{this.parent.__updateEraser(e)})}}))}function xr(i){return re(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,Tt.showHitView&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}}))}function LS(i){return re(i,t=>({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}}))}function me(i){return(t,e)=>{qe(t,"__DataProcessor",{get(){return i}})}}function kS(i){return"set"+i.charAt(0).toUpperCase()+i.slice(1)}function Rg(i,t,e){const n=i.__DataProcessor.prototype,o="_"+t,a=kS(t),h={get(){const f=this[o];return f===void 0?e:f},set(f){this[o]=f}};if(e===void 0)h.get=function(){return this[o]};else if(typeof e=="object"){const{clone:f}=ie;h.get=function(){let y=this[o];return y===void 0&&(this[o]=y=f(e)),y}}t==="width"?h.get=function(){const f=this[o];if(f===void 0){const y=this;return y._height&&y.__naturalWidth&&y.__useNaturalRatio?y._height*y.__naturalWidth/y.__naturalHeight:y.__naturalWidth||e}else return f}:t==="height"&&(h.get=function(){const f=this[o];if(f===void 0){const y=this;return y._width&&y.__naturalHeight&&y.__useNaturalRatio?y._width*y.__naturalHeight/y.__naturalWidth:y.__naturalHeight||e}else return f});let u,d=n;for(;!u&&d;)u=Eg(d,t),d=d.__proto__;u&&u.set&&(h.set=u.set),n[a]&&(h.set=n[a],delete n[a]),qe(n,t,h)}const BS=new Tt("rewrite"),Aa=[],OS=["destroy","constructor"];function Ai(i){return(t,e)=>{Aa.push({name:t.constructor.name+"."+e,run:()=>{t[e]=i}})}}function Za(){return i=>{Lg()}}function Lg(i){Aa.length&&(Aa.forEach(t=>{i&&BS.error(t.name,"需在Class上装饰@rewriteAble()"),t.run()}),Aa.length=0)}setTimeout(()=>Lg(!0));function Ti(i,t){return e=>{(i.prototype?vS(i.prototype):Object.keys(i)).forEach(o=>{!OS.includes(o)&&(!t||!t.includes(o))&&(i.prototype?Eg(i.prototype,o).writable&&(e.prototype[o]=i.prototype[o]):e.prototype[o]=i[o])})}}function we(){return i=>{Ya.register(i)}}function Vn(){return i=>{ls.register(i)}}const{copy:Zr,toInnerPoint:PS,toOuterPoint:AS,scaleOfOuter:P_,rotateOfOuter:MS,skewOfOuter:IS,multiplyParent:A_,divideParent:M_,getLayout:DS}=ot,Xt={},Ne={updateAllMatrix(i,t,e){if(t&&i.__hasAutoLayout&&i.__layout.matrixChanged&&(e=!0),FS(i,t,e),i.isBranch){const{children:n}=i;for(let o=0,a=n.length;o<a;o++)WS(n[o],t,e)}},updateMatrix(i,t,e){const n=i.__layout;t?e&&(n.waitAutoLayout=!0,i.__hasAutoLayout&&(n.matrixChanged=!1)):n.waitAutoLayout&&(n.waitAutoLayout=!1),n.matrixChanged&&i.__updateLocalMatrix(),n.waitAutoLayout||i.__updateWorldMatrix()},updateBounds(i){const t=i.__layout;t.boundsChanged&&i.__updateLocalBounds(),t.waitAutoLayout||i.__updateWorldBounds()},updateAllWorldOpacity(i){if(i.__updateWorldOpacity(),i.isBranch){const{children:t}=i;for(let e=0,n=t.length;e<n;e++)I_(t[e])}},updateAllChange(i){if(I_(i),i.__updateChange(),i.isBranch){const{children:t}=i;for(let e=0,n=t.length;e<n;e++)$S(t[e])}},worldHittable(i){for(;i;){if(!i.__.hittable)return!1;i=i.parent}return!0},moveWorld(i,t,e=0,n){const o=typeof t=="object"?Object.assign({},t):{x:t,y:e};n?AS(i.localTransform,o,o,!0):i.parent&&PS(i.parent.worldTransform,o,o,!0),ke.moveLocal(i,o.x,o.y)},moveLocal(i,t,e=0){typeof t=="object"?(i.x+=t.x,i.y+=t.y):(i.x+=t,i.y+=e)},zoomOfWorld(i,t,e,n,o){ke.zoomOfLocal(i,Ul(i,t),e,n,o)},zoomOfLocal(i,t,e,n=e,o){Zr(Xt,i.__localMatrix),P_(Xt,t,e,n),i.origin||i.around?ke.setTransform(i,Xt,o):(D_(i,Xt),i.scaleResize(e,n,o!==!0))},rotateOfWorld(i,t,e){ke.rotateOfLocal(i,Ul(i,t),e)},rotateOfLocal(i,t,e){Zr(Xt,i.__localMatrix),MS(Xt,t,e),i.origin||i.around?ke.setTransform(i,Xt):(D_(i,Xt),i.rotation=fe.formatRotation(i.rotation+e))},skewOfWorld(i,t,e,n,o){ke.skewOfLocal(i,Ul(i,t),e,n,o)},skewOfLocal(i,t,e,n=0,o){Zr(Xt,i.__localMatrix),IS(Xt,t,e,n),ke.setTransform(i,Xt,o)},transformWorld(i,t,e){Zr(Xt,i.worldTransform),A_(Xt,t),i.parent&&M_(Xt,i.parent.worldTransform),ke.setTransform(i,Xt,e)},transform(i,t,e){Zr(Xt,i.localTransform),A_(Xt,t),ke.setTransform(i,Xt,e)},setTransform(i,t,e){const n=DS(t,i.origin&&ke.getInnerOrigin(i,i.origin),i.around&&ke.getInnerOrigin(i,i.around));if(e){const o=n.scaleX/i.scaleX,a=n.scaleY/i.scaleY;delete n.scaleX,delete n.scaleY,i.set(n),i.scaleResize(o,a,e!==!0)}else i.set(n)},getFlipTransform(i,t){const e=$a(),n=t==="x"?1:-1;return P_(e,ke.getLocalOrigin(i,"center"),-1*n,1*n),e},getLocalOrigin(i,t){return rt.tempToOuterOf(ke.getInnerOrigin(i,t),i.localTransform)},getInnerOrigin(i,t){const e={};return gn.toPoint(t,i.boxBounds,e),e},getRelativeWorld(i,t,e){return Zr(Xt,i.worldTransform),M_(Xt,t.worldTransform),e?Xt:Object.assign({},Xt)},drop(i,t,e,n){i.setTransform(ke.getRelativeWorld(i,t,!0),n),t.add(i,e)},hasParent(i,t){if(!t)return!1;for(;i;){if(t===i)return!0;i=i.parent}}},ke=Ne,{updateAllMatrix:WS,updateMatrix:FS,updateAllWorldOpacity:I_,updateAllChange:$S}=ke;function D_(i,t){const{e,f:n}=i.__localMatrix;i.x+=t.e-e,i.y+=t.f-n}function Ul(i,t){return i.__layout.update(),i.parent?rt.tempToInnerOf(t,i.parent.__world):t}const Ka={worldBounds(i){return i.__world},localBoxBounds(i){return i.__.eraser||i.__.visible===0?null:i.__local||i.__layout},localStrokeBounds(i){return i.__.eraser||i.__.visible===0?null:i.__layout.localStrokeBounds},localRenderBounds(i){return i.__.eraser||i.__.visible===0?null:i.__layout.localRenderBounds},maskLocalBoxBounds(i){return i.__.mask?i.__localBoxBounds:null},maskLocalStrokeBounds(i){return i.__.mask?i.__layout.localStrokeBounds:null},maskLocalRenderBounds(i){return i.__.mask?i.__layout.localRenderBounds:null},excludeRenderBounds(i,t){return!!(t.bounds&&!t.bounds.hit(i.__world,t.matrix)||t.hideBounds&&t.hideBounds.includes(i.__world,t.matrix))}},{updateBounds:W_}=Ne,po={sort(i,t){return i.__.zIndex===t.__.zIndex?i.__tempNumber-t.__tempNumber:i.__.zIndex-t.__.zIndex},pushAllChildBranch(i,t){if(i.__tempNumber=1,i.__.__childBranchNumber){const{children:e}=i;for(let n=0,o=e.length;n<o;n++)i=e[n],i.isBranch&&(i.__tempNumber=1,t.add(i),zS(i,t))}},pushAllParent(i,t){const{keys:e}=t;if(e)for(;i.parent&&e[i.parent.innerId]===void 0;)t.add(i.parent),i=i.parent;else for(;i.parent;)t.add(i.parent),i=i.parent},pushAllBranchStack(i,t){let e=t.length;const{children:n}=i;for(let o=0,a=n.length;o<a;o++)n[o].isBranch&&t.push(n[o]);for(let o=e,a=t.length;o<a;o++)F_(t[o],t)},updateBounds(i,t){const e=[i];F_(i,e),HS(e,t)},updateBoundsByBranchStack(i,t){let e,n;for(let o=i.length-1;o>-1;o--){e=i[o],n=e.children;for(let a=0,h=n.length;a<h;a++)W_(n[a]);t&&t===e||W_(e)}}},{pushAllChildBranch:zS,pushAllBranchStack:F_,updateBoundsByBranchStack:HS}=po,$s={run(i){if(i&&i.length){const t=i.length;for(let e=0;e<t;e++)i[e]();i.length===t?i.length=0:i.splice(0,t)}}},{getRelativeWorld:$_}=Ne,{toOuterOf:Ea,getPoints:NS,copy:US}=q,Gl="_localContentBounds",Vl="_worldContentBounds",Yl="_worldBoxBounds",Xl="_worldStrokeBounds";class GS{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}get localContentBounds(){return Ea(this.contentBounds,this.leaf.__localMatrix,this[Gl]||(this[Gl]={})),this[Gl]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return Ea(this.contentBounds,this.leaf.__world,this[Vl]||(this[Vl]={})),this[Vl]}get worldBoxBounds(){return Ea(this.boxBounds,this.leaf.__world,this[Yl]||(this[Yl]={})),this[Yl]}get worldStrokeBounds(){return Ea(this.strokeBounds,this.leaf.__world,this[Xl]||(this[Xl]={})),this[Xl]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.boxBounds={x:0,y:0,width:0,height:0},this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),this.boxChange(),this.matrixChange()}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leafer:t}=this.leaf;if(t)t.ready?t.watcher.changed&&t.layouter.layout():t.start();else{let e=this.leaf;for(;e.parent&&!e.parent.leafer;)e=e.parent;V.layout(e)}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return ot.defaultMatrix;case"page":t=e.zoomLayer;default:return $_(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new zt(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",n){const{leaf:o}=this;let a,h,u,d=this.getInnerBounds(t);switch(e){case"world":a=o.getWorldPoint(d),h=o.__world;break;case"local":const{scaleX:f,scaleY:y,rotation:x,skewX:E,skewY:m}=o.__;u={scaleX:f,scaleY:y,rotation:x,skewX:E,skewY:m},a=o.getLocalPointByInner(d);break;case"inner":a=d,h=ot.defaultMatrix;break;case"page":e=o.zoomLayer;default:a=o.getWorldPoint(d,e),h=$_(o,e,!0)}if(u||(u=ot.getLayout(h)),US(u,d),rt.copy(u,a),n){const{scaleX:f,scaleY:y}=u,x=Math.abs(f),E=Math.abs(y);(x!==1||E!==1)&&(u.scaleX/=x,u.scaleY/=E,u.width*=x,u.height*=E)}return u}getLayoutPoints(t,e="world"){const{leaf:n}=this,o=NS(this.getInnerBounds(t));let a;switch(e){case"world":a=null;break;case"local":a=n.parent;break;case"inner":break;case"page":e=n.zoomLayer;default:a=e}return a!==void 0&&o.forEach(h=>n.innerToWorld(h,null,!1,a)),o}shrinkContent(){const{x:t,y:e,width:n,height:o}=this.boxBounds;this._contentBounds={x:t,y:e,width:n,height:o}}spreadStroke(){const{x:t,y:e,width:n,height:o}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:n,height:o},this._localStrokeBounds={x:t,y:e,width:n,height:o},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:n,height:o}=this.renderBounds;this._renderBounds={x:t,y:e,width:n,height:o},this._localRenderBounds={x:t,y:e,width:n,height:o}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged||this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged||this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class Zi{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&V.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&V.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&V.event.stop(this.origin)}}class Jt extends Zi{constructor(t,e,n){super(t,e),this.parent=n,this.child=e}}Jt.ADD="child.add";Jt.REMOVE="child.remove";Jt.CREATED="created";Jt.MOUNTED="mounted";Jt.UNMOUNTED="unmounted";Jt.DESTROY="destroy";class Gi extends Zi{constructor(t,e,n,o,a){super(t,e),this.attrName=n,this.oldValue=o,this.newValue=a}}Gi.CHANGE="property.change";Gi.LEAFER_CHANGE="property.leafer_change";class Vi extends Zi{constructor(t,e){super(t),Object.assign(this,e)}}Vi.LOAD="image.load";Vi.LOADED="image.loaded";Vi.ERROR="image.error";class yn extends Zi{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return this.old?this.pixelRatio===this.old.pixelRatio:!0}constructor(t,e){typeof t=="object"?(super(yn.RESIZE),Object.assign(this,t)):super(t),this.old=e}}yn.RESIZE="resize";class Nn extends Zi{constructor(t,e){super(t),this.data=e}}Nn.REQUEST="watch.request";Nn.DATA="watch.data";class Ct extends Zi{constructor(t,e,n){super(t),e&&(this.data=e,this.times=n)}}Ct.CHECK_UPDATE="layout.check_update";Ct.REQUEST="layout.request";Ct.START="layout.start";Ct.BEFORE="layout.before";Ct.LAYOUT="layout";Ct.AFTER="layout.after";Ct.AGAIN="layout.again";Ct.END="layout.end";class St extends Zi{constructor(t,e,n,o){super(t),e&&(this.times=e),n&&(this.renderBounds=n,this.renderOptions=o)}}St.REQUEST="render.request";St.CHILD_START="render.child_start";St.START="render.start";St.BEFORE="render.before";St.RENDER="render";St.AFTER="render.after";St.AGAIN="render.again";St.END="render.end";St.NEXT="render.next";class Kt extends Zi{}Kt.START="leafer.start";Kt.BEFORE_READY="leafer.before_ready";Kt.READY="leafer.ready";Kt.AFTER_READY="leafer.after_ready";Kt.VIEW_READY="leafer.view_ready";Kt.VIEW_COMPLETED="leafer.view_completed";Kt.STOP="leafer.stop";Kt.RESTART="leafer.restart";Kt.END="leafer.end";const z_={};class VS{set event(t){this.on(t)}on(t,e,n){if(!e){let y,x=t;for(let E in x)y=x[E],y instanceof Array?this.on(E,y[0],y[1]):this.on(E,y);return}let o,a;n&&(n==="once"?a=!0:typeof n=="boolean"?o=n:(o=n.capture,a=n.once));let h;const u=Zl(this,o,!0),d=typeof t=="string"?t.split(" "):t,f=a?{listener:e,once:a}:{listener:e};d.forEach(y=>{y&&(h=u[y],h?h.findIndex(x=>x.listener===e)===-1&&h.push(f):u[y]=[f])})}off(t,e,n){if(t){const o=typeof t=="string"?t.split(" "):t;if(e){let a;n&&(a=typeof n=="boolean"?n:n==="once"?!1:n.capture);let h,u;const d=Zl(this,a);o.forEach(f=>{f&&(h=d[f],h&&(u=h.findIndex(y=>y.listener===e),u>-1&&h.splice(u,1),h.length||delete d[f]))})}else{const{__bubbleMap:a,__captureMap:h}=this;o.forEach(u=>{a&&delete a[u],h&&delete h[u]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,e,n,o){return n&&(e=e.bind(n)),this.on(t,e,o),{type:t,current:this,listener:e,options:o}}off_(t){if(!t)return;const e=t instanceof Array?t:[t];e.forEach(n=>n.current.off(n.type,n.listener,n.options)),e.length=0}once(t,e,n){this.on(t,e,{once:!0,capture:n})}emit(t,e,n){!e&&ls.has(t)&&(e=ls.get(t,{type:t,target:this,current:this}));const a=Zl(this,n)[t];if(a){let h;for(let u=0,d=a.length;u<d&&(h=a[u],h.listener(e),h.once&&(this.off(t,h.listener,n),u--,d--),!(e&&e.isStopNow));u++);}this.syncEventer&&this.syncEventer.emitEvent(e,n)}emitEvent(t,e){t.current=this,this.emit(t.type,t,e)}hasEvent(t,e){if(this.syncEventer&&this.syncEventer.hasEvent(t,e))return!0;const{__bubbleMap:n,__captureMap:o}=this,a=n&&n[t],h=o&&o[t];return!!(e===void 0?a||h:e?h:a)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function Zl(i,t,e){if(t){const{__captureMap:n}=i;return n||(e?i.__captureMap={}:z_)}else{const{__bubbleMap:n}=i;return n||(e?i.__bubbleMap={}:z_)}}const{on:YS,on_:XS,off:ZS,off_:KS,once:jS,emit:qS,emitEvent:JS,hasEvent:QS,destroy:tT}=VS.prototype,eT={on:YS,on_:XS,off:ZS,off_:KS,once:jS,emit:qS,emitEvent:JS,hasEvent:QS,destroyEventer:tT},{isFinite:iT}=Number,nT=Tt.get("setAttr"),rT={__setAttr(i,t,e){if(this.leaferIsCreated){const n=this.__.__getInput(i);if(e&&!iT(t)&&t!==void 0&&(nT.warn(this.innerName,i,t),t=void 0),typeof t=="object"||n!==t){this.__realSetAttr(i,t);const{CHANGE:o}=Gi,a=new Gi(o,this,i,n,t);return this.isLeafer?this.emitEvent(new Gi(Gi.LEAFER_CHANGE,this,i,n,t)):this.hasEvent(o)&&this.emitEvent(a),this.leafer.emitEvent(a),!0}else return!1}else return this.__realSetAttr(i,t),!0},__realSetAttr(i,t){const e=this.__;e[i]=t,this.__proxyData&&this.setProxyAttr(i,t),e.normalStyle&&(this.lockNormalStyle||e.normalStyle[i]===void 0||(e.normalStyle[i]=t))},__getAttr(i){return this.__proxyData?this.getProxyAttr(i):this.__.__get(i)}},{setLayout:sT,multiplyParent:oT,translateInner:aT,defaultWorld:hT}=ot,{toPoint:lT,tempPoint:Kl}=gn,uT={__updateWorldMatrix(){oT(this.__local||this.__layout,this.parent?this.parent.__world:hT,this.__world,!!this.__layout.affectScaleOrRotation,this.__,this.parent&&this.parent.__)},__updateLocalMatrix(){if(this.__local){const i=this.__layout,t=this.__local,e=this.__;i.affectScaleOrRotation&&(i.scaleChanged||i.rotationChanged)&&(sT(t,e,null,null,i.affectRotation),i.scaleChanged=i.rotationChanged=!1),t.e=e.x+e.offsetX,t.f=e.y+e.offsetY,(e.around||e.origin)&&(lT(e.around||e.origin,i.boxBounds,Kl),aT(t,-Kl.x,-Kl.y,!e.around))}this.__layout.matrixChanged=!1}},{updateMatrix:cT,updateAllMatrix:H_}=Ne,{updateBounds:N_}=po,{toOuterOf:Ca,copyAndSpread:U_,copy:dT}=q,{toBounds:fT}=Ju,_T={__updateWorldBounds(){Ca(this.__layout.renderBounds,this.__world,this.__world),this.__layout.resized&&(this.__onUpdateSize(),this.__layout.resized=!1)},__updateLocalBounds(){const i=this.__layout;i.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),i.resized=!0),i.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),i.localBoxChanged=!1,i.strokeSpread&&(i.strokeChanged=!0),i.renderSpread&&(i.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),i.boxChanged=!1,i.strokeChanged&&(i.strokeSpread=this.__updateStrokeSpread(),i.strokeSpread?(i.strokeBounds===i.boxBounds&&i.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):i.spreadStrokeCancel(),i.strokeChanged=!1,(i.renderSpread||i.strokeSpread!==i.strokeBoxSpread)&&(i.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),i.resized=!0),i.renderChanged&&(i.renderSpread=this.__updateRenderSpread(),i.renderSpread?((i.renderBounds===i.boxBounds||i.renderBounds===i.strokeBounds)&&i.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):i.spreadRenderCancel(),i.renderChanged=!1,this.parent&&this.parent.__layout.renderChange()),i.boundsChanged=!1},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),Ca(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){Ca(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){Ca(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(){const i=this.__layout.boxBounds,t=this.__;t.__pathInputed?fT(t.path,i):(i.x=0,i.y=0,i.width=t.width,i.height=t.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.leaferIsReady&&this.leafer.layouter.addExtra(this),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),H_(this),N_(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(H_(this),N_(this,this))):cT(this)},__updateNaturalSize(){const{__:i,__layout:t}=this;i.__naturalWidth=t.boxBounds.width,i.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(){const i=this.__layout;U_(i.strokeBounds,i.boxBounds,i.strokeBoxSpread)},__updateRenderBounds(){const i=this.__layout;i.renderSpread>0?U_(i.renderBounds,i.boxBounds,i.renderSpread):dT(i.renderBounds,i.strokeBounds)}},pT={__render(i,t){if(this.__worldOpacity)if(i.setWorld(this.__nowWorld=this.__getNowWorld(t)),i.opacity=this.__.opacity,this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(i,t);const e=i.getSameCanvas(!0,!0);this.__draw(e,t),this.__worldFlipped?i.copyWorldByReset(e,this.__nowWorld,null,this.__.__blendMode,!0):i.copyWorldToInner(e,this.__nowWorld,this.__layout.renderBounds,this.__.__blendMode),e.recycle(this.__nowWorld)}else this.__draw(i,t)},__clip(i,t){this.__worldOpacity&&(i.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(i),this.windingRule?i.clip(this.windingRule):i.clip())},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:G_}=Ka,gT={__updateChange(){const{__layout:i}=this;i.childrenSortChanged&&(this.__updateSortChildren(),i.childrenSortChanged=!1),this.__.__checkSingle()},__render(i,t){if(this.__worldOpacity)if(this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(i,t);const e=i.getSameCanvas(!1,!0);this.__renderBranch(e,t);const n=this.__getNowWorld(t);i.opacity=this.__.opacity,i.copyWorldByReset(e,n,n,this.__.__blendMode,!0),e.recycle(n)}else this.__renderBranch(i,t)},__renderBranch(i,t){if(this.__hasMask)this.__renderMask(i,t);else{const{children:e}=this;for(let n=0,o=e.length;n<o;n++)G_(e[n],t)||e[n].__render(i,t)}},__clip(i,t){if(this.__worldOpacity){const{children:e}=this;for(let n=0,o=e.length;n<o;n++)G_(e[n],t)||e[n].__clip(i,t)}}},{LEAF:yT,create:vT}=pn,{toInnerPoint:mT,toOuterPoint:wT,multiplyParent:xT}=ot,{toOuterOf:V_}=q,{copy:Y_,move:X_}=rt,{moveLocal:bT,zoomOfLocal:ET,rotateOfLocal:CT,skewOfLocal:ST,moveWorld:Z_,zoomOfWorld:TT,rotateOfWorld:RT,skewOfWorld:LT,transform:K_,transformWorld:kT,setTransform:BT,getFlipTransform:OT,getLocalOrigin:jl,getRelativeWorld:PT,drop:AT}=Ne;let yr=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return dg}get __LayoutProcessor(){return GS}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.__layout.update(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){const{leafer:t}=this;return t&&t.created&&t.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(t){this.on(t)}constructor(t){this.innerId=vT(yT),this.reset(t),this.__bubbleMap&&this.__emitLifeEvent(Jt.CREATED)}reset(t){this.leafer&&this.leafer.forceRender(this.__world),this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},t!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0}),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.on(Jt.ADD,t,"once")}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.on(Jt.MOUNTED,t,"once")}nextRender(t,e,n){this.leafer?this.leafer.nextRender(t,e,n):this.waitLeafer(()=>this.leafer.nextRender(t,e,n))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&t!==null&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t?(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(Jt.MOUNTED)):this.__emitLifeEvent(Jt.UNMOUNTED),this.isBranch){const{children:e}=this;for(let n=0,o=e.length;n<o;n++)e[n].__bindLeafer(t)}}set(t,e){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(t){t===void 0?t="width":t==="surface"&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=e===void 0?null:void 0,this[t]=e}forceRender(t){this.forceUpdate("surface")}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(){}__updateContentBounds(){}__updateStrokeBounds(){}__updateRenderBounds(){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=t?!0:this.children.some(e=>e.__.eraser)}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:n}=this.__layout;t.clearRect(n.x,n.y,n.width,n.height),t.restore()}__updateMask(t){this.__hasMask=t?!0:this.children.some(e=>e.__.mask)}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld;return xT(this.__world,t.matrix,e,void 0,this.__world),V_(this.__layout.renderBounds,e,e),e}else return this.__world}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,n){return this.__layout.getLayoutBounds(t,e,n)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,n){const o=e?PT(this,e):this.worldTransform,a=n?t:{};return V_(t,o,a),a}worldToLocal(t,e,n,o){this.parent?this.parent.worldToInner(t,e,n,o):e&&Y_(e,t)}localToWorld(t,e,n,o){this.parent?this.parent.innerToWorld(t,e,n,o):e&&Y_(e,t)}worldToInner(t,e,n,o){o&&(o.innerToWorld(t,e,n),t=e||t),mT(this.worldTransform,t,e,n)}innerToWorld(t,e,n,o){wT(this.worldTransform,t,e,n),o&&o.worldToInner(e||t,null,n)}getBoxPoint(t,e,n,o){return this.getBoxPointByInner(this.getInnerPoint(t,e,n,o),null,null,!0)}getBoxPointByInner(t,e,n,o){const a=o?t:Object.assign({},t),{x:h,y:u}=this.boxBounds;return X_(a,-h,-u),a}getInnerPoint(t,e,n,o){const a=o?t:{};return this.worldToInner(t,a,n,e),a}getInnerPointByBox(t,e,n,o){const a=o?t:Object.assign({},t),{x:h,y:u}=this.boxBounds;return X_(a,h,u),a}getInnerPointByLocal(t,e,n,o){return this.getInnerPoint(t,this.parent,n,o)}getLocalPoint(t,e,n,o){const a=o?t:{};return this.worldToLocal(t,a,n,e),a}getLocalPointByInner(t,e,n,o){return this.getWorldPoint(t,this.parent,n,o)}getPagePoint(t,e,n,o){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(t,e,n,o)}getWorldPoint(t,e,n,o){const a=o?t:{};return this.innerToWorld(t,a,n,e),a}getWorldPointByBox(t,e,n,o){return this.getWorldPoint(this.getInnerPointByBox(t,null,null,o),e,n,!0)}getWorldPointByLocal(t,e,n,o){const a=o?t:{};return this.localToWorld(t,a,n,e),a}getWorldPointByPage(t,e,n,o){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(t,e,n,o)}setTransform(t,e){BT(this,t,e)}transform(t,e){K_(this,t,e)}move(t,e){bT(this,t,e)}moveInner(t,e){Z_(this,t,e,!0)}scaleOf(t,e,n,o){ET(this,jl(this,t),e,n,o)}rotateOf(t,e){CT(this,jl(this,t),e)}skewOf(t,e,n,o){ST(this,jl(this,t),e,n,o)}transformWorld(t,e){kT(this,t,e)}moveWorld(t,e){Z_(this,t,e)}scaleOfWorld(t,e,n,o){TT(this,t,e,n,o)}rotateOfWorld(t,e){RT(this,t,e)}skewOfWorld(t,e,n,o){LT(this,t,e,n,o)}flip(t){K_(this,OT(this,t))}scaleResize(t,e=t,n){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e){}__clip(t,e){}__renderShape(t,e,n,o){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return hs("path")}getMotionPoint(t){return hs("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(t,e){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,n){AT(this,t,e,n)}on(t,e,n){}off(t,e,n){}on_(t,e,n,o){}off_(t){}once(t,e,n){}emit(t,e,n){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,n){n?this.addAttr(t,e,n):Rg(this.prototype,t,e)}static addAttr(t,e,n){n||(n=It),n(e)(this.prototype,t)}__emitLifeEvent(t){this.hasEvent(t)&&this.emitEvent(new Jt(t,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(Jt.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}};yr=X([Ti(rT),Ti(uT),Ti(_T),Ti(eT),Ti(pT)],yr);const{setListWithFn:ql}=q,{sort:MT}=po,{localBoxBounds:IT,localStrokeBounds:DT,localRenderBounds:WT,maskLocalBoxBounds:FT,maskLocalStrokeBounds:$T,maskLocalRenderBounds:zT}=Ka;let Ou=class extends yr{__updateStrokeSpread(){const{children:t}=this;for(let e=0,n=t.length;e<n;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,n=t.length;e<n;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(){ql(this.__layout.boxBounds,this.children,this.__hasMask?FT:IT)}__updateStrokeBounds(){ql(this.__layout.strokeBounds,this.children,this.__hasMask?$T:DT)}__updateRenderBounds(){ql(this.__layout.renderBounds,this.children,this.__hasMask?zT:WT)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let n=0,o=e.length;n<o;n++)e[n].__tempNumber=n,e[n].__.zIndex&&(t=!0);e.sort(MT),this.__layout.affectChildrenSort=t}}add(t,e){if(t===this)return;const n=e===void 0;if(!t.__){if(t instanceof Array)return t.forEach(o=>{this.add(o,e),n||e++});t=Ya.get(t.tag,t)}t.parent&&t.parent.remove(t),t.parent=this,n?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1),t.__layout.boxChanged||t.__layout.boxChange(),t.__layout.matrixChanged||t.__layout.matrixChange(),t.__bubbleMap&&t.__emitLifeEvent(Jt.ADD),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(Jt.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...t){this.add(t)}remove(t,e){t?t.__?t.animationOut?t.__runAnimation("out",()=>this.__remove(t,e)):this.__remove(t,e):this.find(t).forEach(n=>this.remove(n,e)):t===void 0&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach(n=>{this.__realRemoveChild(n),t&&n.destroy()}))}clear(){this.removeAll(!0)}__remove(t,e){const n=this.children.indexOf(t);n>-1&&(this.children.splice(n,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.__emitLifeEvent(Jt.REMOVE),t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(Jt.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const n=new Jt(t,e,this);this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(n),this.leafer.emitEvent(n)}};Ou=X([Ti(gT)],Ou);class Pt{get length(){return this.list.length}constructor(t){this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return t&&this.keys[t.innerId]!==void 0}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return e===void 0?-1:e}add(t){const{list:e,keys:n}=this;n[t.innerId]===void 0&&(e.push(t),n[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:n}=this;if(n[t.innerId]===void 0){const{list:o}=this;for(let a=e,h=o.length;a<h;a++)n[o[a].innerId]++;e===0?o.unshift(t):(e>o.length&&(e=o.length),o.splice(e,0,t)),n[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let n;for(let o=0,a=e.length;o<a;o++)n!==void 0?this.keys[e[o].innerId]=o-1:e[o].innerId===t.innerId&&(n=o,delete this.keys[t.innerId]);n!==void 0&&e.splice(n,1)}sort(t){const{list:e}=this;t?e.sort((n,o)=>o.__level-n.__level):e.sort((n,o)=>n.__level-o.__level)}forEach(t){this.list.forEach(t)}clone(){const t=new Pt;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let n=0,o=t.length;n<o;n++)e[t[n].innerId]=n}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class HT{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return this.keys[t.innerId]!==void 0}without(t){return this.keys[t.innerId]===void 0}sort(t){const{levels:e}=this;t?e.sort((n,o)=>o-n):e.sort((n,o)=>n-o)}addList(t){t.forEach(e=>{this.add(e)})}add(t){const{keys:e,levelMap:n}=this;e[t.innerId]||(e[t.innerId]=1,n[t.__level]?n[t.__level].push(t):(n[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach(n=>{e=this.levelMap[n];for(let o=0,a=e.length;o<a;o++)t(e[o])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}function R(i,t,e,n){var o=arguments.length,a=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(h=i[u])&&(a=(o<3?h(a):o>3?h(t,e,a):h(t,e))||a);return o>3&&a&&Object.defineProperty(t,e,a),a}function go(i){return re(i,t=>({set(e){this.__setAttr(t,e),e&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function yo(i){return re(i,t=>({set(e){this.__setAttr(t,e),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function NT(){return(i,t)=>{const e="_"+t;qe(i,t,{set(n){this.isLeafer&&(this[e]=n)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[e]||this:this.leafer&&this.leafer.zoomLayer}})}}const kg={},vr={},j_={number(i,t){return typeof i=="object"?i.type==="percent"?i.value*t:i.value:i}},Bg={},Zt={},mr={},Ma={},Pu={},rs={},q_={setStyleName(i,t,e){return hs("state")},set(i,t){return hs("state")}},{parse:UT,objectToCanvasData:GT}=gr,J_={},Q_=Tt.get("UIData");class mn extends dg{get scale(){const{scaleX:t,scaleY:e}=this;return t!==e?{x:t,y:e}:t}get __strokeWidth(){const{strokeWidth:t,strokeWidthFixed:e}=this;if(e){const n=this.__leaf;let{scaleX:o}=n.__nowWorld||n.__world;return o<0&&(o=-o),o>1?t/o:t}else return t}get __hasStroke(){return this.stroke&&this.strokeWidth}get __clipAfterFill(){return this.cornerRadius||this.__pathInputed}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this._visible=t;const{leafer:e}=this.__leaf;e&&(e.watcher.hasVisible=!0)}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,Q_.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,Q_.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),typeof t=="string"||!t?(this.__isFills&&(this.__removeInput("fill"),mr.recycleImage("fill",this),this.__isFills=!1,this.__pixelFill&&(this.__pixelFill=!1)),this._fill=t):typeof t=="object"&&(this.__setInput("fill",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isFills=!0,this._fill||(this._fill=J_))}setStroke(t){typeof t=="string"||!t?(this.__isStrokes&&(this.__removeInput("stroke"),mr.recycleImage("stroke",this),this.__isStrokes=!1,this.__pixelStroke&&(this.__pixelStroke=!1)),this._stroke=t):typeof t=="object"&&(this.__setInput("stroke",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isStrokes=!0,this._stroke||(this._stroke=J_))}setPath(t){const e=typeof t=="string";e||t&&typeof t[0]=="object"?(this.__setInput("path",t),this._path=e?UT(t):GT(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){this.__setInput("shadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._shadow=t.length?t:null):this._shadow=t&&t.visible!==!1?[t]:null}setInnerShadow(t){this.__setInput("innerShadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._innerShadow=t.length?t:null):this._innerShadow=t&&t.visible!==!1?[t]:null}__computePaint(){const{fill:t,stroke:e}=this.__input;t&&Zt.compute("fill",this.__leaf),e&&Zt.compute("stroke",this.__leaf),this.__needComputePaint=!1}}class ja extends mn{}class Og extends ja{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return this.overflow==="hide"&&this.__clipAfterFill&&this.__leaf.children.length}get __clipAfterFill(){return this.__leaf.isOverflow||super.__clipAfterFill}}class VT extends ja{__getInputData(t,e){const n=super.__getInputData(t,e);return Ni.forEach(o=>delete n[o]),n}}class YT extends Og{}class XT extends mn{}class tc extends mn{get __boxStroke(){return!this.__pathInputed}}class ZT extends mn{get __boxStroke(){return!this.__pathInputed}}class KT extends mn{}class jT extends mn{}class qT extends mn{get __pathInputed(){return 2}}class JT extends ja{}const QT={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};class tR extends mn{get __useNaturalRatio(){return!1}setFontWeight(t){typeof t=="string"?(this.__setInput("fontWeight",t),this._fontWeight=QT[t]||400):(this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t)}}class eR extends tc{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.__leaf.image&&(this.__leaf.image=null),this.fill=t?{type:"image",mode:"stretch",url:t}:void 0}__getData(){const t=super.__getData();return delete t.fill,t}__getInputData(t,e){const n=super.__getInputData(t,e);return delete n.fill,n}}class iR extends tc{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(t,e){const n=super.__getInputData(t,e);return n.url=this.__leaf.canvas.toDataURL("image/png"),n}}const nR={__updateStrokeSpread(){let i=0,t=0;const e=this.__,{strokeAlign:n,strokeWidth:o}=e;if((e.stroke||e.hitStroke==="all")&&o&&n!=="inside"&&(t=i=n==="center"?o/2:o,!e.__boxStroke)){const a=e.__isLinePath?0:10*i,h=e.strokeCap==="none"?0:o;i+=Math.max(a,h)}return e.__useArrow&&(i+=o*5),this.__layout.strokeBoxSpread=t,i},__updateRenderSpread(){let i=0;const{shadow:t,innerShadow:e,blur:n,backgroundBlur:o}=this.__;t&&t.forEach(h=>i=Math.max(i,Math.max(Math.abs(h.y),Math.abs(h.x))+(h.spread>0?h.spread:0)+h.blur*1.5)),n&&(i=Math.max(i,n));let a=i=Math.ceil(i);return e&&e.forEach(h=>a=Math.max(a,Math.max(Math.abs(h.y),Math.abs(h.x))+(h.spread<0?-h.spread:0)+h.blur*1.5)),o&&(a=Math.max(a,o)),this.__layout.renderShapeSpread=a,i+(this.__layout.strokeSpread||0)}},rR={__updateChange(){const i=this.__;if(i.__useEffect){const{shadow:e,innerShadow:n,blur:o,backgroundBlur:a}=this.__;i.__useEffect=!!(e||n||o||a)}i.__checkSingle(),i.__isFills||i.__isStrokes||i.cornerRadius||i.__useEffect?i.__complex=!0:i.__complex&&(i.__complex=!1)},__drawFast(i,t){tp(this,i,t)},__draw(i,t){const e=this.__;if(e.__complex){e.__needComputePaint&&e.__computePaint();const{fill:n,stroke:o,__drawAfterFill:a}=e;if(this.__drawRenderPath(i),e.__useEffect){const h=Zt.shape(this,i,t);this.__nowWorld=this.__getNowWorld(t);const{shadow:u,innerShadow:d}=e;u&&Pu.shadow(this,i,h),n&&(e.__isFills?Zt.fills(n,this,i):Zt.fill(n,this,i)),a&&this.__drawAfterFill(i,t),d&&Pu.innerShadow(this,i,h),o&&(e.__isStrokes?Zt.strokes(o,this,i):Zt.stroke(o,this,i)),h.worldCanvas&&h.worldCanvas.recycle(),h.canvas.recycle()}else n&&(e.__isFills?Zt.fills(n,this,i):Zt.fill(n,this,i)),a&&this.__drawAfterFill(i,t),o&&(e.__isStrokes?Zt.strokes(o,this,i):Zt.stroke(o,this,i))}else e.__pathInputed?tp(this,i,t):this.__drawFast(i,t)},__renderShape(i,t,e,n){if(this.__worldOpacity){i.setWorld(this.__nowWorld=this.__getNowWorld(t));const{fill:o,stroke:a}=this.__;this.__drawRenderPath(i),o&&!e&&(this.__.__pixelFill?Zt.fills(o,this,i):Zt.fill("#000000",this,i)),this.__.__isCanvas&&this.__drawAfterFill(i,t),a&&!n&&(this.__.__pixelStroke?Zt.strokes(a,this,i):Zt.stroke("#000000",this,i))}},__drawAfterFill(i,t){this.__.__clipAfterFill?(i.save(),this.windingRule?i.clip(this.windingRule):i.clip(),this.__drawContent(i,t),i.restore()):this.__drawContent(i,t)}};function tp(i,t,e){const{fill:n,stroke:o,__drawAfterFill:a}=i.__;i.__drawRenderPath(t),n&&Zt.fill(n,i,t),a&&i.__drawAfterFill(t,e),o&&Zt.stroke(o,i,t)}const sR={__drawFast(i,t){let{width:e,height:n,fill:o,stroke:a,__drawAfterFill:h}=this.__;if(o&&(i.fillStyle=o,i.fillRect(0,0,e,n)),h&&this.__drawAfterFill(i,t),a){const{strokeAlign:u,__strokeWidth:d}=this.__;if(!d)return;i.setStroke(a,d,this.__);const f=d/2;switch(u){case"center":i.strokeRect(0,0,e,n);break;case"inside":e-=d,n-=d,e<0||n<0?(i.save(),this.__clip(i,t),i.strokeRect(f,f,e,n),i.restore()):i.strokeRect(f,f,e,n);break;case"outside":i.strokeRect(-f,-f,e+d,n+d);break}}}};var Au;let z=Au=class extends yr{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(t){fe.assignScale(this,t)}get scale(){return this.__.scale}get pen(){const{path:t}=this.__;return Fs.set(this.path=t||[]),t||this.__drawPathByBox(Fs),Fs}get editConfig(){}get editOuter(){return""}get editInner(){return""}constructor(t){super(t)}reset(t){}set(t,e){e?(this.lockNormalStyle=!0,Object.assign(this,t),this.lockNormalStyle=!1):Object.assign(this,t)}get(t){return typeof t=="string"?this.__.__getInput(t):this.__.__getInputData(t)}createProxyData(){}find(t,e){}findTag(t){return this.find({tag:t})}findOne(t,e){}findId(t){return this.findOne({id:t})}getPath(t,e){this.__layout.update();let n=e?this.__.__pathForRender:this.__.path;return n||(Fs.set(n=[]),this.__drawPathByBox(Fs)),t?gr.toCanvasData(n,!0):n}getPathString(t,e,n){return gr.stringify(this.getPath(t,e),n)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const t=this.__;t.lazy&&!this.__inLazyBounds&&!rs.running?t.__needComputePaint=!0:t.__computePaint()}}__updateRenderPath(){if(this.__.path){const t=this.__;t.__pathForRender=t.cornerRadius?cS.smooth(t.path,t.cornerRadius,t.cornerSmoothing):t.path,t.__useArrow&&Bg.addArrows(this,!t.cornerRadius)}}__drawRenderPath(t){t.beginPath(),this.__drawPathByData(t,this.__.__pathForRender)}__drawPath(t){t.beginPath(),this.__drawPathByData(t,this.__.path)}__drawPathByData(t,e){e?VC.drawPathByData(t,e):this.__drawPathByBox(t)}__drawPathByBox(t){const{x:e,y:n,width:o,height:a}=this.__layout.boxBounds;if(this.__.cornerRadius){const{cornerRadius:h}=this.__;t.roundRect(e,n,o,a,typeof h=="number"?[h]:h)}else t.rect(e,n,o,a)}animate(t,e,n,o){return hs("animate")}killAnimate(t){}export(t,e){return rs.export(this,t,e)}clone(t){const e=this.toJSON();return t&&Object.assign(e,t),Au.one(e)}static one(t,e,n,o,a){return Ya.get(t.tag||this.prototype.__tag,t,e,n,o,a)}static registerUI(){we()(this)}static registerData(t){me(t)(this.prototype)}static setEditConfig(t){}static setEditOuter(t){}static setEditInner(t){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}};R([me(mn)],z.prototype,"__",void 0);R([NT()],z.prototype,"zoomLayer",void 0);R([Pi("")],z.prototype,"id",void 0);R([Pi("")],z.prototype,"name",void 0);R([Pi("")],z.prototype,"className",void 0);R([_o("pass-through")],z.prototype,"blendMode",void 0);R([ES(1)],z.prototype,"opacity",void 0);R([CS(!0)],z.prototype,"visible",void 0);R([_o(!1)],z.prototype,"locked",void 0);R([SS(0)],z.prototype,"zIndex",void 0);R([TS(!1)],z.prototype,"mask",void 0);R([RS(!1)],z.prototype,"eraser",void 0);R([ps(0,!0)],z.prototype,"x",void 0);R([ps(0,!0)],z.prototype,"y",void 0);R([It(100,!0)],z.prototype,"width",void 0);R([It(100,!0)],z.prototype,"height",void 0);R([Sg(1,!0)],z.prototype,"scaleX",void 0);R([Sg(1,!0)],z.prototype,"scaleY",void 0);R([Qu(0,!0)],z.prototype,"rotation",void 0);R([Qu(0,!0)],z.prototype,"skewX",void 0);R([Qu(0,!0)],z.prototype,"skewY",void 0);R([ps(0,!0)],z.prototype,"offsetX",void 0);R([ps(0,!0)],z.prototype,"offsetY",void 0);R([ps(0,!0)],z.prototype,"scrollX",void 0);R([ps(0,!0)],z.prototype,"scrollY",void 0);R([Cg()],z.prototype,"origin",void 0);R([Cg()],z.prototype,"around",void 0);R([Pi(!1)],z.prototype,"lazy",void 0);R([wS(1)],z.prototype,"pixelRatio",void 0);R([xS()],z.prototype,"path",void 0);R([Oe()],z.prototype,"windingRule",void 0);R([Oe(!0)],z.prototype,"closed",void 0);R([It(0)],z.prototype,"padding",void 0);R([Pi(!1)],z.prototype,"draggable",void 0);R([Pi()],z.prototype,"dragBounds",void 0);R([Pi(!1)],z.prototype,"editable",void 0);R([xr(!0)],z.prototype,"hittable",void 0);R([xr("path")],z.prototype,"hitFill",void 0);R([Xi("path")],z.prototype,"hitStroke",void 0);R([xr(!1)],z.prototype,"hitBox",void 0);R([xr(!0)],z.prototype,"hitChildren",void 0);R([xr(!0)],z.prototype,"hitSelf",void 0);R([xr()],z.prototype,"hitRadius",void 0);R([LS("")],z.prototype,"cursor",void 0);R([_o()],z.prototype,"fill",void 0);R([Xi()],z.prototype,"stroke",void 0);R([Xi("inside")],z.prototype,"strokeAlign",void 0);R([Xi(1)],z.prototype,"strokeWidth",void 0);R([Xi(!1)],z.prototype,"strokeWidthFixed",void 0);R([Xi("none")],z.prototype,"strokeCap",void 0);R([Xi("miter")],z.prototype,"strokeJoin",void 0);R([Xi()],z.prototype,"dashPattern",void 0);R([Xi()],z.prototype,"dashOffset",void 0);R([Xi(10)],z.prototype,"miterLimit",void 0);R([Oe(0)],z.prototype,"cornerRadius",void 0);R([Oe()],z.prototype,"cornerSmoothing",void 0);R([go()],z.prototype,"shadow",void 0);R([go()],z.prototype,"innerShadow",void 0);R([go()],z.prototype,"blur",void 0);R([go()],z.prototype,"backgroundBlur",void 0);R([go()],z.prototype,"grayscale",void 0);R([Pi({})],z.prototype,"data",void 0);R([Ai(yr.prototype.reset)],z.prototype,"reset",null);z=Au=R([Ti(nR),Ti(rR),Za()],z);let de=class extends z{get __tag(){return"Group"}get isBranch(){return!0}constructor(t){super(t)}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t,e){if(t.children){const{children:n}=t;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t,e),n.forEach(o=>this.add(o)),t.children=n}else super.set(t,e)}toJSON(t){const e=super.toJSON(t);return e.children=this.children.map(n=>n.toJSON(t)),e}pick(t,e){}addAt(t,e){this.add(t,e)}addAfter(t,e){this.add(t,this.children.indexOf(e)+1)}addBefore(t,e){this.add(t,this.children.indexOf(e))}add(t,e){}addMany(...t){}remove(t,e){}removeAll(t){}clear(){}};R([me(ja)],de.prototype,"__",void 0);de=R([Ti(Ou),we()],de);var Ia;const Jl=Tt.get("Leafer");let Un=Ia=class extends de{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&He.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds()}constructor(t,e){super(e),this.config={type:"design",start:!0,hittable:!0,smooth:!0,lazySpeard:100,zoom:{min:.01,max:256},move:{holdSpaceKey:!0,holdMiddleKey:!0,autoDistance:2}},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=t,t&&(t.view||t.width)&&this.init(t),Ia.list.add(this)}init(t,e){if(this.canvas)return;this.__setLeafer(this),t&&ie.assign(this.config,t);let n;const{config:o}=this;this.initType(o.type);const a=this.canvas=qt.canvas(o);this.__controllers.push(this.renderer=qt.renderer(this,a,o),this.watcher=qt.watcher(this,o),this.layouter=qt.layouter(this,o)),this.isApp&&this.__setApp(),this.__checkAutoLayout(o,e),this.view=a.view,e?(this.__bindApp(e),n=e.running):(this.selector=qt.selector(this),this.interaction=qt.interaction(this,a,this.selector,o),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=qt.hitCanvasManager()),this.canvasManager=new cg,n=o.start),this.hittable=o.hittable,this.fill=o.fill,this.canvasManager.add(a),this.__listenEvents(),n&&(this.__startTimer=setTimeout(this.start.bind(this))),$s.run(this.__initWait),this.onInit()}onInit(){}initType(t){}set(t){this.waitInit(()=>{super.set(t)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(Kt.RESTART):this.emitLeafer(Kt.START),this.__controllers.forEach(t=>t.start()),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(t=>t.stop()),this.running=!1,this.emitLeafer(Kt.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(t){const e=ie.copyAttrs({},t,Ni);Object.keys(e).forEach(n=>this[n]=e[n])}forceRender(t){this.renderer.addBlock(t?new zt(t):this.canvas.bounds),this.viewReady&&this.renderer.update()}updateCursor(t){const e=this.interaction;e&&(t?e.setCursor(t):e.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(t){const{canvas:e}=this;if(!e||e.isSameSize(t))return;const n=ie.copyAttrs({},this.canvas,Ni);e.resize(t),this.updateLazyBounds(),this.__onResize(new yn(t,n))}__onResize(t){this.emitEvent(t),ie.copyAttrs(this.__,t,Ni),(!t.width||!t.height)&&Jl.warn("w = 0 or h = 0"),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(t){this.selector=t.selector,this.interaction=t.interaction,this.canvasManager=t.canvasManager,this.hitCanvasManager=t.hitCanvasManager}__setLeafer(t){this.leafer=t,this.__level=1}__checkAutoLayout(t,e){e||((!t.width||!t.height)&&(this.autoLayout=new cE(t)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(t,e){return this.canvas&&(Ni.includes(t)?(e||Jl.warn(t+" is 0"),this.__changeCanvasSize(t,e)):t==="fill"?this.__changeFill(e):t==="hittable"?this.parent||(this.canvas.hittable=e):t==="zIndex"&&(this.canvas.zIndex=e,setTimeout(()=>this.parent&&this.parent.__updateSortChildren()))),super.__setAttr(t,e)}__getAttr(t){return this.canvas&&Ni.includes(t)?this.canvas[t]:super.__getAttr(t)}__changeCanvasSize(t,e){const n=ie.copyAttrs({},this.canvas,Ni);n[t]=this.config[t]=e,e&&this.canvas.stopAutoLayout(),this.__doResize(n)}__changeFill(t){this.config.fill=t,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=t:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready||(this.ready=!0,this.emitLeafer(Kt.BEFORE_READY),this.emitLeafer(Kt.READY),this.emitLeafer(Kt.AFTER_READY),$s.run(this.__readyWait))}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(Kt.VIEW_READY),$s.run(this.__viewReadyWait))}__onNextRender(){if(this.viewReady){$s.run(this.__nextRenderWait);const{imageReady:t}=this;t&&!this.viewCompleted&&this.__checkViewCompleted(),t||(this.viewCompleted=!1)}}__checkViewCompleted(t=!0){this.nextRender(()=>{this.imageReady&&(t&&this.emitLeafer(Kt.VIEW_COMPLETED),$s.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(t,e){e&&(t=t.bind(e)),this.__initWait||(this.__initWait=[]),this.canvas?t():this.__initWait.push(t)}waitReady(t,e){e&&(t=t.bind(e)),this.ready?t():this.__readyWait.push(t)}waitViewReady(t,e){e&&(t=t.bind(e)),this.viewReady?t():this.__viewReadyWait.push(t)}waitViewCompleted(t,e){e&&(t=t.bind(e)),this.__viewCompletedWait.push(t),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(t,e,n){e&&(t=t.bind(e));const o=this.__nextRenderWait;if(n){for(let a=0;a<o.length;a++)if(o[a]===t){o.splice(a,1);break}}else o.push(t)}zoom(t,e,n){return hs("view")}getValidMove(t,e){return{x:t,y:e}}getValidScale(t){return t}getWorldPointByClient(t,e){return this.interaction&&this.interaction.getLocal(t,e)}getPagePointByClient(t,e){return this.getPagePoint(this.getWorldPointByClient(t,e))}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(t){}__checkUpdateLayout(){this.__layout.update()}emitLeafer(t){this.emitEvent(new Kt(t,this))}__listenEvents(){const t=Li.start("FirstCreate "+this.innerName);this.once(Kt.START,()=>Li.end(t)),this.once(Ct.START,()=>this.updateLazyBounds()),this.once(Ct.END,()=>this.__onReady()),this.once(St.START,()=>this.__onCreated()),this.once(St.END,()=>this.__onViewReady()),this.__eventIds.push(this.on_(Nn.DATA,this.__onWatchData,this),this.on_(St.NEXT,this.__onNextRender,this),this.on_(Ct.CHECK_UPDATE,this.__checkUpdateLayout,this))}__removeListenEvents(){this.off_(this.__eventIds),this.__eventIds.length=0}destroy(t){const e=()=>{if(!this.destroyed){Ia.list.remove(this);try{this.stop(),this.emitEvent(new Kt(Kt.END,this)),this.__removeListenEvents(),this.__controllers.forEach(n=>!(this.parent&&n===this.interaction)&&n.destroy()),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager.destroy()),this.canvas.destroy(),this.config.view=this.view=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{He.clearRecycled()},100)}catch(n){Jl.error(n)}}};t?e():setTimeout(e)}};Un.list=new Pt;R([me(VT)],Un.prototype,"__",void 0);R([It()],Un.prototype,"pixelRatio",void 0);Un=Ia=R([we()],Un);let pi=class extends z{get __tag(){return"Rect"}constructor(t){super(t)}};R([me(tc)],pi.prototype,"__",void 0);pi=R([Ti(sR),Za(),we()],pi);const{copy:oR,add:aR,includes:hR}=q,br=pi.prototype,lR=de.prototype,Ql={};let he=class extends de{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(t){const e=this.__;if(this.children.length)if(e.__autoSide){super.__updateBoxBounds();const{boxBounds:n}=this.__layout;e.__autoSize||(e.__autoWidth?(n.width+=n.x,n.x=0,n.height=e.height,n.y=0):(n.height+=n.y,n.y=0,n.width=e.width,n.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds();else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t;const{renderBounds:e}=this.__layout;this.children.length?(super.__updateRenderBounds(),oR(Ql,e),this.__updateRectRenderBounds(),t=!hR(e,Ql),t&&this.__.overflow!=="hide"&&aR(e,Ql)):this.__updateRectRenderBounds(),!this.isOverflow!=!t&&(this.isOverflow=t)}__updateRectRenderBounds(){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,e){}__renderGroup(t,e){}__render(t,e){this.__.__drawAfterFill?this.__renderRect(t,e):(this.__renderRect(t,e),this.children.length&&this.__renderGroup(t,e))}__drawContent(t,e){this.__renderGroup(t,e),this.__.__hasStroke&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}};R([me(Og)],he.prototype,"__",void 0);R([Pi(!1)],he.prototype,"resizeChildren",void 0);R([Pi(!1)],he.prototype,"textBox",void 0);R([Tg("show")],he.prototype,"overflow",void 0);R([Ai(br.__updateStrokeSpread)],he.prototype,"__updateStrokeSpread",null);R([Ai(br.__updateRenderSpread)],he.prototype,"__updateRectRenderSpread",null);R([Ai(br.__updateBoxBounds)],he.prototype,"__updateRectBoxBounds",null);R([Ai(br.__updateStrokeBounds)],he.prototype,"__updateStrokeBounds",null);R([Ai(br.__updateRenderBounds)],he.prototype,"__updateRectRenderBounds",null);R([Ai(br.__updateChange)],he.prototype,"__updateRectChange",null);R([Ai(br.__render)],he.prototype,"__renderRect",null);R([Ai(lR.__render)],he.prototype,"__renderGroup",null);he=R([Za(),we()],he);let us=class extends he{get __tag(){return"Frame"}get isFrame(){return!0}constructor(t){super(t)}};R([me(YT)],us.prototype,"__",void 0);R([_o("#FFFFFF")],us.prototype,"fill",void 0);R([Tg("hide")],us.prototype,"overflow",void 0);us=R([we()],us);const{moveTo:ep,closePath:ip,ellipse:Kr}=wr;let cs=class extends z{get __tag(){return"Ellipse"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,innerRadius:n,startAngle:o,endAngle:a}=this.__,h=t/2,u=e/2,d=this.__.path=[];n?(o||a?(n<1&&Kr(d,h,u,h*n,u*n,0,o,a,!1),Kr(d,h,u,h,u,0,a,o,!0),n<1&&ip(d)):(n<1&&(Kr(d,h,u,h*n,u*n),ep(d,t,u)),Kr(d,h,u,h,u,0,360,0,!0)),V.ellipseToCurve&&(this.__.path=this.getPath(!0))):o||a?(ep(d,h,u),Kr(d,h,u,h,u,0,o,a,!1),ip(d)):Kr(d,h,u,h,u)}};R([me(ZT)],cs.prototype,"__",void 0);R([Oe(0)],cs.prototype,"innerRadius",void 0);R([Oe(0)],cs.prototype,"startAngle",void 0);R([Oe(0)],cs.prototype,"endAngle",void 0);cs=R([we()],cs);const{moveTo:uR,lineTo:cR,drawPoints:np}=wr,{rotate:dR,getAngle:fR,getDistance:_R,defaultPoint:rp}=rt,{toBounds:pR}=Ju;let Yi=class extends z{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:e}=this.__,n=Zu();return t&&(n.x=t),e&&dR(n,e),n}set toPoint(t){this.width=_R(rp,t),this.rotation=fR(rp,t),this.height&&(this.height=0)}constructor(t){super(t)}__updatePath(){const t=this.__,e=t.path=[];t.points?np(e,t.points,!1,t.closed):(uR(e,0,0),cR(e,this.width,0))}__updateRenderPath(){const t=this.__;!this.pathInputed&&t.points&&t.curve?(np(t.__pathForRender=[],t.points,t.curve,t.closed),t.__useArrow&&Bg.addArrows(this,!1)):super.__updateRenderPath()}__updateBoxBounds(){this.points?pR(this.__.__pathForRender,this.__layout.boxBounds):super.__updateBoxBounds()}};R([me(XT)],Yi.prototype,"__",void 0);R([Xa("center")],Yi.prototype,"strokeAlign",void 0);R([It(0)],Yi.prototype,"height",void 0);R([Oe()],Yi.prototype,"points",void 0);R([Oe(0)],Yi.prototype,"curve",void 0);R([Oe(!1)],Yi.prototype,"closed",void 0);Yi=R([we()],Yi);const{sin:gR,cos:yR,PI:sp}=Math,{moveTo:vR,lineTo:mR,closePath:wR,drawPoints:xR}=wr,Pg=Yi.prototype;let vn=class extends z{get __tag(){return"Polygon"}constructor(t){super(t)}__updatePath(){const t=this.__.path=[];if(this.__.points)xR(t,this.__.points,!1,!0);else{const{width:e,height:n,sides:o}=this.__,a=e/2,h=n/2;vR(t,a,0);for(let u=1;u<o;u++)mR(t,a+a*gR(u*2*sp/o),h-h*yR(u*2*sp/o))}wR(t)}__updateRenderPath(){}__updateBoxBounds(){}};R([me(KT)],vn.prototype,"__",void 0);R([Oe(3)],vn.prototype,"sides",void 0);R([Oe()],vn.prototype,"points",void 0);R([Oe(0)],vn.prototype,"curve",void 0);R([Ai(Pg.__updateRenderPath)],vn.prototype,"__updateRenderPath",null);R([Ai(Pg.__updateBoxBounds)],vn.prototype,"__updateBoxBounds",null);vn=R([Za(),we()],vn);const{sin:bR,cos:ER,PI:op}=Math,{moveTo:CR,lineTo:SR,closePath:TR}=wr;let so=class extends z{get __tag(){return"Star"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,corners:n,innerRadius:o}=this.__,a=t/2,h=e/2,u=this.__.path=[];CR(u,a,0);for(let d=1;d<n*2;d++)SR(u,a+(d%2===0?a:a*o)*bR(d*op/n),h-(d%2===0?h:h*o)*ER(d*op/n));TR(u)}};R([me(jT)],so.prototype,"__",void 0);R([Oe(5)],so.prototype,"corners",void 0);R([Oe(.382)],so.prototype,"innerRadius",void 0);so=R([we()],so);let oo=class extends pi{get __tag(){return"Image"}get ready(){return this.image?this.image.ready:!1}constructor(t){super(t),this.on(Vi.LOADED,e=>{e.attrName==="fill"&&e.attrValue.url===this.url&&(this.image=e.image)})}destroy(){this.image=null,super.destroy()}};R([me(eR)],oo.prototype,"__",void 0);R([It("")],oo.prototype,"url",void 0);oo=R([we()],oo);let Gn=class extends pi{get __tag(){return"Canvas"}get ready(){return!this.url}constructor(t){super(t),this.canvas=qt.canvas(this.__),this.context=this.canvas.context,t&&t.url&&this.drawImage(t.url)}drawImage(t){new bg({url:t}).load(e=>{this.context.drawImage(e.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new Vi(Vi.LOADED,{image:e}))})}draw(t,e,n,o){const a=new ze(t.worldTransform).invert(),h=new ze;e&&h.translate(e.x,e.y),n&&(typeof n=="number"?h.scale(n):h.scale(n.x,n.y)),o&&h.rotate(o),a.multiplyParent(h),t.__render(this.canvas,{matrix:a.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(t,e){const{width:n,height:o}=this.__,{view:a}=this.canvas;t.drawImage(a,0,0,a.width,a.height,0,0,n,o)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:e}=this.__;t.smooth!==e&&(t.smooth=e),t.resize(this.__)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=this.context=null),super.destroy()}};R([me(iR)],Gn.prototype,"__",void 0);R([yo(100)],Gn.prototype,"width",void 0);R([yo(100)],Gn.prototype,"height",void 0);R([yo(1)],Gn.prototype,"pixelRatio",void 0);R([yo(!0)],Gn.prototype,"smooth",void 0);R([yo()],Gn.prototype,"contextSettings",void 0);Gn=R([we()],Gn);const{copyAndSpread:RR,includes:LR,isSame:kR,spread:BR,setList:OR}=q;let Bt=class extends z{get __tag(){return"Text"}get textDrawData(){return this.__layout.update(),this.__.__textDrawData}constructor(t){super(t)}__drawHitPath(t){const{__lineHeight:e,fontSize:n,__baseLine:o,__textDrawData:a}=this.__;t.beginPath(),this.__.__letterSpacing<0?this.__drawPathByData(t):a.rows.forEach(h=>t.rect(h.x,h.y-o,h.width,e<n?n:e))}__drawPathByData(t,e){const{x:n,y:o,width:a,height:h}=this.__layout.boxBounds;t.rect(n,o,a,h)}__drawRenderPath(t){t.font=this.__.__font}__updateTextDrawData(){const t=this.__,{lineHeight:e,letterSpacing:n,fontFamily:o,fontSize:a,fontWeight:h,italic:u,textCase:d,textOverflow:f,padding:y}=t;t.__lineHeight=j_.number(e,a),t.__letterSpacing=j_.number(n,a),t.__padding=y?fe.fourNumber(y):void 0,t.__baseLine=t.__lineHeight-(t.__lineHeight-a*.7)/2,t.__font=`${u?"italic ":""}${d==="small-caps"?"small-caps ":""}${h!=="normal"?h+" ":""}${a}px ${o}`,t.__clipText=f!=="show"&&!t.__autoSize,t.__textDrawData=kg.getDrawData(t.text,this.__)}__updateBoxBounds(){const t=this.__,e=this.__layout,{fontSize:n,italic:o,padding:a,__autoWidth:h,__autoHeight:u}=t;this.__updateTextDrawData();const{bounds:d}=t.__textDrawData,f=e.boxBounds;if(t.__lineHeight<n&&BR(d,n/2),h||u){if(f.x=h?d.x:0,f.y=u?d.y:0,f.width=h?d.width:t.width,f.height=u?d.height:t.height,a){const[x,E,m,S]=t.__padding;h&&(f.x-=S,f.width+=E+S),u&&(f.y-=x,f.height+=m+x)}this.__updateNaturalSize()}else super.__updateBoxBounds();o&&(f.width+=n*.16);const y=LR(f,d)?f:d;kR(y,e.contentBounds)?t.__textBoxBounds=y:(e.contentBounds=y,e.renderChanged=!0,OR(t.__textBoxBounds={},[f,d]))}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.__layout.boxBounds===this.__layout.contentBounds?0:1),t}__updateRenderBounds(){RR(this.__layout.renderBounds,this.__.__textBoxBounds,this.__layout.renderSpread)}};R([me(tR)],Bt.prototype,"__",void 0);R([It(0)],Bt.prototype,"width",void 0);R([It(0)],Bt.prototype,"height",void 0);R([Pi(!1)],Bt.prototype,"resizeFontSize",void 0);R([_o("#000000")],Bt.prototype,"fill",void 0);R([Xa("outside")],Bt.prototype,"strokeAlign",void 0);R([xr("all")],Bt.prototype,"hitFill",void 0);R([It("")],Bt.prototype,"text",void 0);R([It("L")],Bt.prototype,"fontFamily",void 0);R([It(12)],Bt.prototype,"fontSize",void 0);R([It("normal")],Bt.prototype,"fontWeight",void 0);R([It(!1)],Bt.prototype,"italic",void 0);R([It("none")],Bt.prototype,"textCase",void 0);R([It("none")],Bt.prototype,"textDecoration",void 0);R([It(0)],Bt.prototype,"letterSpacing",void 0);R([It({type:"percent",value:1.5})],Bt.prototype,"lineHeight",void 0);R([It(0)],Bt.prototype,"paraIndent",void 0);R([It(0)],Bt.prototype,"paraSpacing",void 0);R([It("left")],Bt.prototype,"textAlign",void 0);R([It("top")],Bt.prototype,"verticalAlign",void 0);R([It(!0)],Bt.prototype,"autoSizeAlign",void 0);R([It("normal")],Bt.prototype,"textWrap",void 0);R([It("show")],Bt.prototype,"textOverflow",void 0);Bt=R([we()],Bt);let ds=class extends z{get __tag(){return"Path"}constructor(t){super(t)}};R([me(qT)],ds.prototype,"__",void 0);R([Xa("center")],ds.prototype,"strokeAlign",void 0);ds=R([we()],ds);let Na=class extends de{get __tag(){return"Pen"}constructor(t){super(t)}setStyle(t){const e=this.pathElement=new ds(t);return this.pathStyle=t,this.__path=e.path||(e.path=[]),this.add(e),this}beginPath(){return this}moveTo(t,e){return this}lineTo(t,e){return this}bezierCurveTo(t,e,n,o,a,h){return this}quadraticCurveTo(t,e,n,o){return this}closePath(){return this}rect(t,e,n,o){return this}roundRect(t,e,n,o,a){return this}ellipse(t,e,n,o,a,h,u,d){return this}arc(t,e,n,o,a,h){return this}arcTo(t,e,n,o,a){return this}drawEllipse(t,e,n,o,a,h,u,d){return this}drawArc(t,e,n,o,a,h){return this}drawPoints(t,e,n){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate("path")}};R([me(JT)],Na.prototype,"__",void 0);R([PR()],Na.prototype,"path",void 0);Na=R([Ti(qu,["set","path","paint"]),we()],Na);function PR(){return(i,t)=>{qe(i,t,{get(){return this.__path}})}}function wn(i,t,e,n){var o=arguments.length,a=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(h=i[u])&&(a=(o<3?h(a):o>3?h(t,e,a):h(t,e))||a);return o>3&&a&&Object.defineProperty(t,e,a),a}let Mu=class extends Un{get __tag(){return"App"}get isApp(){return!0}constructor(t,e){super(t,e)}init(t,e){if(super.init(t,e),t){const{ground:n,tree:o,sky:a,editor:h}=t;n&&(this.ground=this.addLeafer(n)),(o||h)&&(this.tree=this.addLeafer(o)),(a||h)&&(this.sky=this.addLeafer(a||{type:"draw",usePartRender:!1})),h&&this.sky.add(this.editor=qt.editor(h))}}__setApp(){const{canvas:t}=this,{realCanvas:e,view:n}=this.config;e||n===this.canvas.view||!t.parentView?this.realCanvas=!0:t.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable(),this.__eventIds.push(this.on_(Gi.CHANGE,this.__onPropertyChange,this))}start(){super.start(),this.children.forEach(t=>t.start())}stop(){this.children.forEach(t=>t.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.children.forEach(t=>t.unlockLayout())}lockLayout(){super.lockLayout(),this.children.forEach(t=>t.lockLayout())}forceRender(t){this.children.forEach(e=>e.forceRender(t))}addLeafer(t){const e=new Un(t);return this.add(e),e}add(t,e){if(!t.view){if(this.realCanvas&&!this.canvas.bounds){setTimeout(()=>this.add(t,e),10);return}t.init(this.__getChildConfig(t.userConfig),this)}super.add(t,e),e!==void 0&&(t.canvas.childIndex=e),this.__listenChildEvents(t)}__onPropertyChange(){Tt.showHitView&&this.children.forEach(t=>t.forceUpdate("surface"))}__onCreated(){this.created=this.children.every(t=>t.created)}__onReady(){this.children.every(t=>t.ready)&&super.__onReady()}__onViewReady(){this.children.every(t=>t.viewReady)&&super.__onViewReady()}__onChildRenderEnd(t){this.renderer.addBlock(t.renderBounds),this.viewReady&&this.renderer.update()}__render(t,e){if(t.context){const n=e.matrix;n&&t.setTransform(n.a,n.b,n.c,n.d,n.e,n.f),this.children.forEach(o=>t.copyWorld(o.canvas))}}__onResize(t){this.children.forEach(e=>e.resize(t)),super.__onResize(t)}__checkUpdateLayout(){this.children.forEach(t=>t.__layout.update())}__getChildConfig(t){let e=Object.assign({},this.config);return e.hittable=e.realCanvas=void 0,t&&ie.assign(e,t),this.autoLayout&&ie.copyAttrs(e,this,Ni),e.view=this.realCanvas?void 0:this.view,e.fill=void 0,e}__listenChildEvents(t){t.once(Ct.END,()=>this.__onReady()),t.once(St.START,()=>this.__onCreated()),t.once(St.END,()=>this.__onViewReady()),this.realCanvas&&this.__eventIds.push(t.on_(St.END,this.__onChildRenderEnd,this))}};Mu=wn([we()],Mu);const Sa={},io={isHoldSpaceKey(){return io.isHold("Space")},isHold(i){return Sa[i]},setDownCode(i){Sa[i]||(Sa[i]=!0)},setUpCode(i){Sa[i]=!1}},Ci={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(i){i.buttons||(i.buttons=1)},left(i){return i.buttons===1},right(i){return i.buttons===2},middle(i){return i.buttons===4}};class qa extends Zi{get spaceKey(){return io.isHoldSpaceKey()}get left(){return Ci.left(this)}get right(){return Ci.right(this)}get middle(){return Ci.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}getBoxPoint(t){return t||(t=this.current),t.getBoxPoint(this)}getInnerPoint(t){return t||(t=this.current),t.getInnerPoint(this)}getLocalPoint(t){return t||(t=this.current),t.getLocalPoint(this)}getPagePoint(){return this.current.getPagePoint(this)}getInner(t){return this.getInnerPoint(t)}getLocal(t){return this.getLocalPoint(t)}getPage(){return this.getPagePoint()}static changeName(t,e){ls.changeName(t,e)}}let j=class extends qa{};j.POINTER="pointer";j.BEFORE_DOWN="pointer.before_down";j.BEFORE_MOVE="pointer.before_move";j.BEFORE_UP="pointer.before_up";j.DOWN="pointer.down";j.MOVE="pointer.move";j.UP="pointer.up";j.OVER="pointer.over";j.OUT="pointer.out";j.ENTER="pointer.enter";j.LEAVE="pointer.leave";j.TAP="tap";j.DOUBLE_TAP="double_tap";j.CLICK="click";j.DOUBLE_CLICK="double_click";j.LONG_PRESS="long_press";j.LONG_TAP="long_tap";j.MENU="pointer.menu";j.MENU_TAP="pointer.menu_tap";j=wn([Vn()],j);const zs={};let ut=class extends j{static setList(t){this.list=t instanceof Pt?t:new Pt(t)}static setData(t){this.data=t}static getValidMove(t,e,n){const{draggable:o,dragBounds:a,x:h,y:u}=t,d=t.getLocalPoint(n,null,!0);return d.x+=e.x-h,d.y+=e.y-u,a&&this.getMoveInDragBounds(t.__local,a==="parent"?t.parent.boxBounds:a,d,!0),o==="x"&&(d.y=0),o==="y"&&(d.x=0),d}static getMoveInDragBounds(t,e,n,o){const a=t.x+n.x,h=t.y+n.y,u=a+t.width,d=h+t.height,f=e.x+e.width,y=e.y+e.height;return o||(n=Object.assign({},n)),q.includes(t,e)?(a>e.x?n.x+=e.x-a:u<f&&(n.x+=f-u),h>e.y?n.y+=e.y-h:d<y&&(n.y+=y-d)):(a<e.x?n.x+=e.x-a:u>f&&(n.x+=f-u),h<e.y?n.y+=e.y-h:d>y&&(n.y+=y-d)),n}getPageMove(t){return this.assignMove(t),this.current.getPagePoint(zs,null,!0)}getInnerMove(t,e){return t||(t=this.current),this.assignMove(e),t.getInnerPoint(zs,null,!0)}getLocalMove(t,e){return t||(t=this.current),this.assignMove(e),t.getLocalPoint(zs,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(t){return this.getInnerMove(t,!0)}getLocalTotal(t){return this.getLocalMove(t,!0)}getPageBounds(){const t=this.getPageTotal(),e=this.getPagePoint(),n={};return q.set(n,e.x-t.x,e.y-t.y,t.x,t.y),q.unsign(n),n}assignMove(t){zs.x=t?this.totalX:this.moveX,zs.y=t?this.totalY:this.moveY}};ut.BEFORE_DRAG="drag.before_drag";ut.START="drag.start";ut.DRAG="drag";ut.END="drag.end";ut.OVER="drag.over";ut.OUT="drag.out";ut.ENTER="drag.enter";ut.LEAVE="drag.leave";ut=wn([Vn()],ut);let ao=class extends j{static setList(t){ut.setList(t)}static setData(t){ut.setData(t)}};ao.DROP="drop";ao=wn([Vn()],ao);let ae=class extends ut{};ae.BEFORE_MOVE="move.before_move";ae.START="move.start";ae.MOVE="move";ae.END="move.end";ae=wn([Vn()],ae);let fi=class extends qa{};fi.BEFORE_ROTATE="rotate.before_rotate";fi.START="rotate.start";fi.ROTATE="rotate";fi.END="rotate.end";fi=wn([Vn()],fi);let ki=class extends ut{};ki.SWIPE="swipe";ki.LEFT="swipe.left";ki.RIGHT="swipe.right";ki.UP="swipe.up";ki.DOWN="swipe.down";ki=wn([Vn()],ki);let $e=class extends qa{};$e.BEFORE_ZOOM="zoom.before_zoom";$e.START="zoom.start";$e.ZOOM="zoom";$e.END="zoom.end";$e=wn([Vn()],$e);let Bi=class extends qa{};Bi.DOWN="key.down";Bi.HOLD="key.hold";Bi.UP="key.up";Bi=wn([Vn()],Bi);function Ag(i){i.isApp||i.__eventIds.push(i.on_(ae.BEFORE_MOVE,t=>{i.zoomLayer.move(i.getValidMove(t.moveX,t.moveY))}),i.on_($e.BEFORE_ZOOM,t=>{const{zoomLayer:e}=i,n=i.getValidScale(t.scale);n!==1&&(rt.scaleOf(e,t,n),e.scale=e.__.scaleX*n)}))}function AR(i){Ag(i);const{move:t,zoom:e}=i.config;t.scroll="limit",e.min=1}function MR(i){const{config:t}=i;(t.wheel||(t.wheel={})).preventDefault=!1,(t.touch||(t.touch={})).preventDefault="auto"}const IR=Tt.get("LeaferTypeCreator"),Mg={list:{},register(i,t){tu[i]?IR.repeat(i):tu[i]=t},run(i,t){const e=tu[i];e&&e(t)}},{list:tu,register:ec}=Mg;ec("design",Ag);ec("document",AR);ec("block",MR);const ic=Un.prototype;ic.initType=function(i){Mg.run(i,this)};ic.getValidMove=function(i,t){const{scroll:e,disabled:n}=this.app.config.move;if(e&&(Math.abs(i)>Math.abs(t)?t=0:i=0,e==="limit")){const{x:o,y:a,width:h,height:u}=new zt(this.__world).addPoint(this.zoomLayer),d=o+h-this.width,f=a+u-this.height;o>=0&&d<=0?i=0:i>0?o+i>0&&(i=-o):i<0&&d+i<0&&(i=-d),a>=0&&f<=0?t=0:t>0?a+t>0&&(t=-a):t<0&&f+t<0&&(t=-f)}return{x:n?0:i,y:n?0:t}};ic.getValidScale=function(i){const{scaleX:t}=this.zoomLayer.__,{min:e,max:n,disabled:o}=this.app.config.zoom,a=Math.abs(t*i);return a<e?i=e/t:a>n&&(i=n/t),o?1:i};class DR{get transforming(){return!!(this.moveData||this.zoomData||this.rotateData)}constructor(t){this.interaction=t}move(t){const{interaction:e}=this;if(t.moveType||(t.moveType="move"),!this.moveData){const{path:n}=e.selector.getByPoint(t,e.hitRadius);t.path=n,this.moveData=Object.assign(Object.assign({},t),{moveX:0,moveY:0}),e.cancelHover(),e.emit(ae.START,this.moveData)}t.path=this.moveData.path,e.emit(ae.BEFORE_MOVE,t),e.emit(ae.MOVE,t),this.transformEndWait()}zoom(t){const{interaction:e}=this;if(!this.zoomData){const{path:n}=e.selector.getByPoint(t,e.hitRadius);t.path=n,this.zoomData=Object.assign(Object.assign({},t),{scale:1}),e.cancelHover(),e.emit($e.START,this.zoomData)}t.path=this.zoomData.path,e.emit($e.BEFORE_ZOOM,t),e.emit($e.ZOOM,t),this.transformEndWait()}rotate(t){const{interaction:e}=this;if(!this.rotateData){const{path:n}=e.selector.getByPoint(t,e.hitRadius);t.path=n,this.rotateData=Object.assign(Object.assign({},t),{rotation:0}),e.cancelHover(),e.emit(fi.START,this.rotateData)}t.path=this.rotateData.path,e.emit(fi.BEFORE_ROTATE,t),e.emit(fi.ROTATE,t),this.transformEndWait()}transformEndWait(){clearTimeout(this.transformTimer),this.transformTimer=setTimeout(()=>{this.transformEnd()},this.interaction.config.pointer.transformTime)}transformEnd(){this.moveEnd(),this.zoomEnd(),this.rotateEnd()}moveEnd(){this.moveData&&(this.interaction.emit(ae.END,this.moveData),this.moveData=null)}zoomEnd(){this.zoomData&&(this.interaction.emit($e.END,this.zoomData),this.zoomData=null)}rotateEnd(){this.rotateData&&(this.interaction.emit(fi.END,this.rotateData),this.rotateData=null)}destroy(){this.zoomData=this.moveData=this.rotateData=null}}const Oi={getMoveEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,moveX:t.x,moveY:t.y})},getRotateEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,rotation:t})},getZoomEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,scale:t})},getDragEventData(i,t,e){return Object.assign(Object.assign({},e),{x:e.x,y:e.y,moveX:e.x-t.x,moveY:e.y-t.y,totalX:e.x-i.x,totalY:e.y-i.y})},getDropEventData(i,t,e){return Object.assign(Object.assign({},i),{list:t,data:e})},getSwipeDirection(i){return i<-45&&i>-135?ki.UP:i>45&&i<135?ki.DOWN:i<=45&&i>=-45?ki.RIGHT:ki.LEFT},getSwipeEventData(i,t,e){return Object.assign(Object.assign({},e),{moveX:t.moveX,moveY:t.moveY,totalX:e.x-i.x,totalY:e.y-i.y,type:WR.getSwipeDirection(rt.getAngle(i,e))})},getBase(i){const t=i.button===1?4:i.button;return{altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey,buttons:i.buttons===void 0?1:i.buttons===0?t:i.buttons,origin:i}},pathHasEventType(i,t){const{list:e}=i;for(let n=0,o=e.length;n<o;n++)if(e[n].hasEvent(t))return!0;return!1},filterPathByEventType(i,t){const e=new Pt,{list:n}=i;for(let o=0,a=n.length;o<a;o++)n[o].hasEvent(t)&&e.add(n[o]);return e},pathCanDrag(i){return i&&i.list.some(t=>t.draggable||t.editable||!t.isLeafer&&t.hasEvent(ut.DRAG))},pathHasOutside(i){return i&&i.list.some(t=>t.isOutside)}},WR=Oi,ap=new Pt,{getDragEventData:eu,getDropEventData:FR,getSwipeEventData:$R}=Oi;class zR{constructor(t){this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=eu(t,t,t),this.canAnimate=this.canDragOut=!0}getList(t,e){const{proxy:n}=this.interaction.selector,o=n&&n.list.length,a=ut.list||this.draggableList||ap;return this.dragging&&(o?t?ap:new Pt(e?[...n.list,...n.dragHoverExclude]:n.list):a)}checkDrag(t,e){const{interaction:n}=this;if(this.moving&&t.buttons<1){this.canAnimate=!1,n.pointerCancel();return}!this.moving&&e&&(this.moving=n.canMove(this.downData)||n.isHoldRightKey||n.isMobileDragEmpty)&&(this.dragData.moveType="drag",n.emit(ae.START,this.dragData)),this.moving||this.dragStart(t,e),this.drag(t)}dragStart(t,e){this.dragging||(this.dragging=e&&Ci.left(t),this.dragging&&(this.interaction.emit(ut.START,this.dragData),this.getDraggableList(this.dragData.path),this.setDragStartPoints(this.realDraggableList=this.getList(!0))))}setDragStartPoints(t){this.dragStartPoints={},t.forEach(e=>this.dragStartPoints[e.innerId]={x:e.x,y:e.y})}getDraggableList(t){let e;for(let n=0,o=t.length;n<o;n++)if(e=t.list[n],(e.draggable||e.editable)&&e.hitSelf&&!e.locked){this.draggableList=new Pt(e);break}}drag(t){const{interaction:e,dragData:n,downData:o}=this,{path:a,throughPath:h}=o;this.dragData=eu(o,n,t),h&&(this.dragData.throughPath=h),this.dragData.path=a,this.moving?(this.dragData.moveType="drag",e.emit(ae.BEFORE_MOVE,this.dragData),e.emit(ae.MOVE,this.dragData)):this.dragging&&(this.dragReal(),e.emit(ut.BEFORE_DRAG,this.dragData),e.emit(ut.DRAG,this.dragData))}dragReal(){const{running:t}=this.interaction,e=this.realDraggableList;if(e.length&&t){const{totalX:n,totalY:o}=this.dragData;e.forEach(a=>a.draggable&&a.move(ut.getValidMove(a,this.dragStartPoints[a.innerId],{x:n,y:o})))}}dragOverOrOut(t){const{interaction:e}=this,{dragOverPath:n}=this,{path:o}=t;this.dragOverPath=o,n?o.indexAt(0)!==n.indexAt(0)&&(e.emit(ut.OUT,t,n),e.emit(ut.OVER,t,o)):e.emit(ut.OVER,t,o)}dragEnterOrLeave(t){const{interaction:e}=this,{dragEnterPath:n}=this,{path:o}=t;e.emit(ut.LEAVE,t,n,o),e.emit(ut.ENTER,t,o,n),this.dragEnterPath=o}dragEnd(t,e){if(!this.dragging&&!this.moving)return;const{moveX:n,moveY:o}=this.dragData;this.interaction.config.move.dragAnimate&&this.canAnimate&&this.moving&&(Math.abs(n)>1||Math.abs(o)>1)?(t=Object.assign({},t),e=(e||(t.pointerType==="touch"?2:1))*.9,rt.move(t,n*e,o*e),this.drag(t),this.animate(()=>{this.dragEnd(t,1)})):this.dragEndReal(t)}dragEndReal(t){const{interaction:e,downData:n,dragData:o}=this;t||(t=o);const{path:a,throughPath:h}=n,u=eu(n,t,t);if(h&&(u.throughPath=h),u.path=a,this.moving&&(this.moving=!1,u.moveType="drag",e.emit(ae.END,u)),this.dragging){const d=this.getList();this.dragging=!1,e.emit(ut.END,u),this.swipe(t,n,o,u),this.drop(t,d,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}animate(t,e){const n=t||this.animateWait;n&&this.interaction.target.nextRender(n,null,e),this.animateWait=t}swipe(t,e,n,o){const{interaction:a}=this;if(rt.getDistance(e,t)>a.config.pointer.swipeDistance){const h=$R(e,n,o);this.interaction.emit(h.type,h)}}drop(t,e,n){const o=FR(t,e,ut.data);o.path=n,this.interaction.emit(ao.DROP,o),this.interaction.emit(ut.LEAVE,t,n)}dragReset(){ut.list=ut.data=this.draggableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null}checkDragOut(t){const{interaction:e}=this;this.autoMoveCancel(),this.dragging&&!e.shrinkCanvasBounds.hitPoint(t)&&this.autoMoveOnDragOut(t)}autoMoveOnDragOut(t){const{interaction:e,downData:n,canDragOut:o}=this,{autoDistance:a,dragOut:h}=e.config.move;if(!h||!o||!a)return;const u=e.shrinkCanvasBounds,{x:d,y:f}=u,y=q.maxX(u),x=q.maxY(u),E=t.x<d?a:y<t.x?-a:0,m=t.y<f?a:x<t.y?-a:0;let S=0,B=0;this.autoMoveTimer=setInterval(()=>{S+=E,B+=m,rt.move(n,E,m),rt.move(this.dragData,E,m),e.move(Object.assign(Object.assign({},t),{moveX:E,moveY:m,totalX:S,totalY:B,moveType:"drag"})),e.pointerMoveReal(t)},10)}autoMoveCancel(){this.autoMoveTimer&&(clearInterval(this.autoMoveTimer),this.autoMoveTimer=0)}destroy(){this.dragReset()}}const HR=Tt.get("emit");function NR(i,t,e,n){if(!e&&!t.path)return;let o;t.type=i,e?t=Object.assign(Object.assign({},t),{path:e}):e=t.path,t.target=e.indexAt(0);try{for(let a=e.length-1;a>-1;a--){if(o=e.list[a],Iu(o,i,t,!0,n))return;o.isApp&&hp(o,i,t,!0,n)}for(let a=0,h=e.length;a<h;a++)if(o=e.list[a],o.isApp&&hp(o,i,t,!1,n),Iu(o,i,t,!1,n))return}catch(a){HR.error(a)}}const UR=["move","zoom","rotate","key"];function hp(i,t,e,n,o){if(UR.some(a=>t.startsWith(a))&&i.__.hitChildren&&!Ig(i,o)){let a;for(let h=0,u=i.children.length;h<u;h++)a=i.children[h],!e.path.has(a)&&a.__.hittable&&Iu(a,t,e,n,o)}}function Iu(i,t,e,n,o){if(i.destroyed)return!1;if(i.__.hitSelf&&!Ig(i,o)&&(q_.updateEventStyle&&!n&&q_.updateEventStyle(i,t),i.hasEvent(t,n))){e.phase=n?1:i===e.target?2:3;const a=ls.get(t,e);if(i.emitEvent(a,n),a.isStop)return!0}return!1}function Ig(i,t){return t&&t.has(i)}const GR={getData(i){const t=i[0],e=i[1],n=rt.getCenter(t.from,e.from),o=rt.getCenter(t.to,e.to),a={x:o.x-n.x,y:o.y-n.y},h=rt.getDistance(t.from,e.from),d=rt.getDistance(t.to,e.to)/h,f=rt.getRotation(t.from,e.from,t.to,e.to);return{move:a,scale:d,angle:f,center:o}}},VR={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:80/4,y:8},preventDefault:!0},pointer:{hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20,preventDefaultMenu:!0},touch:{preventDefault:!0},multiTouch:{},cursor:!0,keyEvent:!0},{pathHasEventType:iu,getMoveEventData:YR,getZoomEventData:XR,getRotateEventData:ZR,pathCanDrag:KR,pathHasOutside:lp}=Oi;class jR{get dragging(){return this.dragger.dragging}get transforming(){return this.transformer.transforming}get moveMode(){return this.m.drag===!0||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get canHover(){return this.p.hover&&!this.config.mobile}get isDragEmpty(){return this.m.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.m.dragEmpty&&!this.canHover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.m.holdMiddleKey&&this.downData&&Ci.middle(this.downData)}get isHoldRightKey(){return this.m.holdRightKey&&this.downData&&Ci.right(this.downData)}get isHoldSpaceKey(){return this.m.holdSpaceKey&&io.isHoldSpaceKey()}get m(){return this.config.move}get p(){return this.config.pointer}get hitRadius(){return this.p.hitRadius}constructor(t,e,n,o){this.config=ie.clone(VR),this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=e,this.selector=n,this.defaultPath=new Pt(t),this.transformer=new DR(this),this.dragger=new zR(this),o&&(this.config=ie.default(o,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(t,e){t||(t=this.hoverData),t&&(Ci.defaultLeft(t),this.updateDownData(t),this.checkPath(t,e),this.downTime=Date.now(),this.emit(j.BEFORE_DOWN,t),this.emit(j.DOWN,t),Ci.left(t)&&(this.tapWait(),this.longPressWait(t)),this.waitRightTap=Ci.right(t),this.dragger.setDragData(t),this.isHoldRightKey||this.updateCursor(t))}pointerMove(t){if(t||(t=this.hoverData),!t)return;const{downData:e}=this;e&&Ci.defaultLeft(t),(this.canvas.bounds.hitPoint(t)||e)&&(this.pointerMoveReal(t),e&&this.dragger.checkDragOut(t))}pointerMoveReal(t){const{dragHover:e,dragDistance:n}=this.p;if(this.emit(j.BEFORE_MOVE,t,this.defaultPath),this.downData){const o=rt.getDistance(this.downData,t)>n;o&&(this.waitTap&&this.pointerWaitCancel(),this.waitRightTap=!1),this.dragger.checkDrag(t,o)}this.dragger.moving||(this.updateHoverData(t),this.checkPath(t),this.emit(j.MOVE,t),this.dragging&&!e||this.pointerHover(t),this.dragger.dragging&&(this.dragger.dragOverOrOut(t),this.dragger.dragEnterOrLeave(t))),this.updateCursor(this.downData||t)}pointerUp(t){const{downData:e}=this;if(t||(t=e),!e)return;Ci.defaultLeft(t),t.multiTouch=e.multiTouch,this.findPath(t);const n=Object.assign(Object.assign({},t),{path:t.path.clone()});t.path.addList(e.path.list),this.checkPath(t),this.downData=null,this.emit(j.BEFORE_UP,t),this.emit(j.UP,t),this.touchLeave(t),t.isCancel||(this.tap(t),this.menuTap(t)),this.dragger.dragEnd(t),this.updateCursor(n)}pointerCancel(){const t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}multiTouch(t,e){if(this.config.multiTouch.disabled)return;const{move:n,angle:o,scale:a,center:h}=GR.getData(e);this.rotate(ZR(h,o,t)),this.zoom(XR(h,a,t)),this.move(YR(h,n,t))}menu(t){this.findPath(t),this.emit(j.MENU,t),this.waitMenuTap=!0,!this.downData&&this.waitRightTap&&this.menuTap(t)}menuTap(t){this.waitRightTap&&this.waitMenuTap&&(this.emit(j.MENU_TAP,t),this.waitRightTap=this.waitMenuTap=!1)}move(t){this.transformer.move(t)}zoom(t){this.transformer.zoom(t)}rotate(t){this.transformer.rotate(t)}transformEnd(){this.transformer.transformEnd()}keyDown(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]||(this.downKeyMap[e]=!0,io.setDownCode(e),this.emit(Bi.HOLD,t,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(Bi.DOWN,t,this.defaultPath)}keyUp(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]=!1,io.setUpCode(e),this.emit(Bi.UP,t,this.defaultPath),this.cursor==="grab"&&this.updateCursor()}pointerHover(t){this.canHover&&(this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(t){const{path:e}=t,{overPath:n}=this;this.overPath=e,n?e.indexAt(0)!==n.indexAt(0)&&(this.emit(j.OUT,t,n),this.emit(j.OVER,t,e)):this.emit(j.OVER,t,e)}pointerEnterOrLeave(t){let{path:e}=t;this.downData&&!this.moveMode&&(e=e.clone(),this.downData.path.forEach(o=>e.add(o)));const{enterPath:n}=this;this.enterPath=e,this.emit(j.LEAVE,t,n,e),this.emit(j.ENTER,t,e,n)}touchLeave(t){t.pointerType==="touch"&&this.enterPath&&(this.emit(j.LEAVE,t),this.dragger.dragging&&this.emit(ao.LEAVE,t))}tap(t){const{pointer:e}=this.config,n=this.longTap(t);if(!e.tapMore&&n||!this.waitTap)return;e.tapMore&&this.emitTap(t);const o=Date.now()-this.downTime,a=[j.DOUBLE_TAP,j.DOUBLE_CLICK].some(h=>iu(t.path,h));o<e.tapTime+50&&a?(this.tapCount++,this.tapCount===2?(this.tapWaitCancel(),this.emitDoubleTap(t)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{e.tapMore||(this.tapWaitCancel(),this.emitTap(t))},e.tapTime))):e.tapMore||(this.tapWaitCancel(),this.emitTap(t))}findPath(t,e){const{hitRadius:n,through:o}=this.p,{bottomList:a}=this,h=this.selector.getByPoint(t,n,Object.assign({bottomList:a,name:t.type},e||{through:o}));return h.throughPath&&(t.throughPath=h.throughPath),t.path=h.path,h.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){const e=this.target.app;return!e||!e.isApp?!1:e.editor&&!t.path.has(e.editor)&&t.path.has(e.tree)&&!t.target.syncEventer}checkPath(t,e){(e||this.moveMode&&!lp(t.path))&&(t.path=this.defaultPath)}canMove(t){return t&&(this.moveMode||this.m.drag==="auto"&&!KR(t.path))&&!lp(t.path)}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){const{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}updateDownData(t,e,n){const{downData:o}=this;!t&&o&&(t=o),t&&(this.findPath(t,e),n&&o&&t.path.addList(o.path.list),this.downData=t)}updateHoverData(t){t||(t=this.hoverData),t&&(this.findPath(t,{exclude:this.dragger.getList(!1,!0),name:j.MOVE}),this.hoverData=t)}updateCursor(t){if(!this.config.cursor||!this.canHover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let e,n;const{path:o}=t;for(let a=0,h=o.length;a<h&&(e=o.list[a],n=e.syncEventer&&e.syncEventer.cursor||e.cursor,!n);a++);this.setCursor(n)}setCursor(t){this.cursor=t}getLocal(t,e){const n=this.canvas.getClientBounds(e);return{x:t.clientX-n.x,y:t.clientY-n.y}}emitTap(t){this.emit(j.TAP,t),this.emit(j.CLICK,t)}emitDoubleTap(t){this.emit(j.DOUBLE_TAP,t),this.emit(j.DOUBLE_CLICK,t)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0}longPressWait(t){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(j.LONG_PRESS,t)},this.p.longPressTime)}longTap(t){let e;return this.longPressed&&(this.emit(j.LONG_TAP,t),(iu(t.path,j.LONG_TAP)||iu(t.path,j.LONG_PRESS))&&(e=!0)),this.longPressWaitCancel(),e}longPressWaitCancel(){clearTimeout(this.longPressTimer),this.longPressed=!1}__onResize(){this.shrinkCanvasBounds=new zt(this.canvas.bounds),this.shrinkCanvasBounds.spread(-2)}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(yn.RESIZE,this.__onResize,this)],t.once(Kt.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,e,n,o){this.running&&NR(t,e,n,o)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}}class Dg{static set(t,e){this.custom[t]=e}static get(t){return this.custom[t]}}Dg.custom={};class qR extends cg{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new Pt,this.pixelList=new Pt}getPixelType(t,e){return this.__autoClear(),this.pixelList.add(t),qt.hitCanvas(e)}getPathType(t){return this.__autoClear(),this.pathList.add(t),qt.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach(e=>{e.__hitCanvas&&(e.__hitCanvas.destroy(),e.__hitCanvas=null)}),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}}const{toInnerRadiusPointOf:JR,copy:QR,setRadius:tL}=rt,Hs={},vo=yr.prototype;vo.__hitWorld=function(i){if(!this.__.hitSelf)return!1;this.__.hitRadius&&(QR(Hs,i),i=Hs,tL(i,this.__.hitRadius)),JR(i,this.__world,Hs);const{width:t,height:e}=this.__world,n=t<10&&e<10;if(this.__.hitBox||n){if(q.hitRadiusPoint(this.__layout.boxBounds,Hs))return!0;if(n)return!1}return(this.__layout.hitCanvasChanged||!this.__hitCanvas)&&(this.__updateHitCanvas(),this.__layout.boundsChanged||(this.__layout.hitCanvasChanged=!1)),this.__hit(Hs)};vo.__hitFill=function(i){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitFill(i,this.__.windingRule)};vo.__hitStroke=function(i,t){var e;return(e=this.__hitCanvas)===null||e===void 0?void 0:e.hitStroke(i,t)};vo.__hitPixel=function(i){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitPixel(i,this.__layout.renderBounds,this.__hitCanvas.hitScale)};vo.__drawHitPath=function(i){i&&this.__drawRenderPath(i)};const eL=new ze,Wg=z.prototype;Wg.__updateHitCanvas=function(){const i=this.__,{hitCanvasManager:t}=this.leafer,e=(i.__pixelFill||i.__isCanvas)&&i.hitFill==="pixel",n=i.__pixelStroke&&i.hitStroke==="pixel",o=e||n;this.__hitCanvas||(this.__hitCanvas=o?t.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):t.getPathType(this));const a=this.__hitCanvas;if(o){const{renderBounds:h}=this.__layout,u=V.image.hitCanvasSize,d=a.hitScale=Lt.set(0,0,u,u).getFitMatrix(h).a,{x:f,y,width:x,height:E}=Lt.set(h).scale(d);a.resize({width:x,height:E,pixelRatio:1}),a.clear(),He.patternLocked=!0,this.__renderShape(a,{matrix:eL.setWith(this.__world).scaleWith(1/d).invertWith().translate(-f,-y)},!e,!n),He.patternLocked=!1,a.resetTransform(),i.__isHitPixel=!0}else i.__isHitPixel&&(i.__isHitPixel=!1);this.__drawHitPath(a),a.setStrokeOptions(i)};Wg.__hit=function(i){V.name==="miniapp"&&this.__drawHitPath(this.__hitCanvas);const t=this.__;if(t.__isHitPixel&&this.__hitPixel(i))return!0;const{hitFill:e}=t,n=(t.fill||t.__isCanvas)&&(e==="path"||e==="pixel"&&!(t.__pixelFill||t.__isCanvas))||e==="all";if(n&&this.__hitFill(i))return!0;const{hitStroke:o,__strokeWidth:a}=t,h=t.stroke&&(o==="path"||o==="pixel"&&!t.__pixelStroke)||o==="all";if(!n&&!h)return!1;const u=i.radiusX*2;let d=u;if(h)switch(t.strokeAlign){case"inside":if(d+=a*2,!n&&this.__hitFill(i)&&this.__hitStroke(i,d))return!0;d=u;break;case"center":d+=a;break;case"outside":if(d+=a*2,!n){if(!this.__hitFill(i)&&this.__hitStroke(i,d))return!0;d=u}break}return d?this.__hitStroke(i,d):!1};const Fg=z.prototype,$g=pi.prototype,zg=he.prototype;$g.__updateHitCanvas=zg.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&this.hitFill==="pixel"||this.hitStroke==="all"?Fg.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)};$g.__hitFill=zg.__hitFill=function(i){return this.__hitCanvas?Fg.__hitFill.call(this,i):q.hitRadiusPoint(this.__layout.boxBounds,i)};const Hg=z.prototype,iL=de.prototype;function nc(i){return i.leafer?i.leafer.selector:V.selector||(V.selector=qt.selector())}Hg.find=function(i,t){return nc(this).getBy(i,this,!1,t)};Hg.findOne=function(i,t){return nc(this).getBy(i,this,!0,t)};iL.pick=function(i,t){return this.__layout.update(),t||(t={}),nc(this).getByPoint(i,t.hitRadius||0,Object.assign(Object.assign({},t),{target:this}))};const rc=ju.prototype;rc.hitFill=function(i,t){return t?this.context.isPointInPath(i.x,i.y,t):this.context.isPointInPath(i.x,i.y)};rc.hitStroke=function(i,t){return this.strokeWidth=t,this.context.isPointInStroke(i.x,i.y)};rc.hitPixel=function(i,t,e=1){let{x:n,y:o,radiusX:a,radiusY:h}=i;t&&(n-=t.x,o-=t.y),Lt.set(n-a,o-h,a*2,h*2).scale(e).ceil();const{data:u}=this.context.getImageData(Lt.x,Lt.y,Lt.width||1,Lt.height||1);for(let d=0,f=u.length;d<f;d+=4)if(u[d+3]>0)return!0;return u[3]>0};const{M:nL,L:rL,C:sL,Q:oL,Z:aL,N:hL,D:lL,X:uL,G:up,F:cp,O:cL,P:dL,U:fL}=_i,sc={scale(i,t,e){if(!i)return;let n,o=0,a=i.length;for(;o<a;)switch(n=i[o],n){case nL:case rL:bi(i,t,e,o,1),o+=3;break;case sL:bi(i,t,e,o,3),o+=7;break;case oL:bi(i,t,e,o,2),o+=5;break;case aL:o+=1;break;case hL:bi(i,t,e,o,2),o+=5;break;case lL:bi(i,t,e,o,2),o+=9;break;case uL:bi(i,t,e,o,2),o+=6;break;case up:bi(i,t,e,o,2),o+=9;break;case cp:bi(i,t,e,o,2),o+=5;break;case cL:i[o]=up,i.splice(o+4,0,i[o+3],0),bi(i,t,e,o,2),o+=9,a+=2;break;case dL:i[o]=cp,i.splice(o+4,0,i[o+3]),bi(i,t,e,o,2),o+=5,a+=1;break;case fL:bi(i,t,e,o,2),o+=6;break}},scalePoints(i,t,e,n,o){for(let a=o?n+1:0,h=o?a+o*2:i.length;a<h;a+=2)i[a]*=t,i[a+1]*=e}},{scalePoints:bi}=sc,nu=ot.get(),{topLeft:_L,top:pL,topRight:gL,right:yL,bottom:vL,left:mL}=as;function Ja(i,t,e){i.pathInputed?Qa(i,t,e):(t!==1&&(i.width*=t),e!==1&&(i.height*=e))}function wL(i,t,e){const{app:n}=i,o=n&&n.editor;let a=t;if(o.editing){const u=i.__layout;let{width:d,height:f}=u.boxBounds;switch(d*=e-t,f*=t-e,o.resizeDirection){case pL:case vL:a=e,u.affectScaleOrRotation?i.moveInner(-d/2,0):i.x-=d/2;break;case mL:case yL:u.affectScaleOrRotation?i.moveInner(0,-f/2):i.y-=f/2;break;case _L:case gL:u.affectScaleOrRotation?i.moveInner(0,-f):i.y-=f;break}}i.fontSize*=a;const h=i.__;h.__autoWidth||(i.width*=a),h.__autoHeight||(i.height*=a)}function Qa(i,t,e){sc.scale(i.__.path,t,e),i.path=i.__.path}function Ng(i,t,e){const{points:n}=i;typeof n[0]=="object"?n.forEach(o=>{o.x*=t,o.y*=e}):sc.scalePoints(n,t,e),i.points=n}function Du(i,t,e){const{children:n}=i;for(let o=0;o<n.length;o++)nu.a=t,nu.d=e,n[o].transform(nu,!0)}const th=yr.prototype;th.scaleResize=function(i,t=i,e){const n=this;e||n.editConfig&&n.editConfig.editSize==="scale"?(n.scaleX*=i,n.scaleY*=t):(i<0&&(n.scaleX*=-1,i=-i),t<0&&(n.scaleY*=-1,t=-t),this.__scaleResize(i,t))};th.__scaleResize=function(i,t){Ja(this,i,t)};th.resizeWidth=function(i){const t=i/this.getBounds("box","local").width;this.scaleOf(this.__layout.boxBounds,t,this.__.lockRatio?t:1,!0)};th.resizeHeight=function(i){const t=i/this.getBounds("box","local").height;this.scaleOf(this.__layout.boxBounds,this.__.lockRatio?t:1,t,!0)};Bt.prototype.__scaleResize=function(i,t){this.__.resizeFontSize||this.editConfig&&this.editConfig.editSize==="font-size"?wL(this,i,t):Ja(this,i,t)};ds.prototype.__scaleResize=function(i,t){Qa(this,i,t)};Yi.prototype.__scaleResize=function(i,t){this.pathInputed?Qa(this,i,t):this.points?Ng(this,i,t):this.width*=i};vn.prototype.__scaleResize=function(i,t){this.pathInputed?Qa(this,i,t):this.points?Ng(this,i,t):Ja(this,i,t)};de.prototype.__scaleResize=function(i,t){Du(this,i,t)};he.prototype.__scaleResize=function(i,t){this.__.__autoSize&&this.children.length?Du(this,i,t):(Ja(this,i,t),this.__.resizeChildren&&Du(this,i,t))};function mo(i,t,e,n){var o=arguments.length,a=o<3?t:n,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(h=i[u])&&(a=(o<3?h(a):o>3?h(t,e,a):h(t,e))||a);return o>3&&a&&Object.defineProperty(t,e,a),a}function dp(i){return i?i instanceof Array?i:[i]:[]}class ge extends Zi{get list(){return dp(this.value)}get oldList(){return dp(this.oldValue)}constructor(t,e){super(t),e&&Object.assign(this,e)}}ge.SELECT="editor.select";ge.HOVER="editor.hover";class Wu extends ge{constructor(t,e){super(t,e)}}Wu.MOVE="editor.move";class cr extends ge{constructor(t,e){super(t,e)}}cr.SCALE="editor.scale";class Fu extends ge{constructor(t,e){super(t,e)}}Fu.ROTATE="editor.rotate";class $u extends ge{constructor(t,e){super(t,e)}}$u.SKEW="editor.skew";function oc(i){return(t,e)=>{const n="_"+e;qe(t,e,{get(){return this[n]},set(o){const a=this[n];a!==o&&(this[n]=o,i(this,a))}})}}const ru=ot.get(),{abs:su}=Math,{copy:xL,scale:bL}=ot;class zu extends z{constructor(){super(),this.list=[],this.hittable=!1,this.strokeAlign="center"}setTarget(t,e){this.set(e),this.target=t}__draw(t,e){const{list:n}=this;if(n.length){let o;const a=this.__,{stroke:h,strokeWidth:u,fill:d}=a,{bounds:f}=e;for(let y=0;y<n.length;y++){o=n[y];const{worldTransform:x,worldRenderBounds:E}=o;if(f&&f.hit(E,e.matrix)){const m=su(x.scaleX),S=su(x.scaleY);if(m!==S){xL(ru,x),bL(ru,1/m,1/S),t.setWorld(ru,e.matrix),t.beginPath(),a.strokeWidth=u;const{x:B,y:P,width:$,height:I}=o.__layout.boxBounds;t.rect(B*m,P*S,$*m,I*S)}else t.setWorld(x,e.matrix),t.beginPath(),o.__.__useArrow?o.__drawPath(t):o.__.__pathForRender?o.__drawRenderPath(t):o.__drawPathByBox(t),a.strokeWidth=u/su(x.scaleX);h&&(typeof h=="string"?Zt.stroke(h,this,t):Zt.strokes(h,this,t)),d&&(typeof d=="string"?Zt.fill(d,this,t):Zt.fills(d,this,t))}}a.strokeWidth=u}}destroy(){this.target=null,super.destroy()}}mo([oc(EL)],zu.prototype,"target",void 0);function EL(i){const t=i.target;i.list=t?t instanceof Array?t:[t]:[],i.forceUpdate()}class CL extends de{constructor(t){super(t),this.strokeArea=new pi({strokeAlign:"center"}),this.fillArea=new pi,this.visible=this.hittable=!1,this.addMany(this.fillArea,this.strokeArea)}setStyle(t,e){const{visible:n,stroke:o,strokeWidth:a}=t;this.visible=n,this.strokeArea.reset(Object.assign({stroke:o,strokeWidth:a},e||{})),this.fillArea.reset({visible:!e,fill:o,opacity:.2})}setBounds(t){this.strokeArea.set(t),this.fillArea.set(t)}}const{No:ou,Yes:SL,NoAndSkip:fp,YesAndSkip:_p}=za,Ug={findOne(i){return i.list.find(t=>t.editable)},findBounds(i,t){if(i.__.hittable&&i.__.visible&&!i.__.locked&&t.hit(i.__world)){if(i.__.editable){if(i.isBranch&&!i.__.hitChildren)return i.__.hitSelf?_p:fp;if(i.isFrame)return t.includes(i.__layout.boxBounds,i.__world)?_p:ou;if(t.hit(i.__layout.boxBounds,i.__world)&&i.__.hitSelf)return SL}return ou}else return i.isBranch?fp:ou}},{findOne:au}=Ug;class TL extends de{get dragging(){return!!this.originList}get running(){const{editor:t}=this;return this.hittable&&t.visible&&t.hittable&&t.mergeConfig.selector}get isMoveMode(){return this.app&&this.app.interaction.moveMode}constructor(t){super(),this.hoverStroker=new zu,this.targetStroker=new zu,this.bounds=new zt,this.selectArea=new CL,this.__eventIds=[],this.editor=t,this.addMany(this.targetStroker,this.hoverStroker,this.selectArea),this.__listenEvents()}onHover(){const{editor:t}=this;if(this.running&&!this.dragging&&!t.dragging){const{stroke:e,strokeWidth:n,hover:o,hoverStyle:a}=t.mergeConfig;this.hoverStroker.setTarget(o?this.editor.hoverTarget:null,Object.assign({stroke:e,strokeWidth:n},a||{}))}else this.hoverStroker.target=null}onSelect(){if(this.running){const{mergeConfig:t,list:e}=this.editor,{stroke:n,strokeWidth:o}=t;this.targetStroker.setTarget(e,{stroke:n,strokeWidth:Math.max(1,o/2)}),this.hoverStroker.target=null}}update(){this.targetStroker.target&&this.targetStroker.forceUpdate()}onPointerMove(t){const{app:e,editor:n}=this;if(this.running&&!this.isMoveMode&&e.interaction.canHover&&!e.interaction.dragging){const o=this.findUI(t);n.hoverTarget=n.hasItem(o)?null:o}this.isMoveMode&&(n.hoverTarget=null)}onBeforeDown(t){if(t.multiTouch)return;const{select:e}=this.editor.mergeConfig;e==="press"&&(this.app.config.mobile?this.waitSelect=()=>this.checkAndSelect(t):this.checkAndSelect(t))}onTap(t){if(t.multiTouch)return;const{editor:e}=this,{select:n}=e.mergeConfig;n==="tap"?this.checkAndSelect(t):this.waitSelect&&this.waitSelect(),this.needRemoveItem?e.removeItem(this.needRemoveItem):this.isMoveMode&&(e.target=null)}checkAndSelect(t){if(this.needRemoveItem=null,this.allowSelect(t)){const{editor:e}=this,n=this.findUI(t);n?this.isMultipleSelect(t)?e.hasItem(n)?this.needRemoveItem=n:e.addItem(n):e.target=n:this.allow(t.target)&&(t.shiftKey||(e.target=null))}}onDragStart(t){if(!t.multiTouch&&(this.waitSelect&&this.waitSelect(),this.allowDrag(t))){const{editor:e}=this,{stroke:n,area:o}=e.mergeConfig,{x:a,y:h}=t.getInnerPoint(this);this.bounds.set(a,h),this.selectArea.setStyle({visible:!0,stroke:n,x:a,y:h},o),this.selectArea.setBounds(this.bounds.get()),this.originList=e.leafList.clone()}}onDrag(t){if(!t.multiTouch){if(this.editor.dragging)return this.onDragEnd(t);if(this.dragging){const{editor:e}=this,n=t.getInnerTotal(this),o=this.bounds.clone().unsign(),a=new Pt(e.app.find(Ug.findBounds,o));if(this.bounds.width=n.x,this.bounds.height=n.y,this.selectArea.setBounds(o.get()),a.length){const h=[];this.originList.forEach(u=>{a.has(u)||h.push(u)}),a.forEach(u=>{this.originList.has(u)||h.push(u)}),(h.length!==e.list.length||e.list.some((u,d)=>u!==h[d]))&&(e.target=h)}else e.target=this.originList.list}}}onDragEnd(t){t.multiTouch||this.dragging&&(this.originList=null,this.selectArea.visible=!1)}onAutoMove(t){if(this.dragging){const{x:e,y:n}=t.getLocalMove(this);this.bounds.x+=e,this.bounds.y+=n}}allow(t){return t.leafer!==this.editor.leafer}allowDrag(t){return this.running&&this.editor.mergeConfig.boxSelect&&!t.target.draggable?!this.editor.editing&&this.allow(t.target)||t.shiftKey&&!au(t.path):!1}allowSelect(t){return this.running&&!this.isMoveMode&&!t.middle}findDeepOne(t){const e={exclude:new Pt(this.editor.editBox.rect)};return au(t.target.leafer.interaction.findPath(t,e))}findUI(t){return this.isMultipleSelect(t)?this.findDeepOne(t):au(t.path)}isMultipleSelect(t){return t.shiftKey||this.editor.mergeConfig.continuousSelect}__listenEvents(){const{editor:t}=this;t.waitLeafer(()=>{const{app:e}=t;e.selector.proxy=t,this.__eventIds=[t.on_(ge.HOVER,this.onHover,this),t.on_(ge.SELECT,this.onSelect,this),e.on_(j.MOVE,this.onPointerMove,this),e.on_(j.BEFORE_DOWN,this.onBeforeDown,this),e.on_(j.TAP,this.onTap,this),e.on_(ut.START,this.onDragStart,this,!0),e.on_(ut.DRAG,this.onDrag,this),e.on_(ut.END,this.onDragEnd,this),e.on_(ae.MOVE,this.onAutoMove,this),e.on_([$e.ZOOM,ae.MOVE],()=>{this.editor.hoverTarget=null})]})}__removeListenEvents(){this.__eventIds&&(this.off_(this.__eventIds),this.__eventIds.length=0)}destroy(){this.editor=this.originList=this.needRemoveItem=null,this.__removeListenEvents(),super.destroy()}}const{topLeft:jr,top:Ns,topRight:qr,right:Us,bottomRight:Jr,bottom:Gs,bottomLeft:Qr,left:Vs}=as,{toPoint:hu}=gn,{within:pp}=fe,dr={getScaleData(i,t,e,n,o,a,h,u){let d,f={},y=1,x=1;const{boxBounds:E,widthRange:m,heightRange:S}=i,{width:B,height:P}=t;a&&(n.x*=2,n.y*=2);const $=i.scaleX/t.scaleX,I=i.scaleY/t.scaleY,F=$<0?-1:1,L=I<0?-1:1,T=u?$:F*E.width/B,U=u?I:L*E.height/P;n.x*=u?$:F,n.y*=u?I:L,Math.abs(n.x)===B&&(n.x+=.1),Math.abs(n.y)===P&&(n.y+=.1);const W=(-n.y+P)/P,nt=(n.x+B)/B,pt=(n.y+P)/P,Q=(-n.x+B)/B;switch(e){case Ns:x=W,d="bottom";break;case Us:y=nt,d="left";break;case Gs:x=pt,d="top";break;case Vs:y=Q,d="right";break;case jr:x=W,y=Q,d="bottom-right";break;case qr:x=W,y=nt,d="bottom-left";break;case Jr:x=pt,y=nt,d="top-left";break;case Qr:x=pt,y=Q,d="top-right"}if(o&&!(o==="corner"&&e%2)){let Z;switch(e){case Ns:case Gs:Z=x;break;case Vs:case Us:Z=y;break;default:Z=Math.sqrt(Math.abs(y*x))}y=y<0?-Z:Z,x=x<0?-Z:Z}if(y/=T,x/=U,!h){const{worldTransform:J}=i;y<0&&(y=1/E.width/J.scaleX),x<0&&(x=1/E.height/J.scaleY)}if(m){const J=E.width*i.scaleX;y=pp(J*y,m)/J}if(S){const J=E.height*i.scaleY;x=pp(J*x,S)/J}return hu(a||d,E,f,!0),{origin:f,scaleX:y,scaleY:x,direction:e,lockRatio:o,around:a}},getRotateData(i,t,e,n,o){let a,h={};switch(t){case jr:a="bottom-right";break;case qr:a="bottom-left";break;case Jr:a="top-left";break;case Qr:a="top-right";break;default:a="center"}return hu(o||a,i,h,!0),{origin:h,rotation:rt.getRotation(n,h,e)}},getSkewData(i,t,e,n){let o,a={},h=0,u=0,d;switch(t){case Ns:d={x:.5,y:0},o="bottom",h=1;break;case Gs:d={x:.5,y:1},o="top",h=1;break;case Vs:d={x:0,y:.5},o="right",u=1;break;case Us:d={x:1,y:.5},o="left",u=1}const{width:f,height:y}=i;d.x=d.x*f,d.y=d.y*y,hu(n||o,i,a,!0);const x=rt.getRotation(d,a,{x:d.x+(h?e.x:0),y:d.y+(u?e.y:0)});return h?h=-x:u=x,{origin:a,skewX:h,skewY:u}},getAround(i,t){return t&&!i?"center":i},getRotateDirection(i,t,e=8){return i=(i+Math.round(t/(360/e)))%e,i<0&&(i+=e),i},getFlipDirection(i,t,e){if(t)switch(i){case Vs:i=Us;break;case jr:i=qr;break;case Qr:i=Jr;break;case Us:i=Vs;break;case qr:i=jr;break;case Jr:i=Qr;break}if(e)switch(i){case Ns:i=Gs;break;case jr:i=Qr;break;case qr:i=Jr;break;case Gs:i=Ns;break;case Qr:i=jr;break;case Jr:i=qr;break}return i}},lu={};function Hu(i,t){const{editBox:e}=i,n=e.enterPoint;if(!n||!i.editing||!e.visible||n.name==="circle")return;if(n.pointType==="button"){n.cursor||(n.cursor="pointer");return}let{rotation:o}=e;const{resizeCursor:a,rotateCursor:h,skewCursor:u,resizeable:d,rotateable:f,skewable:y}=i.mergeConfig,{pointType:x}=n,{flippedX:E,flippedY:m}=e;let S=x==="resize";S&&f&&(t.metaKey||t.ctrlKey||!d)&&(S=!1);const P=y&&!S&&n.name==="resize-line"?u:S?a:h;o+=(dr.getFlipDirection(n.direction,E,m)+1)*45,o=Math.round(fe.formatRotation(o,!0)/2)*2;const{url:$,x:I,y:F}=P,L=$+o;lu[L]?n.cursor=lu[L]:lu[L]=n.cursor={url:RL($,o),x:I,y:F}}function Gg(i){const{moveCursor:t,moveable:e}=i.mergeConfig;i.editBox.rect.cursor=e?t:void 0}function RL(i,t){return'"data:image/svg+xml,'+encodeURIComponent(i.replace("{{rotation}}",t.toString()))+'"'}class Ta extends he{}const gp=["top","right","bottom","left"];class LL extends de{get flipped(){return this.flippedX||this.flippedY}get flippedX(){return this.scaleX<0}get flippedY(){return this.scaleY<0}get flippedOne(){return this.scaleX*this.scaleY<0}constructor(t){super(),this.view=new de,this.rect=new he({name:"rect",hitFill:"all",hitStroke:"none",strokeAlign:"center",hitRadius:5}),this.circle=new Ta({name:"circle",strokeAlign:"center",around:"center",cursor:"crosshair",hitRadius:5}),this.buttons=new de({around:"center",hitSelf:!1}),this.resizePoints=[],this.rotatePoints=[],this.resizeLines=[],this.__eventIds=[],this.editor=t,this.visible=!1,this.create(),this.__listenEvents()}create(){let t,e,n;const{view:o,resizePoints:a,rotatePoints:h,resizeLines:u,rect:d,circle:f,buttons:y}=this,x=["bottom-right","bottom","bottom-left","left","top-left","top","top-right","right"];for(let E=0;E<8;E++)t=new Ta({name:"rotate-point",around:x[E],width:15,height:15,hitFill:"all"}),h.push(t),this.listenPointEvents(t,"rotate",E),E%2&&(e=new Ta({name:"resize-line",around:"center",width:10,height:10,hitFill:"all"}),u.push(e),this.listenPointEvents(e,"resize",E)),n=new Ta({name:"resize-point",hitRadius:5}),a.push(n),this.listenPointEvents(n,"resize",E);this.listenPointEvents(f,"rotate",2),o.addMany(...h,d,f,y,...u,...a),this.add(o)}load(){const{mergeConfig:t,element:e,single:n}=this.editor,{rect:o,circle:a,resizePoints:h}=this,{stroke:u,strokeWidth:d}=t,f=this.getPointsStyle(),y=this.getMiddlePointsStyle();let x;for(let E=0;E<8;E++)x=h[E],x.set(this.getPointStyle(E%2?y[(E-1)/2%y.length]:f[E/2%f.length])),E%2||(x.rotation=E/2*90);a.set(this.getPointStyle(t.circle||t.rotatePoint||f[0])),o.set(Object.assign({stroke:u,strokeWidth:d},t.rect||{})),o.hittable=!n,o.syncEventer=n&&this.editor,n&&(e.syncEventer=o,this.app.interaction.bottomList=[{target:o,proxy:e}])}update(t){if(this.visible=!this.editor.element.locked,this.view.worldOpacity){const{mergeConfig:e}=this.editor,{width:n,height:o}=t,{rect:a,circle:h,buttons:u,resizePoints:d,rotatePoints:f,resizeLines:y}=this,{middlePoint:x,resizeable:E,rotateable:m,hideOnSmall:S}=e,B=typeof S=="number"?S:10,P=!(S&&n<B&&o<B);let $={},I,F,L;for(let T=0;T<8;T++)gn.toPoint(gn.directionData[T],t,$),F=d[T],I=f[T],L=y[Math.floor(T/2)],F.set($),I.set($),L.set($),F.visible=L.visible=P&&!!(E||m),I.visible=P&&m&&E&&!e.rotatePoint,T%2&&(F.visible=I.visible=P&&!!x,(T+1)/2%2?(L.width=n,F.width>n-30&&(F.visible=!1)):(L.height=o,F.rotation=90,F.width>o-30&&(F.visible=!1)));h.visible=P&&m&&!!(e.circle||e.rotatePoint),h.visible&&this.layoutCircle(e),a.path&&(a.path=null),a.set(Object.assign(Object.assign({},t),{visible:!0})),u.visible=P&&u.children.length>0,u.visible&&this.layoutButtons(e)}}layoutCircle(t){const{circleDirection:e,circleMargin:n,buttonsMargin:o,buttonsDirection:a,middlePoint:h}=t,u=gp.indexOf(e||(this.buttons.children.length&&a==="bottom"?"top":"bottom"));this.setButtonPosition(this.circle,u,n||o,!!h)}layoutButtons(t){const{buttons:e}=this,{buttonsDirection:n,buttonsFixed:o,buttonsMargin:a,middlePoint:h}=t,{flippedX:u,flippedY:d}=this;let f=gp.indexOf(n);(f%2&&u||(f+1)%2&&d)&&o&&(f=(f+2)%4);const y=o?dr.getRotateDirection(f,this.flippedOne?this.rotation:-this.rotation,4):f;this.setButtonPosition(e,y,a,!!h),o&&(e.rotation=(y-f)*90),e.scaleX=u?-1:1,e.scaleY=d?-1:1}setButtonPosition(t,e,n,o){const a=this.resizePoints[e*2+1],h=e%2,u=!e||e===3?-1:1,d=e%2,f=(n+(d?(o?a.width:0)+t.boxBounds.width:(o?a.height:0)+t.boxBounds.height)/2)*u;h?(t.x=a.x+f,t.y=a.y):(t.x=a.x,t.y=a.y+f)}unload(){this.visible=!1}getPointStyle(t){const{stroke:e,strokeWidth:n,pointFill:o,pointSize:a,pointRadius:h}=this.editor.mergeConfig,u={fill:o,stroke:e,strokeWidth:n,around:"center",strokeAlign:"center",width:a,height:a,cornerRadius:h};return t?Object.assign(u,t):u}getPointsStyle(){const{point:t}=this.editor.mergeConfig;return t instanceof Array?t:[t]}getMiddlePointsStyle(){const{middlePoint:t}=this.editor.mergeConfig;return t instanceof Array?t:t?[t]:this.getPointsStyle()}onSelect(t){t.oldList.length===1&&(t.oldList[0].syncEventer=null,this.app&&(this.app.interaction.bottomList=null))}onDragStart(t){this.dragging=!0;const{editor:e}=this;t.current.name==="rect"?(this.moving=!0,e.dragStartPoint={x:e.element.x,y:e.element.y},e.opacity=e.mergeConfig.hideOnMove?0:1):t.current.pointType==="resize"&&(e.dragStartBounds=Object.assign({},e.element.getLayoutBounds("box","local")),e.resizeDirection=t.current.direction)}onDragEnd(t){this.dragging=!1,this.moving=!1,t.current.name==="rect"&&(this.editor.opacity=1),this.editor.resizeDirection=void 0}onDrag(t){const{editor:e}=this,n=this.enterPoint=t.current;n.pointType==="rotate"||t.metaKey||t.ctrlKey||!e.mergeConfig.resizeable?e.mergeConfig.rotateable&&e.onRotate(t):n.pointType==="resize"&&e.onScale(t),Hu(e,t)}onArrow(t){if(this.editor.editing&&this.editor.mergeConfig.keyEvent){const e={x:0,y:0},n=t.shiftKey?10:1;switch(t.code){case"ArrowDown":e.y=n;break;case"ArrowUp":e.y=-n;break;case"ArrowLeft":e.x=-n;break;case"ArrowRight":e.x=n}this.editor.move(e)}}onDoubleTap(t){this.editor.mergeConfig.openInner==="double"&&this.openInner(t)}onLongPress(t){this.editor.mergeConfig.openInner==="long"&&this.openInner(t)}openInner(t){const{editor:e}=this;if(e.single){const{element:n}=e;if(n.isBranch){if(n.textBox){const o=n.children.find(a=>a.editable&&a instanceof Bt);if(o)return e.openInnerEditor(o)}e.openGroup(n),e.target=e.selector.findDeepOne(t)}else e.openInnerEditor()}}listenPointEvents(t,e,n){const{editor:o}=this;t.direction=n,t.pointType=e,t.on_(ut.START,this.onDragStart,this),t.on_(ut.DRAG,this.onDrag,this),t.on_(ut.END,this.onDragEnd,this),t.on_(j.LEAVE,()=>this.enterPoint=null),t.name!=="circle"&&t.on_(j.ENTER,a=>{this.enterPoint=t,Hu(o,a)})}__listenEvents(){const{rect:t,editor:e}=this;this.__eventIds=[e.on_(ge.SELECT,this.onSelect,this),t.on_(ut.START,this.onDragStart,this),t.on_(ut.DRAG,e.onMove,e),t.on_(ut.END,this.onDragEnd,this),t.on_(j.ENTER,()=>Gg(e)),t.on_(j.DOUBLE_TAP,this.onDoubleTap,this),t.on_(j.LONG_PRESS,this.onLongPress,this)]}__removeListenEvents(){this.off_(this.__eventIds),this.__eventIds.length=0}destroy(){this.editor=null,this.__removeListenEvents(),super.destroy()}}class kL extends z{constructor(t){super(),this.editor=t,this.hittable=!1}__draw(t,e){const{editor:n}=this,{mask:o}=n.mergeConfig;if(o&&n.list.length){const{rect:a}=n.editBox,{width:h,height:u}=a.__;t.resetTransform(),t.fillWorld(t.bounds,o===!0?"rgba(0,0,0,0.8)":o),t.setWorld(a.__world,e.matrix),t.clearRect(0,0,h,u)}}destroy(){this.editor=null,super.destroy()}}const ac=`
<feOffset dy="1"/>
<feGaussianBlur stdDeviation="1.5"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/>
<feBlend mode="normal" in="SourceGraphic" result="shape"/>`,BL=`
<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
<g filter="url(#f)">
<g transform="rotate({{rotation}},12,12)">
<path d="M7.5 8.0H8.5V5.9L6.8 7.2L7.5 8.0ZM3 11.4L2.3 10.6L1.3 11.4L2.3 12.2L3 11.4ZM7.5 10.4H6.5V11.4H7.5V10.4ZM16.5 10.4V11.4H17.5V10.4H16.5ZM16.5 8.0L17.1 7.2L15.5 5.9V8.0H16.5ZM21 11.4L21.6 12.2L22.6 11.4L21.6 10.6L21 11.4ZM16.5 14.9H15.5V16.9L17.1 15.7L16.5 14.9ZM16.5 12.4H17.5V11.4H16.5V12.4ZM7.5 12.4V11.4H6.5V12.4H7.5ZM7.5 14.9L6.8 15.7L8.5 16.9V14.9H7.5ZM6.8 7.2L2.3 10.6L3.6 12.2L8.1 8.7L6.8 7.2ZM8.5 10.4V8.0H6.5V10.4H8.5ZM16.5 9.4H7.5V11.4H16.5V9.4ZM17.5 10.4V8.0H15.5V10.4H17.5ZM15.8 8.7L20.3 12.2L21.6 10.6L17.1 7.2L15.8 8.7ZM20.3 10.6L15.8 14.1L17.1 15.7L21.6 12.2L20.3 10.6ZM17.5 14.9V12.4H15.5V14.9H17.5ZM7.5 13.4H16.5V11.4H7.5V13.4ZM8.5 14.9V12.4H6.5V14.9H8.5ZM2.3 12.2L6.8 15.7L8.1 14.1L3.6 10.6L2.3 12.2Z" fill="white"/>
<path fill-rule="evenodd" d="M3 11.4L7.5 8.0V10.4H16.5V8.0L21 11.4L16.5 14.9V12.4H7.5V14.9L3 11.4Z" fill="black"/>
</g>
</g>
<defs>
<filter id="f" x="-1.6" y="3.9" width="27.2" height="16.9" filterUnits="userSpaceOnUse">
${ac}
</filter>
</defs>
</svg>
`,OL=`
<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
<g filter="url(#f)">
<g transform="rotate(135,12,12),rotate({{rotation}},12,12)">
<path d="M20.4 8H21.4L20.8 7.1L17.3 2.6L17 2.1L16.6 2.6L13.1 7.1L12.5 8H13.5H15.4C14.9 11.8 11.8 14.9 8 15.4V13.5V12.5L7.1 13.1L2.6 16.6L2.1 17L2.6 17.3L7.1 20.8L8 21.4V20.4V18.4C13.5 17.9 17.9 13.5 18.4 8H20.4Z" stroke="white"/>
<path fill-rule="evenodd" d="M17 3L20.4 7.5H17.9C17.7 13.1 13.1 17.7 7.5 17.9V20.4L3 17L7.5 13.5V15.9C12.0 15.7 15.7 12.0 15.9 7.5H13.5L17 3Z" fill="black"/>
</g>
</g>
<defs>
<filter id="f" x="-1.6" y="-0.6" width="27.1" height="27.1" filterUnits="userSpaceOnUse">
${ac}
</filter>
</defs>
</svg>
`,PL=`
<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
<g filter="url(#f)">
<g transform="rotate(90,12,12),rotate({{rotation}},12,12)">
<path d="M21 10.4L21 11.4L23.8 11.4L21.6 9.6L21 10.4ZM17 10.4V11.4L17 11.4L17 10.4ZM15.5 6L16.1 5.2L14.5 3.9V6H15.5ZM15.5 8.4V9.4H16.5V8.4H15.5ZM6 8.4V7.4H5V8.4H6ZM6 10.4H5V11.4H6V10.4ZM7 14.4V13.4L7 13.4L7 14.4ZM3 14.4L3 13.4L0.1 13.4L2.3 15.2L3 14.4ZM8.5 18.9L7.8 19.7L9.5 21.0V18.9H8.5ZM8.5 16.4V15.4H7.5V16.4H8.5ZM19 16.4V17.4H20V16.4H19ZM19 14.4H20V13.4H19V14.4ZM21 9.4L17 9.4L17 11.4L21 11.4L21 9.4ZM14.8 6.7L20.3 11.2L21.6 9.6L16.1 5.2L14.8 6.7ZM16.5 8.4V6H14.5V8.4H16.5ZM6 9.4H15.5V7.4H6V9.4ZM7 10.4V8.4H5V10.4H7ZM15.5 9.4H6V11.4H15.5V9.4ZM17 9.4H15.5V11.4H17V9.4ZM7 15.4H8.5V13.4H7V15.4ZM3 15.4L7 15.4L7 13.4L3 13.4L3 15.4ZM9.1 18.1L3.6 13.6L2.3 15.2L7.8 19.7L9.1 18.1ZM7.5 16.4V18.9H9.5V16.4H7.5ZM19 15.4H8.5V17.4H19V15.4ZM18 14.4V16.4H20V14.4H18ZM8.5 15.4H19V13.4H8.5V15.4Z" fill="white"/>
<path fill-rule="evenodd" d="M17 10.4L21 10.4L15.5 6V8.4H6V10.4H15.5H17ZM8.5 14.4H7L3 14.4L8.5 18.9V16.4H19V14.4H8.5Z" fill="black"/>
</g>
</g>
<defs>
<filter x="-2.8" y="1.9" width="29.6" height="23.1" filterUnits="userSpaceOnUse" >
${ac}
</filter>
</defs>
</svg>
`,AL={editSize:"size",keyEvent:!0,stroke:"#836DFF",strokeWidth:2,pointFill:"#FFFFFF",pointSize:10,pointRadius:16,rotateGap:45,buttonsDirection:"bottom",buttonsMargin:12,hideOnSmall:!0,moveCursor:"move",resizeCursor:{url:BL,x:12,y:12},rotateCursor:{url:OL,x:12,y:12},skewCursor:{url:PL,x:12,y:12},selector:!0,hover:!0,select:"press",openInner:"double",boxSelect:!0,moveable:!0,resizeable:!0,flipable:!0,rotateable:!0,skewable:!0},ML=new zt;function Vg(i){const{simulateTarget:t,list:e}=i,{zoomLayer:n}=e[0].leafer.zoomLayer;t.safeChange(()=>t.reset(ML.setListWithFn(e,o=>o.getBounds("box","page")).get())),n.add(t)}function IL(i,t){const{target:e}=i;e?i.leafList=e instanceof Pt?e:new Pt((e instanceof Array,e)):(i.simulateTarget.remove(),i.leafList.reset(),i.closeInnerEditor()),i.emitEvent(new ge(ge.SELECT,{editor:i,value:e,oldValue:t})),i.checkOpenedGroups(),i.editing?i.waitLeafer(()=>{i.multiple&&Vg(i),Gg(i),i.updateEditTool(),i.update(),i.listenTargetEvents()}):(i.updateEditTool(),i.removeTargetEvents())}function DL(i,t){i.emitEvent(new ge(ge.HOVER,{editor:i,value:i.hoverTarget,oldValue:t}))}const yp=(i,t)=>i.parent.children.indexOf(i)-t.parent.children.indexOf(t),vp=(i,t)=>t.parent.children.indexOf(t)-i.parent.children.indexOf(i),Ra={group(i,t,e){i.sort(vp);const{app:n,parent:o}=i[0];let a;e&&e.add?a=e:a=new de(e),o.addAt(a,o.children.indexOf(i[0])),i.sort(yp);const h=new ze(t.worldTransform);return h.divideParent(o.worldTransform),a.setTransform(h),a.editable=!0,a.hitChildren=!1,n.lockLayout(),i.forEach(u=>u.dropTo(a)),n.unlockLayout(),a},ungroup(i){const{app:t}=i[0],e=[];return t.lockLayout(),i.forEach(n=>{if(n.isBranch&&!n.isBranchLeaf){const{parent:o,children:a}=n;for(;a.length;)e.push(a[0]),a[0].dropTo(o,o.children.indexOf(n));n.remove()}else e.push(n)}),t.unlockLayout(),e},toTop(i){i.sort(yp),i.forEach(t=>{t.parent&&t.parent.add(t)})},toBottom(i){i.sort(vp),i.forEach(t=>{t.parent&&t.parent.addAt(t,0)})}},WL=Tt.get("EditToolCreator");function Yg(){return i=>{pr.register(i)}}const pr={list:{},register(i){const{tag:t}=i.prototype;uu[t]?WL.repeat(t):uu[t]=i},get(i,t){return new uu[i](t)}},{list:uu}=pr;class fn extends ge{constructor(t,e){super(t,e)}}fn.BEFORE_OPEN="innerEditor.before_open";fn.OPEN="innerEditor.open";fn.BEFORE_CLOSE="innerEditor.before_close";fn.CLOSE="innerEditor.close";class Si extends ge{constructor(t,e){super(t,e)}}Si.GROUP="editor.group";Si.BEFORE_UNGROUP="editor.before_ungroup";Si.UNGROUP="editor.ungroup";Si.OPEN="editor.open_group";Si.CLOSE="editor.close_group";const{updateMatrix:cu}=Ne,FL={x:1,y:1,scaleX:1,scaleY:1,rotation:1,skewX:1,skewY:1},Ys="top-left";class $L extends pi{get __tag(){return"SimulateElement"}constructor(t){super(),this.checkChange=!0,this.canChange=!0,this.visible=this.hittable=!1,this.on(Gi.CHANGE,e=>{if(this.checkChange&&FL[e.attrName]){const{attrName:n,newValue:o,oldValue:a}=e,h=n[0]==="s"?(o||1)/(a||1):(o||0)-(a||0);this.canChange=!1;const u=this.__;u[n]=a,cu(this.parent),cu(this);const d=new ze(this.__world);switch(u[n]=o,this.__layout.rotationChange(),cu(this),this.changedTransform=new ze(this.__world).divide(d),n){case"x":t.move(h,0);break;case"y":t.move(0,h);break;case"rotation":t.rotateOf(Ys,h);break;case"scaleX":t.scaleOf(Ys,h,1);break;case"scaleY":t.scaleOf(Ys,1,h);break;case"skewX":t.skewOf(Ys,h,0);break;case"skewY":t.skewOf(Ys,0,h)}this.canChange=!0}})}safeChange(t){this.canChange&&(this.checkChange=!1,t(),this.checkChange=!0)}}class hc extends de{get mergeConfig(){const{element:t,config:e}=this;return this.single&&t.editConfig?Object.assign(Object.assign({},e),t.editConfig):e}get list(){return this.leafList.list}get dragHoverExclude(){return[this.editBox.rect]}get editing(){return!!this.list.length}get groupOpening(){return!!this.openedGroupList.length}get multiple(){return this.list.length>1}get single(){return this.list.length===1}get dragging(){return this.editBox.dragging}get moving(){return this.editBox.moving}get element(){return this.multiple?this.simulateTarget:this.list[0]}get buttons(){return this.editBox.buttons}constructor(t,e){super(e),this.config=ie.clone(AL),this.leafList=new Pt,this.openedGroupList=new Pt,this.simulateTarget=new $L(this),this.editBox=new LL(this),this.editToolList={},this.selector=new TL(this),this.editMask=new kL(this),this.targetEventIds=[],t&&(this.config=ie.default(t,this.config)),this.addMany(this.editMask,this.selector,this.editBox)}select(t){this.target=t}cancel(){this.target=null}hasItem(t){return this.leafList.has(t)}addItem(t){!this.hasItem(t)&&!t.locked&&(this.leafList.add(t),this.target=this.leafList.list)}removeItem(t){this.hasItem(t)&&(this.leafList.remove(t),this.target=this.leafList.list)}shiftItem(t){this.hasItem(t)?this.removeItem(t):this.addItem(t)}update(){this.editing&&(this.innerEditing&&this.innerEditor.update(),this.editTool.update(),this.selector.update())}updateEditBox(){this.multiple&&Vg(this),this.update()}updateEditTool(){const t=this.editTool;if(t&&(this.editBox.unload(),t.unload(),this.editTool=null),this.editing){const e=this.single?this.list[0].editOuter:"EditTool";this.editTool=this.editToolList[e]=this.editToolList[e]||pr.get(e,this),this.editBox.load(),this.editTool.load()}}getEditSize(t){return this.mergeConfig.editSize}onMove(t){if(t instanceof ae){if(t.moveType!=="drag"){const{moveable:e,resizeable:n}=this.mergeConfig,o=t.getLocalMove(this.element);e==="move"?(t.stop(),this.move(o.x,o.y)):n==="zoom"&&t.stop()}}else{const e={x:t.totalX,y:t.totalY};t.shiftKey&&(Math.abs(e.x)>Math.abs(e.y)?e.y=0:e.x=0),this.move(ut.getValidMove(this.element,this.dragStartPoint,e))}}onScale(t){const{element:e}=this;let{around:n,lockRatio:o,resizeable:a,flipable:h,editSize:u}=this.mergeConfig;if(t instanceof $e)a==="zoom"&&(t.stop(),this.scaleOf(e.getBoxPoint(t),t.scale,t.scale));else{const{direction:d}=t.current;(t.shiftKey||e.lockRatio)&&(o=!0);const f=dr.getScaleData(e,this.dragStartBounds,d,t.getInnerTotal(e),o,dr.getAround(n,t.altKey),h,this.multiple||u==="scale");this.editTool.onScaleWithDrag?(f.drag=t,this.scaleWithDrag(f)):this.scaleOf(f.origin,f.scaleX,f.scaleY)}}onRotate(t){const{skewable:e,rotateable:n,around:o,rotateGap:a}=this.mergeConfig,{direction:h,name:u}=t.current;if(e&&u==="resize-line")return this.onSkew(t);const{element:d}=this;let f,y;if(t instanceof fi)if(n==="rotate")t.stop(),y=t.rotation,f=d.getBoxPoint(t);else return;else{const x={x:t.x-t.moveX,y:t.y-t.moveY},E=dr.getRotateData(d.boxBounds,h,t.getBoxPoint(d),d.getBoxPoint(x),t.shiftKey?null:d.around||d.origin||o||"center");y=E.rotation,f=E.origin}y=fe.getGapRotation(y,a,d.rotation),y&&(d.scaleX*d.scaleY<0&&(y=-y),this.rotateOf(f,fe.float(y,2)))}onSkew(t){const{element:e}=this,{around:n}=this.mergeConfig,{origin:o,skewX:a,skewY:h}=dr.getSkewData(e.boxBounds,t.current.direction,t.getInnerMove(e),dr.getAround(n,t.altKey));!a&&!h||this.skewOf(o,a,h)}move(t,e=0){if(!this.checkTransform("moveable"))return;const{element:n}=this,o=n.getWorldPointByLocal(typeof t=="object"?Object.assign({},t):{x:t,y:e},null,!0);this.multiple&&n.safeChange(()=>n.move(t,e));const a=new Wu(Wu.MOVE,{target:n,editor:this,moveX:o.x,moveY:o.y});this.editTool.onMove(a),this.emitEvent(a)}scaleWithDrag(t){if(!this.checkTransform("resizeable"))return;const{element:e}=this,n=new cr(cr.SCALE,Object.assign(Object.assign({},t),{target:e,editor:this,worldOrigin:e.getWorldPoint(t.origin)}));this.editTool.onScaleWithDrag(n),this.emitEvent(n)}scaleOf(t,e,n=e,o){if(!this.checkTransform("resizeable"))return;const{element:a}=this,h=this.getWorldOrigin(t),u=this.multiple&&this.getChangedTransform(()=>a.safeChange(()=>a.scaleOf(t,e,n))),d=new cr(cr.SCALE,{target:a,editor:this,worldOrigin:h,scaleX:e,scaleY:n,transform:u});this.editTool.onScale(d),this.emitEvent(d)}flip(t){if(!this.checkTransform("resizeable"))return;const{element:e}=this,n=this.getWorldOrigin("center"),o=this.multiple?this.getChangedTransform(()=>e.safeChange(()=>e.flip(t))):new ze(Ne.getFlipTransform(e,t)),a=new cr(cr.SCALE,{target:e,editor:this,worldOrigin:n,scaleX:t==="x"?-1:1,scaleY:t==="y"?-1:1,transform:o});this.editTool.onScale(a),this.emitEvent(a)}rotateOf(t,e){if(!this.checkTransform("rotateable"))return;const{element:n}=this,o=this.getWorldOrigin(t),a=this.multiple&&this.getChangedTransform(()=>n.safeChange(()=>n.rotateOf(t,e))),h=new Fu(Fu.ROTATE,{target:n,editor:this,worldOrigin:o,rotation:e,transform:a});this.editTool.onRotate(h),this.emitEvent(h)}skewOf(t,e,n=0,o){if(!this.checkTransform("skewable"))return;const{element:a}=this,h=this.getWorldOrigin(t),u=this.multiple&&this.getChangedTransform(()=>a.safeChange(()=>a.skewOf(t,e,n))),d=new $u($u.SKEW,{target:a,editor:this,worldOrigin:h,skewX:e,skewY:n,transform:u});this.editTool.onSkew(d),this.emitEvent(d)}checkTransform(t){return this.element&&!this.element.locked&&this.mergeConfig[t]}getWorldOrigin(t){return this.element.getWorldPoint(Ne.getInnerOrigin(this.element,t))}getChangedTransform(t){const{element:e}=this;if(this.multiple&&!e.canChange)return e.changedTransform;const n=new ze(e.worldTransform);return t(),new ze(e.worldTransform).divide(n)}group(t){return this.multiple&&(this.target=Ra.group(this.list,this.element,t),this.emitGroupEvent(Si.GROUP,this.target)),this.target}ungroup(){const{list:t}=this;return t.length&&(t.forEach(e=>e.isBranch&&this.emitGroupEvent(Si.BEFORE_UNGROUP,e)),this.target=Ra.ungroup(t),t.forEach(e=>e.isBranch&&this.emitGroupEvent(Si.UNGROUP,e))),this.list}openGroup(t){this.openedGroupList.add(t),t.hitChildren=!0,this.emitGroupEvent(Si.OPEN,t)}closeGroup(t){this.openedGroupList.remove(t),t.hitChildren=!1,this.emitGroupEvent(Si.CLOSE,t)}checkOpenedGroups(){const t=this.openedGroupList;if(t.length){let{list:e}=t;this.editing&&(e=[],t.forEach(n=>this.list.every(o=>!Ne.hasParent(o,n))&&e.push(n))),e.forEach(n=>this.closeGroup(n))}this.editing&&!this.selector.dragging&&this.checkDeepSelect()}checkDeepSelect(){let t,{list:e}=this;for(let n=0;n<e.length;n++)for(t=e[n].parent;t&&!t.hitChildren;)this.openGroup(t),t=t.parent}emitGroupEvent(t,e){const n=new Si(t,{editTarget:e});this.emitEvent(n),e.emitEvent(n)}openInnerEditor(t,e){if(t&&e&&(this.target=t),this.single){const n=t||this.element,o=n.editInner;o&&pr.list[o]&&(this.editTool.unload(),this.innerEditing=!0,this.innerEditor=this.editToolList[o]||pr.get(o,this),this.innerEditor.editTarget=n,this.emitInnerEvent(fn.BEFORE_OPEN),this.innerEditor.load(),this.emitInnerEvent(fn.OPEN))}}closeInnerEditor(){this.innerEditing&&(this.innerEditing=!1,this.emitInnerEvent(fn.BEFORE_CLOSE),this.innerEditor.unload(),this.emitInnerEvent(fn.CLOSE),this.editTool.load(),this.innerEditor=null)}emitInnerEvent(t){const{innerEditor:e}=this,{editTarget:n}=e,o=new fn(t,{editTarget:n,innerEditor:e});this.emitEvent(o),n.emitEvent(o)}lock(){this.list.forEach(t=>t.locked=!0),this.update()}unlock(){this.list.forEach(t=>t.locked=!1),this.update()}toTop(){this.list.length&&(Ra.toTop(this.list),this.leafList.update())}toBottom(){this.list.length&&(Ra.toBottom(this.list),this.leafList.update())}listenTargetEvents(){if(!this.targetEventIds.length){const{app:t,leafer:e}=this;this.targetEventIds=[e.on_(St.START,this.update,this),t.on_(St.CHILD_START,this.forceRender,this),t.on_(ae.BEFORE_MOVE,this.onMove,this,!0),t.on_($e.BEFORE_ZOOM,this.onScale,this,!0),t.on_(fi.BEFORE_ROTATE,this.onRotate,this,!0),t.on_([Bi.HOLD,Bi.UP],n=>{Hu(this,n)}),t.on_(Bi.DOWN,this.editBox.onArrow,this.editBox)]}}removeTargetEvents(){const{targetEventIds:t}=this;t.length&&(this.off_(t),t.length=0)}destroy(){this.destroyed||(this.target=this.hoverTarget=null,Object.values(this.editToolList).forEach(t=>t.destroy()),this.simulateTarget.destroy(),this.editToolList={},this.simulateTarget=this.editTool=this.innerEditor=null,super.destroy())}}mo([oc(DL)],hc.prototype,"hoverTarget",void 0);mo([oc(IL)],hc.prototype,"target",void 0);class zL{static registerInnerEditor(){pr.register(this)}get tag(){return"InnerEditor"}get editBox(){return this.editor.editBox}constructor(t){this.editor=t,this.create()}onCreate(){}create(){this.view=new de,this.onCreate()}onLoad(){}load(){const{editor:t}=this;t&&(t.app&&(t.selector.hittable=t.app.tree.hitChildren=!1),this.onLoad())}onUpdate(){}update(){this.onUpdate()}onUnload(){}unload(){const{editor:t}=this;t&&(t.app&&(t.selector.hittable=t.app.tree.hitChildren=!0),this.onUnload())}onDestroy(){}destroy(){this.onDestroy(),this.editor&&(this.view&&this.view.destroy(),this.eventIds&&this.editor.off_(this.eventIds),this.editor=this.view=this.eventIds=null)}}let Nu=class extends zL{static registerEditTool(){pr.register(this)}get tag(){return"EditTool"}onMove(t){const{moveX:e,moveY:n,editor:o}=t,{app:a,list:h}=o;a.lockLayout(),h.forEach(u=>{u.moveWorld(e,n)}),a.unlockLayout()}onScale(t){const{scaleX:e,scaleY:n,transform:o,worldOrigin:a,editor:h}=t,{app:u,list:d}=h;u.lockLayout(),d.forEach(f=>{const y=h.getEditSize(f)!=="scale";o?f.transformWorld(o,y):f.scaleOfWorld(a,e,n,y)}),u.unlockLayout()}onRotate(t){const{rotation:e,transform:n,worldOrigin:o,editor:a}=t,{app:h,list:u}=a;h.lockLayout(),u.forEach(d=>{const f=a.getEditSize(d)!=="scale";n?d.transformWorld(n,f):d.rotateOfWorld(o,e)}),h.unlockLayout()}onSkew(t){const{skewX:e,skewY:n,transform:o,worldOrigin:a,editor:h}=t,{app:u,list:d}=h;u.lockLayout(),d.forEach(f=>{const y=h.getEditSize(f)!=="scale";o?f.transformWorld(o,y):f.skewOfWorld(a,e,n,y)}),u.unlockLayout()}load(){this.editBox.view.visible=!0,this.onLoad()}update(){const{editor:t,editBox:e}=this,{x:n,y:o,scaleX:a,scaleY:h,rotation:u,skewX:d,skewY:f,width:y,height:x}=t.element.getLayoutBounds("box",t,!0);e.set({x:n,y:o,scaleX:a,scaleY:h,rotation:u,skewX:d,skewY:f}),e.update({x:0,y:0,width:y,height:x}),this.onUpdate()}unload(){this.editBox.view.visible=!1,this.onUnload()}};Nu=mo([Yg()],Nu);const{left:mp,right:HL}=as,{move:La,copy:ka,toNumberPoints:NL}=rt;let wp=class extends Nu{constructor(){super(...arguments),this.scaleOfEvent=!0}get tag(){return"LineEditTool"}onScaleWithDrag(t){const{drag:e,direction:n,lockRatio:o,around:a}=t,h=t.target,u=n===mp;if(h.pathInputed){const{path:d}=h.__,{from:f,to:y}=this.getFromToByPath(d);this.dragPoint(f,y,u,a,this.getInnerMove(h,e,o)),d[1]=f.x,d[2]=f.y,d[4]=y.x,d[5]=y.y,h.path=d}else if(h.points){const{points:d}=h,{from:f,to:y}=this.getFromToByPoints(d);this.dragPoint(f,y,u,a,this.getInnerMove(h,e,o)),d[0]=f.x,d[1]=f.y,d[2]=y.x,d[3]=y.y,h.points=d}else{const d=Zu(),{toPoint:f}=h;h.rotation=0,this.dragPoint(d,f,u,a,this.getInnerMove(h,e,o)),h.getLocalPointByInner(d,null,null,!0),h.getLocalPointByInner(f,null,null,!0),h.x=d.x,h.y=d.y,h.getInnerPointByLocal(f,null,null,!0),h.toPoint=f}}getInnerMove(t,e,n){const o=e.getInnerMove(t);return n&&(Math.abs(o.x)>Math.abs(o.y)?o.y=0:o.x=0),o}getFromToByPath(t){return{from:{x:t[1],y:t[2]},to:{x:t[4],y:t[5]}}}getFromToByPoints(t){const e=NL(t);return{from:{x:e[0],y:e[1]},to:{x:e[2],y:e[3]}}}dragPoint(t,e,n,o,a){const{x:h,y:u}=a;n?(La(t,h,u),o&&La(e,-h,-u)):(o&&La(t,-h,-u),La(e,h,u))}onSkew(t){}onUpdate(){const{editBox:t}=this,{rotatePoints:e,resizeLines:n,resizePoints:o,rect:a}=t,h=this.editor.element;let u,d;if(h.pathInputed?u=this.getFromToByPath(h.__.path):h.points&&(u=this.getFromToByPoints(h.__.points)),u){const{from:f,to:y}=u;h.innerToWorld(f,f,!1,t),h.innerToWorld(y,y,!1,t),a.pen.clearPath().moveTo(f.x,f.y).lineTo(y.x,y.y),ka(o[7],f),ka(e[7],f),ka(o[3],y),ka(e[3],y)}for(let f=0;f<8;f++)f<4&&(n[f].visible=!1),d=f===mp||f===HL,o[f].visible=d,e[f].visible=u?!1:d}};wp=mo([Yg()],wp);qt.editor=function(i){return new hc(i)};qe(z.prototype,"editOuter",{get(){return this.__.__isLinePath?"LineEditTool":"EditTool"}});qe(z.prototype,"editInner",{get(){return"PathEditor"}});qe(Bt.prototype,"editInner",{get(){return"TextEditor"}});z.setEditConfig=function(i){qe(this.prototype,"editConfig",{get(){return typeof i=="function"?i(this):i}})};z.setEditOuter=function(i){qe(this.prototype,"editOuter",{get(){return typeof i=="string"?i:i(this)}})};z.setEditInner=function(i){qe(this.prototype,"editInner",{get(){return typeof i=="string"?i:i(this)}})};const xp=Tt.get("LeaferCanvas");class Xg extends ju{set zIndex(t){const{style:e}=this.view;e.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:e,parentView:n}=this;if(e&&n){const o=n.children[t];o?(this.setAbsolute(o),n.insertBefore(e,o)):n.appendChild(o)}}init(){const{config:t}=this,e=t.view||t.canvas;e?this.__createViewFrom(e):this.__createView();const{style:n}=this.view;if(n.display||(n.display="block"),this.parentView=this.view.parentElement,this.parentView){const o=this.parentView.style;o.webkitUserSelect=o.userSelect="none"}V.syncDomFont&&!this.parentView&&(n.display="none",document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(t)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return this.view.style.pointerEvents!=="none"}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let e=typeof t=="string"?document.getElementById(t):t;if(e)if(e instanceof HTMLCanvasElement)this.view=e;else{let n=e;if(e===window||e===document){const a=document.createElement("div"),{style:h}=a;h.position="absolute",h.top=h.bottom=h.left=h.right="0px",document.body.appendChild(a),n=a}this.__createView();const o=this.view;n.hasChildNodes()&&(this.setAbsolute(o),n.style.position||(n.style.position="relative")),n.appendChild(o)}else xp.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:e}=t;e.position="absolute",e.top=e.left="0px"}updateViewSize(){const{width:t,height:e,pixelRatio:n}=this,{style:o}=this.view;o.width=t+"px",o.height=e+"px",this.view.width=Math.ceil(t*n),this.view.height=Math.ceil(e*n)}updateClientBounds(){this.clientBounds=this.view.getBoundingClientRect()}startAutoLayout(t,e){if(this.resizeListener=e,t){this.autoBounds=t;try{this.resizeObserver=new ResizeObserver(o=>{this.updateClientBounds();for(const a of o)this.checkAutoBounds(a.contentRect)});const n=this.parentView;n?(this.resizeObserver.observe(n),this.checkAutoBounds(n.getBoundingClientRect())):(this.checkAutoBounds(this.view),xp.warn("no parent"))}catch{this.imitateResizeObserver()}}else window.addEventListener("resize",()=>{const n=V.devicePixelRatio;if(this.pixelRatio!==n){const{width:o,height:a}=this;this.emitResize({width:o,height:a,pixelRatio:n})}})}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),V.requestRender(this.imitateResizeObserver.bind(this)))}checkAutoBounds(t){const e=this.view,{x:n,y:o,width:a,height:h}=this.autoBounds.getBoundsFrom(t),u={width:a,height:h,pixelRatio:V.devicePixelRatio};if(!this.isSameSize(u)){const{style:d}=e;d.marginLeft=n+"px",d.marginTop=o+"px",this.emitResize(u)}}stopAutoLayout(){this.autoLayout=!1,this.resizeListener=null,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}emitResize(t){const e={};ie.copyAttrs(e,this,Ni),this.resize(t),this.resizeListener&&this.width!==void 0&&this.resizeListener(new yn(t,e))}unrealCanvas(){if(!this.unreal&&this.parentView){const t=this.view;t&&t.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),!this.unreal){const t=this.view;t.parentElement&&t.remove()}super.destroy()}}}xg(CanvasRenderingContext2D.prototype);xg(Path2D.prototype);const{mineType:du,fileType:UL}=_n;Object.assign(qt,{canvas:(i,t)=>new Xg(i,t),image:i=>new bg(i)});function GL(i,t){V.origin={createCanvas(e,n){const o=document.createElement("canvas");return o.width=e,o.height=n,o},canvasToDataURL:(e,n,o)=>e.toDataURL(du(n),o),canvasToBolb:(e,n,o)=>new Promise(a=>e.toBlob(a,du(n),o)),canvasSaveAs:(e,n,o)=>{const a=e.toDataURL(du(UL(n)),o);return V.origin.download(a,n)},download(e,n){return new Promise(o=>{let a=document.createElement("a");a.href=e,a.download=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),o()})},loadImage(e){return new Promise((n,o)=>{const a=new Image,{crossOrigin:h}=V.image;h&&(a.setAttribute("crossOrigin",h),a.crossOrigin=h),a.onload=()=>{n(a)},a.onerror=u=>{o(u)},a.src=V.image.getRealURL(e)})}},V.event={stopDefault(e){e.preventDefault()},stopNow(e){e.stopImmediatePropagation()},stop(e){e.stopPropagation()}},V.canvas=qt.canvas(),V.conicGradientSupport=!!V.canvas.context.createConicGradient}V.name="web";V.isMobile="ontouchstart"in window;V.requestRender=function(i){window.requestAnimationFrame(i)};qe(V,"devicePixelRatio",{get(){return Math.max(1,devicePixelRatio)}});const{userAgent:ss}=navigator;ss.indexOf("Firefox")>-1?(V.conicGradientRotate90=!0,V.intWheelDeltaY=!0,V.syncDomFont=!0):ss.indexOf("Safari")>-1&&ss.indexOf("Chrome")===-1&&(V.fullImageShadow=!0);ss.indexOf("Windows")>-1?(V.os="Windows",V.intWheelDeltaY=!0):ss.indexOf("Mac")>-1?V.os="Mac":ss.indexOf("Linux")>-1&&(V.os="Linux");class VL{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){const t=new Pt;return this.__updatedList.list.forEach(e=>{e.leafer&&t.add(e)}),t}else return this.__updatedList}constructor(t,e){this.totalTimes=0,this.config={},this.__updatedList=new Pt,this.target=t,e&&(this.config=ie.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(St.REQUEST)}__onAttrChange(t){this.__updatedList.add(t.target),this.update()}__onChildEvent(t){t.type===Jt.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent)),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:e}=t;for(let n=0,o=e.length;n<o;n++)this.__pushChild(e[n])}__onRquestData(){this.target.emitEvent(new Nn(Nn.DATA,{updatedList:this.updatedList})),this.__updatedList=new Pt,this.totalTimes++,this.changed=!1,this.hasVisible=!1,this.hasRemove=!1,this.hasAdd=!1}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Gi.CHANGE,this.__onAttrChange,this),t.on_([Jt.ADD,Jt.REMOVE],this.__onChildEvent,this),t.on_(Nn.REQUEST,this.__onRquestData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=null,this.__updatedList=null)}}const{updateAllMatrix:YL,updateBounds:bp,updateAllWorldOpacity:XL}=Ne,{pushAllChildBranch:ZL,pushAllParent:Ep}=po;function KL(i,t){let e;i.list.forEach(n=>{e=n.__layout,t.without(n)&&!e.proxyZoom&&(e.matrixChanged?(YL(n,!0),t.add(n),n.isBranch&&ZL(n,t),Ep(n,t)):e.boundsChanged&&(t.add(n),n.isBranch&&(n.__tempNumber=0),Ep(n,t)))})}function jL(i){let t,e,n;i.sort(!0),i.levels.forEach(o=>{t=i.levelMap[o];for(let a=0,h=t.length;a<h;a++){if(e=t[a],e.isBranch&&e.__tempNumber){n=e.children;for(let u=0,d=n.length;u<d;u++)n[u].isBranch||bp(n[u])}bp(e)}})}function qL(i){let t;i.list.forEach(e=>{t=e.__layout,t.opacityChanged&&XL(e),t.stateStyleChanged&&setTimeout(()=>t.stateStyleChanged&&e.updateState()),e.__updateChange()})}const{worldBounds:Cp}=Ka,JL={x:0,y:0,width:1e5,height:1e5};class Sp{constructor(t){this.updatedBounds=new zt,this.beforeBounds=new zt,this.afterBounds=new zt,t instanceof Array&&(t=new Pt(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,Cp)}setAfter(){const{list:t}=this.updatedList;t.some(e=>e.noBounds)?this.afterBounds.set(JL):this.afterBounds.setListWithFn(t,Cp),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:QL,updateAllChange:tk}=Ne,fu=Tt.get("Layouter");class eh{constructor(t,e){this.totalTimes=0,this.config={},this.__levelList=new HT,this.target=t,e&&(this.config=ie.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(!this.running)return;const{target:t}=this;this.times=0;try{t.emit(Ct.START),this.layoutOnce(),t.emitEvent(new Ct(Ct.END,this.layoutedBlocks,this.times))}catch(e){fu.error(e)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){if(this.layouting)return fu.warn("layouting");if(this.times>3)return fu.warn("layout max times");this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(Nn.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())}partLayout(){var t;if(!(!((t=this.__updatedList)===null||t===void 0)&&t.length))return;const e=Li.start("PartLayout"),{target:n,__updatedList:o}=this,{BEFORE:a,LAYOUT:h,AFTER:u}=Ct,d=this.getBlocks(o);d.forEach(f=>f.setBefore()),n.emitEvent(new Ct(a,d,this.times)),this.extraBlock=null,o.sort(),KL(o,this.__levelList),jL(this.__levelList),qL(o),this.extraBlock&&d.push(this.extraBlock),d.forEach(f=>f.setAfter()),n.emitEvent(new Ct(h,d,this.times)),n.emitEvent(new Ct(u,d,this.times)),this.addBlocks(d),this.__levelList.reset(),this.__updatedList=null,Li.end(e)}fullLayout(){const t=Li.start("FullLayout"),{target:e}=this,{BEFORE:n,LAYOUT:o,AFTER:a}=Ct,h=this.getBlocks(new Pt(e));e.emitEvent(new Ct(n,h,this.times)),eh.fullLayout(e),h.forEach(u=>{u.setAfter()}),e.emitEvent(new Ct(o,h,this.times)),e.emitEvent(new Ct(a,h,this.times)),this.addBlocks(h),Li.end(t)}static fullLayout(t){QL(t,!0),t.isBranch?po.updateBounds(t):Ne.updateBounds(t),tk(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:e,beforeBounds:n}=this.extraBlock||(this.extraBlock=new Sp([]));e.length?n.add(t.__world):n.set(t.__world),e.add(t)}}createBlock(t){return new Sp(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Ct.REQUEST,this.layout,this),t.on_(Ct.AGAIN,this.layoutAgain,this),t.on_(Nn.DATA,this.__onReceiveWatchData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const ar=Tt.get("Renderer");class ek{get needFill(){return!!(!this.canvas.allowBackgroundColor&&this.config.fill)}constructor(t,e,n){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:60},this.target=t,this.canvas=e,n&&(this.config=ie.default(n,this.config)),this.__listenEvents(),this.__requestRender()}start(){this.running=!0}stop(){this.running=!1}update(){this.changed=!0}requestLayout(){this.target.emit(Ct.REQUEST)}render(t){if(!(this.running&&this.canvas.view)){this.changed=!0;return}const{target:e}=this;this.times=0,this.totalBounds=new zt,ar.log(e.innerName,"--->");try{e.app.emit(St.CHILD_START,e),this.emitRender(St.START),this.renderOnce(t),this.emitRender(St.END,this.totalBounds),He.clearRecycled()}catch(n){this.rendering=!1,ar.error(n)}ar.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return ar.warn("rendering");if(this.times>3)return ar.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new zt,this.renderOptions={},t)this.emitRender(St.BEFORE),t();else{if(this.requestLayout(),this.ignore){this.ignore=this.rendering=!1;return}this.emitRender(St.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(St.RENDER,this.renderBounds,this.renderOptions),this.emitRender(St.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:e}=this;if(!e)return ar.warn("PartRender: need update attr");this.mergeBlocks(),e.forEach(n=>{t.bounds.hit(n)&&!n.isEmpty()&&this.clipRender(n)})}clipRender(t){const e=Li.start("PartRender"),{canvas:n}=this,o=t.getIntersect(n.bounds),a=t.includes(this.target.__world),h=new zt(o);n.save(),a&&!Tt.showRepaint?n.clear():(o.spread(10+1/this.canvas.pixelRatio).ceil(),n.clearWorld(o,!0),n.clipWorld(o,!0)),this.__render(o,a,h),n.restore(),Li.end(e)}fullRender(){const t=Li.start("FullRender"),{canvas:e}=this;e.save(),e.clear(),this.__render(e.bounds,!0),e.restore(),Li.end(t)}__render(t,e,n){const o=t.includes(this.target.__world)?{includes:e}:{bounds:t,includes:e};this.needFill&&this.canvas.fillWorld(t,this.config.fill),Tt.showRepaint&&this.canvas.strokeWorld(t,"red"),this.target.__render(this.canvas,o),this.renderBounds=n=n||t,this.renderOptions=o,this.totalBounds.isEmpty()?this.totalBounds=n:this.totalBounds.add(n),Tt.showHitView&&this.renderHitView(o),Tt.showBoundsView&&this.renderBoundsView(o),this.canvas.updateRender(n)}renderHitView(t){}renderBoundsView(t){}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const e=new zt;e.setList(t),t.length=0,t.push(e)}}__requestRender(){const t=Date.now();V.requestRender(()=>{this.FPS=Math.min(60,Math.ceil(1e3/(Date.now()-t))),this.running&&(this.changed&&this.canvas.view&&this.render(),this.target.emit(St.NEXT)),this.target&&this.__requestRender()})}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:e,height:n}=t.old;if(!new zt(0,0,e,n).includes(this.target.__world)||this.needFill||!t.samePixelRatio){this.addBlock(this.canvas.bounds),this.target.forceUpdate("surface");return}}this.addBlock(new zt(0,0,1,1)),this.changed=!0}}__onLayoutEnd(t){t.data&&t.data.map(e=>{let n;e.updatedList&&e.updatedList.list.some(o=>(n=!o.__world.width||!o.__world.height,n&&(o.isLeafer||ar.tip(o.innerName,": empty"),n=!o.isBranch||o.isBranchLeaf),n)),this.addBlock(n?this.canvas.bounds:e.updatedBounds)})}emitRender(t,e,n){this.target.emitEvent(new St(t,this.times,e,n))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(St.REQUEST,this.update,this),t.on_(Ct.END,this.__onLayoutEnd,this),t.on_(St.AGAIN,this.renderAgain,this),t.on_(yn.RESIZE,this.__onResize,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.canvas=this.config=null)}}const{hitRadiusPoint:ik}=q;class nk{constructor(t,e){this.target=t,this.selector=e}getByPoint(t,e,n){e||(e=0),n||(n={});const o=n.through||!1,a=n.ignoreHittable||!1,h=n.target||this.target;this.exclude=n.exclude||null,this.point={x:t.x,y:t.y,radiusX:e,radiusY:e},this.findList=new Pt(n.findList),n.findList||this.hitBranch(h);const{list:u}=this.findList,d=this.getBestMatchLeaf(u,n.bottomList,a),f=a?this.getPath(d):this.getHitablePath(d);return this.clear(),o?{path:f,target:d,throughPath:u.length?this.getThroughPath(u):f}:{path:f,target:d}}getBestMatchLeaf(t,e,n){if(t.length){let o;this.findList=new Pt;const{x:a,y:h}=this.point,u={x:a,y:h,radiusX:0,radiusY:0};for(let d=0,f=t.length;d<f;d++)if(o=t[d],(n||Ne.worldHittable(o))&&(this.hitChild(o,u),this.findList.length))return this.findList.list[0]}if(e){for(let o=0,a=e.length;o<a;o++)if(this.hitChild(e[o].target,this.point,e[o].proxy),this.findList.length)return this.findList.list[0]}return t[0]}getPath(t){const e=new Pt;for(;t;)e.add(t),t=t.parent;return this.target&&e.add(this.target),e}getHitablePath(t){const e=this.getPath(t&&t.hittable?t:null);let n,o=new Pt;for(let a=e.list.length-1;a>-1&&(n=e.list[a],!(!n.__.hittable||(o.addAt(n,0),!n.__.hitChildren)));a--);return o}getThroughPath(t){const e=new Pt,n=[];for(let u=t.length-1;u>-1;u--)n.push(this.getPath(t[u]));let o,a,h;for(let u=0,d=n.length;u<d;u++){o=n[u],a=n[u+1];for(let f=0,y=o.length;f<y&&(h=o.list[f],!(a&&a.has(h)));f++)e.add(h)}return e}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,e){let n,o;const{point:a}=this,h=t.length;for(let u=h-1;u>-1;u--)n=t[u],!(!n.__.visible||e&&!n.__.mask)&&(o=n.__.hitRadius?!0:ik(n.__world,a),n.isBranch?(o||n.__ignoreHitWorld)&&(this.eachFind(n.children,n.__onlyHitMask),n.isBranchLeaf&&this.hitChild(n,a)):o&&this.hitChild(n,a))}hitChild(t,e,n){if(!(this.exclude&&this.exclude.has(t))&&t.__hitWorld(e)){const{parent:o}=t;if(o&&o.__hasMask&&!t.__.mask&&!o.children.some(a=>a.__.mask&&a.__hitWorld(e)))return;this.findList.add(n||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}}const{Yes:rk,NoAndSkip:sk,YesAndSkip:ok}=za,Tp={},Rp={},Lp={};class ak{constructor(t,e){this.config={},this.innerIdMap={},this.idMap={},this.methods={id:(n,o)=>n.id===o?(this.target&&(this.idMap[o]=n),1):0,innerId:(n,o)=>n.innerId===o?(this.target&&(this.innerIdMap[o]=n),1):0,className:(n,o)=>n.className===o?1:0,tag:(n,o)=>n.__tag===o?1:0,tags:(n,o)=>o[n.__tag]?1:0},this.target=t,e&&(this.config=ie.default(e,this.config)),this.picker=new nk(t,this),t&&this.__listenEvents()}getBy(t,e,n,o){switch(typeof t){case"number":const a=this.getByInnerId(t,e);return n?a:a?[a]:[];case"string":switch(t[0]){case"#":Tp.id=t.substring(1),t=Tp;break;case".":Rp.className=t.substring(1),t=Rp;break;default:Lp.tag=t,t=Lp}case"object":if(t.id!==void 0){const h=this.getById(t.id,e);return n?h:h?[h]:[]}else if(t.tag){const{tag:h}=t,u=h instanceof Array;return this.getByMethod(u?this.methods.tags:this.methods.tag,e,n,u?ie.toMap(h):h)}else return this.getByMethod(this.methods.className,e,n,t.className);case"function":return this.getByMethod(t,e,n,o)}}getByPoint(t,e,n){return V.name==="node"&&this.target&&this.target.emit(Ct.CHECK_UPDATE),this.picker.getByPoint(t,e,n)}getByInnerId(t,e){const n=this.innerIdMap[t];return n||(this.eachFind(this.toChildren(e),this.methods.innerId,null,t),this.findLeaf)}getById(t,e){const n=this.idMap[t];return n&&Ne.hasParent(n,e||this.target)?n:(this.eachFind(this.toChildren(e),this.methods.id,null,t),this.findLeaf)}getByClassName(t,e){return this.getByMethod(this.methods.className,e,!1,t)}getByTag(t,e){return this.getByMethod(this.methods.tag,e,!1,t)}getByMethod(t,e,n,o){const a=n?null:[];return this.eachFind(this.toChildren(e),t,a,o),a||this.findLeaf}eachFind(t,e,n,o){let a,h;for(let u=0,d=t.length;u<d;u++){if(a=t[u],h=e(a,o),h===rk||h===ok)if(n)n.push(a);else{this.findLeaf=a;return}a.isBranch&&h<sk&&this.eachFind(a.children,e,n,o)}}toChildren(t){return this.findLeaf=null,[t||this.target]}__onRemoveChild(t){const{id:e,innerId:n}=t.child;this.idMap[e]&&delete this.idMap[e],this.innerIdMap[n]&&delete this.innerIdMap[n]}__checkIdChange(t){if(t.attrName==="id"){const e=t.oldValue;this.idMap[e]&&delete this.idMap[e]}}__listenEvents(){this.__eventIds=[this.target.on_(Jt.REMOVE,this.__onRemoveChild,this),this.target.on_(Gi.CHANGE,this.__checkIdChange,this)]}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}destroy(){this.__eventIds.length&&(this.__removeListenEvents(),this.picker.destroy(),this.findLeaf=null,this.innerIdMap={},this.idMap={})}}Object.assign(qt,{watcher:(i,t)=>new VL(i,t),layouter:(i,t)=>new eh(i,t),renderer:(i,t,e)=>new ek(i,t,e),selector:(i,t)=>new ak(i,t)});V.layout=eh.fullLayout;const We={convert(i,t){const e=Oi.getBase(i),n=Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:i.width,height:i.height,pointerType:i.pointerType,pressure:i.pressure});return n.pointerType==="pen"&&(n.tangentialPressure=i.tangentialPressure,n.tiltX=i.tiltX,n.tiltY=i.tiltY,n.twist=i.twist),n},convertMouse(i,t){const e=Oi.getBase(i);return Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(i,t){const e=We.getTouch(i),n=Oi.getBase(i);return Object.assign(Object.assign({},n),{x:t.x,y:t.y,width:1,height:1,pointerType:"touch",multiTouch:i.touches.length>1,pressure:e.force})},getTouch(i){return i.targetTouches[0]||i.changedTouches[0]}},kp={getMove(i,t){let{moveSpeed:e}=t,{deltaX:n,deltaY:o}=i;return i.shiftKey&&!n&&(n=o,o=0),n>50&&(n=Math.max(50,n/3)),o>50&&(o=Math.max(50,o/3)),{x:-n*e*2,y:-o*e*2}},getScale(i,t){let e,n=1,{zoomMode:o,zoomSpeed:a}=t;const h=i.deltaY||i.deltaX;if(o?(e=o==="mouse"?!0:!i.deltaX&&(V.intWheelDeltaY?Math.abs(h)>17:Math.ceil(h)!==h),(i.shiftKey||i.metaKey||i.ctrlKey)&&(e=!0)):e=!i.shiftKey&&(i.metaKey||i.ctrlKey),e){a=fe.within(a,0,1);const u=i.deltaY?t.delta.y:t.delta.x;n=1-h/(u*4)*a,n<.5&&(n=.5),n>=1.5&&(n=1.5)}return n}},Bp={convert(i){const t=Oi.getBase(i);return Object.assign(Object.assign({},t),{code:i.code,key:i.key})}},{getMoveEventData:hk,getZoomEventData:Op,getRotateEventData:lk,pathCanDrag:uk}=Oi;class ck extends jR{__listenEvents(){super.__listenEvents();const t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};const{viewEvents:e,windowEvents:n}=this;for(let o in e)e[o]=e[o].bind(this),t.addEventListener(o,e[o]);for(let o in n)n[o]=n[o].bind(this),window.addEventListener(o,n[o])}__removeListenEvents(){super.__removeListenEvents();const{viewEvents:t,windowEvents:e}=this;for(let n in t)this.view.removeEventListener(n,t[n]),this.viewEvents={};for(let n in e)window.removeEventListener(n,e[n]),this.windowEvents={}}getTouches(t){const e=[];for(let n=0,o=t.length;n<o;n++)e.push(t[n]);return e}preventDefaultPointer(t){const{pointer:e}=this.config;e.preventDefault&&t.preventDefault()}preventDefaultWheel(t){const{wheel:e}=this.config;e.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(Bp.convert(t))}onKeyUp(t){this.keyUp(Bp.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(We.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),!(this.config.pointer.touch||this.useMultiTouch)&&(this.usePointer||(this.usePointer=!0),this.pointerDown(We.convert(t,this.getLocal(t))))}onPointerMove(t){this.config.pointer.touch||this.useMultiTouch||this.preventWindowPointer(t)||(this.usePointer||(this.usePointer=!0),this.pointerMove(We.convert(t,this.getLocal(t,!0))))}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),!(this.config.pointer.touch||this.useMultiTouch||this.preventWindowPointer(t))&&this.pointerUp(We.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),!(this.useTouch||this.usePointer)&&this.pointerDown(We.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.useTouch||this.usePointer||this.preventWindowPointer(t)||this.pointerMove(We.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),!(this.useTouch||this.usePointer||this.preventWindowPointer(t))&&this.pointerUp(We.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.useTouch||this.usePointer||this.pointerCancel()}onTouchStart(t){const e=We.getTouch(t),n=this.getLocal(e,!0),{preventDefault:o}=this.config.touch;(o===!0||o==="auto"&&uk(this.findPath(n)))&&t.preventDefault(),this.multiTouchStart(t),!this.usePointer&&(this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0,this.pointerDown(We.convertTouch(t,n)))}onTouchMove(t){if(this.multiTouchMove(t),this.usePointer||this.preventWindowPointer(t))return;const e=We.getTouch(t);this.pointerMove(We.convertTouch(t,this.getLocal(e)))}onTouchEnd(t){if(this.multiTouchEnd(),this.usePointer||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);const e=We.getTouch(t);this.pointerUp(We.convertTouch(t,this.getLocal(e)))}onTouchCancel(){this.usePointer||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>1,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){const e=this.getTouches(t.touches),n=this.getKeepTouchList(this.touches,e);n.length>1&&(this.multiTouch(Oi.getBase(t),n),this.touches=e)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,e){let n;const o=[];return t.forEach(a=>{n=e.find(h=>h.identifier===a.identifier),n&&o.push({from:this.getLocal(a),to:this.getLocal(n)})}),o}getLocalTouchs(t){return t.map(e=>this.getLocal(e))}onWheel(t){this.preventDefaultWheel(t);const{wheel:e}=this.config;if(e.disabled)return;const n=e.getScale?e.getScale(t,e):kp.getScale(t,e),o=this.getLocal(t),a=Oi.getBase(t);n!==1?this.zoom(Op(o,n,a)):this.move(hk(o,e.getMove?e.getMove(t,e):kp.getMove(t,e),a))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);const e=this.getLocal(t),n=Oi.getBase(t),o=t.scale/this.lastGestureScale,a=t.rotation-this.lastGestureRotation;let{rotateSpeed:h}=this.config.wheel;h=fe.within(h,0,1),this.zoom(Op(e,o*o,n)),this.rotate(lk(e,a/Math.PI*180*(h/4+.1),n)),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);const e=[];this.eachCursor(t,e),typeof e[e.length-1]=="object"&&e.push("default"),this.canvas.view.style.cursor=e.map(n=>typeof n=="object"?`url(${n.url}) ${n.x||0} ${n.y||0}`:n).join(",")}eachCursor(t,e,n=0){if(n++,t instanceof Array)t.forEach(o=>this.eachCursor(o,e,n));else{const o=typeof t=="string"&&Dg.get(t);o&&n<2?this.eachCursor(o,e,n):e.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}}function os(i,t){let e;const{rows:n,decorationY:o,decorationHeight:a}=i.__.__textDrawData;for(let h=0,u=n.length;h<u;h++)e=n[h],e.text?t.fillText(e.text,e.x,e.y):e.data&&e.data.forEach(d=>{t.fillText(d.char,d.x,e.y)}),o&&t.fillRect(e.x,e.y+o,e.width,a)}function dk(i,t,e){e.fillStyle=i,t.__.__font?os(t,e):t.__.windingRule?e.fill(t.__.windingRule):e.fill()}function fk(i,t,e){let n;const{windingRule:o,__font:a}=t.__;for(let h=0,u=i.length;h<u;h++)n=i[h],!(n.image&&mr.checkImage(t,e,n,!a))&&n.style&&(e.fillStyle=n.style,n.transform?(e.save(),e.transform(n.transform),n.blendMode&&(e.blendMode=n.blendMode),a?os(t,e):o?e.fill(o):e.fill(),e.restore()):n.blendMode?(e.saveBlendMode(n.blendMode),a?os(t,e):o?e.fill(o):e.fill(),e.restoreBlendMode()):a?os(t,e):o?e.fill(o):e.fill())}function lc(i,t,e){const{strokeAlign:n}=t.__,o=typeof i!="string";switch(n){case"center":e.setStroke(o?void 0:i,t.__.strokeWidth,t.__),o?no(i,!0,t,e):ho(t,e);break;case"inside":Pp("inside",i,o,t,e);break;case"outside":Pp("outside",i,o,t,e);break}}function Pp(i,t,e,n,o){const{__strokeWidth:a,__font:h}=n.__,u=o.getSameCanvas(!0,!0);u.setStroke(e?void 0:t,a*2,n.__),u.font=h,e?no(t,!0,n,u):ho(n,u),u.blendMode=i==="outside"?"destination-out":"destination-in",os(n,u),u.blendMode="normal",n.__worldFlipped?o.copyWorldByReset(u,n.__nowWorld):o.copyWorldToInner(u,n.__nowWorld,n.__layout.renderBounds),u.recycle(n.__nowWorld)}function ho(i,t){let e;const{rows:n,decorationY:o,decorationHeight:a}=i.__.__textDrawData;for(let h=0,u=n.length;h<u;h++)e=n[h],e.text?t.strokeText(e.text,e.x,e.y):e.data&&e.data.forEach(d=>{t.strokeText(d.char,d.x,e.y)}),o&&t.strokeRect(e.x,e.y+o,e.width,a)}function no(i,t,e,n){let o;for(let a=0,h=i.length;a<h;a++)o=i[a],!(o.image&&mr.checkImage(e,n,o,!1))&&o.style&&(n.strokeStyle=o.style,o.blendMode?(n.saveBlendMode(o.blendMode),t?ho(e,n):n.stroke(),n.restoreBlendMode()):t?ho(e,n):n.stroke())}function _k(i,t,e){const n=t.__,{__strokeWidth:o,strokeAlign:a,__font:h}=n;if(o)if(h)lc(i,t,e);else switch(a){case"center":e.setStroke(i,o,n),e.stroke();break;case"inside":e.save(),e.setStroke(i,o*2,n),n.windingRule?e.clip(n.windingRule):e.clip(),e.stroke(),e.restore();break;case"outside":const u=e.getSameCanvas(!0,!0);u.setStroke(i,o*2,n),t.__drawRenderPath(u),u.stroke(),n.windingRule?u.clip(n.windingRule):u.clip(),u.clearWorld(t.__layout.renderBounds),t.__worldFlipped?e.copyWorldByReset(u,t.__nowWorld):e.copyWorldToInner(u,t.__nowWorld,t.__layout.renderBounds),u.recycle(t.__nowWorld);break}}function pk(i,t,e){const n=t.__,{__strokeWidth:o,strokeAlign:a,__font:h}=n;if(o)if(h)lc(i,t,e);else switch(a){case"center":e.setStroke(void 0,o,n),no(i,!1,t,e);break;case"inside":e.save(),e.setStroke(void 0,o*2,n),n.windingRule?e.clip(n.windingRule):e.clip(),no(i,!1,t,e),e.restore();break;case"outside":const{renderBounds:u}=t.__layout,d=e.getSameCanvas(!0,!0);t.__drawRenderPath(d),d.setStroke(void 0,o*2,n),no(i,!1,t,d),n.windingRule?d.clip(n.windingRule):d.clip(),d.clearWorld(u),t.__worldFlipped?e.copyWorldByReset(d,t.__nowWorld):e.copyWorldToInner(d,t.__nowWorld,u),d.recycle(t.__nowWorld);break}}const{getSpread:gk,getOuterOf:yk,getByMove:vk,getIntersectData:mk}=q;function wk(i,t,e){const n=t.getSameCanvas(),o=i.__nowWorld;let a,h,u,d,{scaleX:f,scaleY:y}=o;if(f<0&&(f=-f),y<0&&(y=-y),t.bounds.includes(o))d=n,a=u=o;else{const{renderShapeSpread:x}=i.__layout,E=mk(x?gk(t.bounds,f===y?x*f:[x*y,x*f]):t.bounds,o);h=t.bounds.getFitMatrix(E);let{a:m,d:S}=h;if(h.a<1&&(d=t.getSameCanvas(),i.__renderShape(d,e),f*=m,y*=S),u=yk(o,h),a=vk(u,-h.e,-h.f),e.matrix){const{matrix:B}=e;h.multiply(B),m*=B.scaleX,S*=B.scaleY}e=Object.assign(Object.assign({},e),{matrix:h.withScale(m,S)})}return i.__renderShape(n,e),{canvas:n,matrix:h,bounds:a,worldCanvas:d,shapeBounds:u,scaleX:f,scaleY:y}}let Uu;function xk(i,t){const e=t.__,n=[];let o=e.__input[i],a;o instanceof Array||(o=[o]),Uu=mr.recycleImage(i,e);for(let h=0,u=o.length,d;h<u;h++)d=bk(i,o[h],t),d&&n.push(d);e["_"+i]=n.length?n:void 0,n.length&&n[0].image&&(a=n[0].image.hasOpacityPixel),i==="fill"?e.__pixelFill=a:e.__pixelStroke=a}function bk(i,t,e){if(typeof t!="object"||t.visible===!1||t.opacity===0)return;const{boxBounds:n}=e.__layout;switch(t.type){case"solid":let{type:o,blendMode:a,color:h,opacity:u}=t;return{type:o,blendMode:a,style:vr.string(h,u)};case"image":return mr.image(e,i,t,n,!Uu||!Uu[t.url]);case"linear":return Ma.linearGradient(t,n);case"radial":return Ma.radialGradient(t,n);case"angular":return Ma.conicGradient(t,n);default:return t.r!==void 0?{type:"solid",style:vr.string(t)}:void 0}}const Ek={compute:xk,fill:dk,fills:fk,fillText:os,stroke:_k,strokes:pk,strokeText:lc,drawTextStroke:ho,shape:wk};let Xs={};const{get:uc,rotateOfOuter:Zg,translate:is,scaleOfOuter:Ck,scale:Kg,rotate:jg}=ot;function qg(i,t,e,n,o,a,h){const u=uc();is(u,t.x+e,t.y+n),Kg(u,o,a),h&&Zg(u,{x:t.x+t.width/2,y:t.y+t.height/2},h),i.transform=u}function Jg(i,t,e,n,o,a,h){const u=uc();is(u,t.x+e,t.y+n),o&&Kg(u,o,a),h&&jg(u,h),i.transform=u}function Qg(i,t,e,n,o,a,h,u,d,f){const y=uc();if(d)if(f==="center")Zg(y,{x:e/2,y:n/2},d);else switch(jg(y,d),d){case 90:is(y,n,0);break;case 180:is(y,e,n);break;case 270:is(y,0,e);break}Xs.x=t.x+o,Xs.y=t.y+a,is(y,Xs.x,Xs.y),h&&Ck(y,Xs,h,u),i.transform=y}const{get:Sk,translate:Tk}=ot,Rk=new zt,_u={},pu={};function ty(i,t,e,n){const{blendMode:o,sync:a}=e;o&&(i.blendMode=o),a&&(i.sync=a),i.data=ey(e,n,t)}function ey(i,t,e){let{width:n,height:o}=e;i.padding&&(t=Rk.set(t).shrink(i.padding)),i.mode==="strench"&&(i.mode="stretch");const{opacity:a,mode:h,align:u,offset:d,scale:f,size:y,rotation:x,repeat:E}=i,m=t.width===n&&t.height===o,S={mode:h},B=u!=="center"&&(x||0)%180===90,P=B?o:n,$=B?n:o;let I=0,F=0,L,T;if(!h||h==="cover"||h==="fit"){if(!m||x){const U=t.width/P,W=t.height/$;L=T=h==="fit"?Math.min(U,W):Math.max(U,W),I+=(t.width-n*L)/2,F+=(t.height-o*T)/2}}else(f||y)&&(fe.getScaleData(f,y,e,pu),L=pu.scaleX,T=pu.scaleY);if(u){const U={x:I,y:F,width:P,height:$};L&&(U.width*=L,U.height*=T),fE.toPoint(u,U,t,_u,!0),I+=_u.x,F+=_u.y}switch(d&&(I+=d.x,F+=d.y),h){case"stretch":m||(n=t.width,o=t.height);break;case"normal":case"clip":(I||F||L||x)&&Jg(S,t,I,F,L,T,x);break;case"repeat":(!m||L||x)&&Qg(S,t,n,o,I,F,L,T,x,u),E||(S.repeat="repeat");break;case"fit":case"cover":default:L&&qg(S,t,I,F,L,T,x)}return S.transform||(t.x||t.y)&&(S.transform=Sk(),Tk(S.transform,t.x,t.y)),L&&h!=="stretch"&&(S.scaleX=L,S.scaleY=T),S.width=n,S.height=o,a&&(S.opacity=a),E&&(S.repeat=typeof E=="string"?E==="x"?"repeat-x":"repeat-y":"repeat"),S}let Zs,Lk=new zt;const{isSame:kk}=q;function Bk(i,t,e,n,o){let a,h;const u=He.get(e);return Zs&&e===Zs.paint&&kk(n,Zs.boxBounds)?a=Zs.leafPaint:(a={type:e.type,image:u},Zs=u.use>1?{leafPaint:a,paint:e,boxBounds:Lk.set(n)}:null),(o||u.loading)&&(h={image:u,attrName:t,attrValue:e}),u.ready?(Ap(i,t,e,u,a,n),o&&(Mp(i,h),Ip(i,h))):u.error?o&&Dp(i,h,u.error):(o&&(gu(i,!0),Mp(i,h)),a.loadId=u.load(()=>{gu(i,!1),i.destroyed||(Ap(i,t,e,u,a,n)&&(u.hasOpacityPixel&&(i.__layout.hitCanvasChanged=!0),i.forceUpdate("surface")),Ip(i,h)),a.loadId=null},d=>{gu(i,!1),Dp(i,h,d),a.loadId=null})),a}function Ap(i,t,e,n,o,a){if(t==="fill"&&!i.__.__naturalWidth){const h=i.__;if(h.__naturalWidth=n.width/h.pixelRatio,h.__naturalHeight=n.height/h.pixelRatio,h.__autoSide)return i.forceUpdate("width"),i.__proxyData&&(i.setProxyAttr("width",h.width),i.setProxyAttr("height",h.height)),!1}return o.data||ty(o,n,e,a),!0}function Mp(i,t){cc(i,Vi.LOAD,t)}function Ip(i,t){cc(i,Vi.LOADED,t)}function Dp(i,t,e){t.error=e,i.forceUpdate("surface"),cc(i,Vi.ERROR,t)}function cc(i,t,e){i.hasEvent(t)&&i.emitEvent(new Vi(t,e))}function gu(i,t){const{leafer:e}=i;e&&e.viewReady&&(e.renderer.ignore=t)}const{get:Wp,scale:Fp,copy:$p}=ot,{ceil:zp,abs:Hp}=Math;function Gu(i,t,e){let{scaleX:n,scaleY:o}=He.patternLocked?i.__world:i.__nowWorld;const a=n+"-"+o+"-"+e;if(t.patternId!==a&&!i.destroyed){n=Hp(n),o=Hp(o);const{image:h,data:u}=t;let d,f,{width:y,height:x,scaleX:E,scaleY:m,opacity:S,transform:B,repeat:P}=u;E&&(f=Wp(),$p(f,B),Fp(f,1/E,1/m),n*=E,o*=m),n*=e,o*=e,y*=n,x*=o;const $=y*x;if(!P&&$>V.image.maxCacheSize)return!1;let I=V.image.maxPatternSize;if(!h.isSVG){const T=h.width*h.height;I>T&&(I=T)}$>I&&(d=Math.sqrt($/I)),d&&(n/=d,o/=d,y/=d,x/=d),E&&(n/=E,o/=m),(B||n!==1||o!==1)&&(f||(f=Wp(),B&&$p(f,B)),Fp(f,1/n,1/o));const F=h.getCanvas(zp(y)||1,zp(x)||1,S),L=h.getPattern(F,P||V.origin.noRepeat||"no-repeat",f,t);return t.style=L,t.patternId=a,!0}else return!1}function dc(i,t,e,n){function o(a){return a instanceof e?a:new e(function(h){h(a)})}return new(e||(e=Promise))(function(a,h){function u(y){try{f(n.next(y))}catch(x){h(x)}}function d(y){try{f(n.throw(y))}catch(x){h(x)}}function f(y){y.done?a(y.value):o(y.value).then(u,d)}f((n=n.apply(i,[])).next())})}const{abs:Np}=Math;function Ok(i,t,e,n){const{scaleX:o,scaleY:a}=He.patternLocked?i.__world:i.__nowWorld,{pixelRatio:h}=t;if(!e.data||e.patternId===o+"-"+a+"-"+h&&!rs.running)return!1;{const{data:u}=e;if(n)if(u.repeat)n=!1;else{let{width:d,height:f}=u;d*=Np(o)*h,f*=Np(a)*h,u.scaleX&&(d*=u.scaleX,f*=u.scaleY),n=d*f>V.image.maxCacheSize||rs.running}return n?(t.save(),i.windingRule?t.clip(i.windingRule):t.clip(),e.blendMode&&(t.blendMode=e.blendMode),u.opacity&&(t.opacity*=u.opacity),u.transform&&t.transform(u.transform),t.drawImage(e.image.view,0,0,u.width,u.height),t.restore(),!0):(!e.style||e.sync||rs.running?Gu(i,e,h):e.patternTask||(e.patternTask=He.patternTasker.add(()=>dc(this,void 0,void 0,function*(){e.patternTask=null,t.bounds.hit(i.__nowWorld)&&Gu(i,e,h),i.forceUpdate("surface")}),300)),!1)}}function Pk(i,t){const e=t["_"+i];if(e instanceof Array){let n,o,a,h;for(let u=0,d=e.length;u<d;u++)n=e[u].image,h=n&&n.url,h&&(o||(o={}),o[h]=!0,He.recycle(n),n.loading&&(a||(a=t.__input&&t.__input[i]||[],a instanceof Array||(a=[a])),n.unload(e[u].loadId,!a.some(f=>f.url===h))));return o}return null}const Ak={image:Bk,checkImage:Ok,createPattern:Gu,recycleImage:Pk,createData:ty,getPatternData:ey,fillOrFitMode:qg,clipMode:Jg,repeatMode:Qg},{toPoint:Up}=gn,yu={},vu={};function Mk(i,t){let{from:e,to:n,type:o,blendMode:a,opacity:h}=i;Up(e||"top",t,yu),Up(n||"bottom",t,vu);const u=V.canvas.createLinearGradient(yu.x,yu.y,vu.x,vu.y);fc(u,i.stops,h);const d={type:o,style:u};return a&&(d.blendMode=a),d}function fc(i,t,e){if(t){let n;for(let o=0,a=t.length;o<a;o++)n=t[o],typeof n=="string"?i.addColorStop(o/(a-1),vr.string(n,e)):i.addColorStop(n.offset,vr.string(n.color,e))}}const{getAngle:Ik,getDistance:Dk}=rt,{get:Wk,rotateOfOuter:Gp,scaleOfOuter:Vp}=ot,{toPoint:Yp}=gn,hr={},mu={};function Fk(i,t){let{from:e,to:n,type:o,opacity:a,blendMode:h,stretch:u}=i;Yp(e||"center",t,hr),Yp(n||"bottom",t,mu);const d=V.canvas.createRadialGradient(hr.x,hr.y,0,hr.x,hr.y,Dk(hr,mu));fc(d,i.stops,a);const f={type:o,style:d},y=_c(t,hr,mu,u,!0);return y&&(f.transform=y),h&&(f.blendMode=h),f}function _c(i,t,e,n,o){let a;const{width:h,height:u}=i;if(h!==u||n){const d=Ik(t,e);a=Wk(),o?(Vp(a,t,h/u*(n||1),1),Gp(a,t,d+90)):(Vp(a,t,1,h/u*(n||1)),Gp(a,t,d))}return a}const{getDistance:$k}=rt,{toPoint:Xp}=gn,cn={},wu={};function zk(i,t){let{from:e,to:n,type:o,opacity:a,blendMode:h,stretch:u}=i;Xp(e||"center",t,cn),Xp(n||"bottom",t,wu);const d=V.conicGradientSupport?V.canvas.createConicGradient(0,cn.x,cn.y):V.canvas.createRadialGradient(cn.x,cn.y,0,cn.x,cn.y,$k(cn,wu));fc(d,i.stops,a);const f={type:o,style:d},y=_c(t,cn,wu,u||1,V.conicGradientRotate90);return y&&(f.transform=y),h&&(f.blendMode=h),f}const Hk={linearGradient:Mk,radialGradient:Fk,conicGradient:zk,getTransform:_c},{copy:Zp,toOffsetOutBounds:Nk}=q,De={},Ba={};function Uk(i,t,e){let n,o;const{__nowWorld:a,__layout:h}=i,{shadow:u}=i.__,{worldCanvas:d,bounds:f,shapeBounds:y,scaleX:x,scaleY:E}=e,m=t.getSameCanvas(),S=u.length-1;Nk(f,Ba),u.forEach((B,P)=>{m.setWorldShadow(Ba.offsetX+B.x*x,Ba.offsetY+B.y*E,B.blur*x,B.color),o=B.spread?1+B.spread*2/(h.boxBounds.width+(h.strokeBoxSpread||0)*2):0,iy(m,Ba,o,e),n=f,B.box&&(m.restore(),m.save(),d&&(m.copyWorld(m,f,a,"copy"),n=a),d?m.copyWorld(d,a,a,"destination-out"):m.copyWorld(e.canvas,y,f,"destination-out")),i.__worldFlipped?t.copyWorldByReset(m,n,a,B.blendMode):t.copyWorldToInner(m,n,h.renderBounds,B.blendMode),S&&P<S&&m.clearWorld(n,!0)}),m.recycle(n)}function iy(i,t,e,n){const{bounds:o,shapeBounds:a}=n;if(V.fullImageShadow){if(Zp(De,i.bounds),De.x+=t.x-a.x,De.y+=t.y-a.y,e){const{matrix:h}=n;De.x-=(o.x+(h?h.e:0)+o.width/2)*(e-1),De.y-=(o.y+(h?h.f:0)+o.height/2)*(e-1),De.width*=e,De.height*=e}i.copyWorld(n.canvas,i.bounds,De)}else e&&(Zp(De,t),De.x-=t.width/2*(e-1),De.y-=t.height/2*(e-1),De.width*=e,De.height*=e),i.copyWorld(n.canvas,a,e?De:t)}const{toOffsetOutBounds:Gk}=q,Oa={};function Vk(i,t,e){let n,o;const{__nowWorld:a,__layout:h}=i,{innerShadow:u}=i.__,{worldCanvas:d,bounds:f,shapeBounds:y,scaleX:x,scaleY:E}=e,m=t.getSameCanvas(),S=u.length-1;Gk(f,Oa),u.forEach((B,P)=>{m.save(),m.setWorldShadow(Oa.offsetX+B.x*x,Oa.offsetY+B.y*E,B.blur*x),o=B.spread?1-B.spread*2/(h.boxBounds.width+(h.strokeBoxSpread||0)*2):0,iy(m,Oa,o,e),m.restore(),d?(m.copyWorld(m,f,a,"copy"),m.copyWorld(d,a,a,"source-out"),n=a):(m.copyWorld(e.canvas,y,f,"source-out"),n=f),m.fillWorld(n,B.color,"source-in"),i.__worldFlipped?t.copyWorldByReset(m,n,a,B.blendMode):t.copyWorldToInner(m,n,h.renderBounds,B.blendMode),S&&P<S&&m.clearWorld(n,!0)}),m.recycle(n)}function Yk(i,t,e){const{blur:n}=i.__;e.setWorldBlur(n*i.__nowWorld.a),e.copyWorldToInner(t,i.__nowWorld,i.__layout.renderBounds),e.filter="none"}function Xk(i,t,e){}const Zk={shadow:Uk,innerShadow:Vk,blur:Yk,backgroundBlur:Xk},{excludeRenderBounds:Kk}=Ka;de.prototype.__renderMask=function(i,t){let e,n,o,a,h;const{children:u}=this;for(let d=0,f=u.length;d<f;d++)e=u[d],!(e.__.mask&&(h&&(Kp(this,h,i,o,n,a),n=o=null),e.__.mask==="path"?(e.opacity<1?(h="opacity-path",a=e.opacity,o||(o=xu(i))):(h="path",i.save()),e.__clip(o||i,t)):(h="alpha",n||(n=xu(i)),o||(o=xu(i)),e.__render(n,t)),e.__.mask!=="clipping"))&&(Kk(e,t)||e.__render(o||i,t));Kp(this,h,i,o,n,a)};function Kp(i,t,e,n,o,a){switch(t){case"alpha":jk(i,e,n,o);break;case"opacity-path":ny(i,e,n,a);break;case"path":e.restore()}}function xu(i){return i.getSameCanvas(!1,!0)}function jk(i,t,e,n){const o=i.__nowWorld;e.resetTransform(),e.opacity=1,e.useMask(n,o),n.recycle(o),ny(i,t,e,1)}function ny(i,t,e,n){const o=i.__nowWorld;t.resetTransform(),t.opacity=n,t.copyWorld(e,o),e.recycle(o)}const qk="¥￥＄€£￡¢￠",Jk="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz",Qk="《（「〈『〖【〔｛┌＜‘“＝"+qk,tB="》）」〉』〗】〕｝┐＞’”！？，、。：；‰",eB="≮≯≈≠＝…",iB="—／～｜┆·",nB=`{[(<'"`+Qk,ry=`>)]}%!?,.:;'"`+tB,rB=ry+"_#~&*+\\=|"+eB,sB="- "+iB,oB=[[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]],aB=new RegExp(oB.map(([i,t])=>`[\\u${i.toString(16)}-\\u${t.toString(16)}]`).join("|"));function wo(i){const t={};return i.split("").forEach(e=>t[e]=!0),t}const hB=wo(Jk),lB=wo(nB),uB=wo(ry),cB=wo(rB),dB=wo(sB);var Ua;(function(i){i[i.Letter=0]="Letter",i[i.Single=1]="Single",i[i.Before=2]="Before",i[i.After=3]="After",i[i.Symbol=4]="Symbol",i[i.Break=5]="Break"})(Ua||(Ua={}));const{Letter:jp,Single:fB,Before:_B,After:pB,Symbol:gB,Break:yB}=Ua;function vB(i){return hB[i]?jp:dB[i]?yB:lB[i]?_B:uB[i]?pB:cB[i]?gB:aB.test(i)?fB:jp}const mB={trimRight(i){const{words:t}=i;let e=0,n=t.length,o;for(let a=n-1;a>-1&&(o=t[a].data[0],o.char===" ");a--)e++,i.width-=o.width;e&&t.splice(n-e,e)}};function wB(i,t,e){switch(t){case"title":return e?i.toUpperCase():i;case"upper":return i.toUpperCase();case"lower":return i.toLowerCase();default:return i}}const{trimRight:xB}=mB,{Letter:bu,Single:Ks,Before:qp,After:Eu,Symbol:bB,Break:Jp}=Ua;let ro,Hi,Be,Fe,Cu,Ei,dn,lo,fs,ci,Wn,Su,js,ns,uo,es=[],Da,Vu;function EB(i,t,e){uo=i,es=i.rows,Da=i.bounds,Vu=!Da.width&&!e.autoSizeAlign;const{__letterSpacing:n,paraIndent:o,textCase:a}=e,{canvas:h}=V,{width:u,height:d}=Da;if(u||d||n||a!=="none"){const y=e.textWrap!=="none",x=e.textWrap==="break";ns=!0,Wn=null,lo=dn=fs=Be=Fe=0,ro={data:[]},Hi={words:[]};for(let E=0,m=t.length;E<m;E++)Ei=t[E],Ei===`
`?(Be&&lr(),Hi.paraEnd=!0,qs(),ns=!0):(ci=vB(Ei),ci===bu&&a!=="none"&&(Ei=wB(Ei,a,!Be)),dn=h.measureText(Ei).width,n&&(n<0&&(fs=dn),dn+=n),Su=ci===Ks&&(Wn===Ks||Wn===bu)||Wn===Ks&&ci!==Eu,js=(ci===qp||ci===Ks)&&(Wn===bB||Wn===Eu),Cu=ns&&o?u-o:u,y&&u&&Fe+Be+dn>Cu&&(x?(Be&&lr(),Fe&&qs()):(js||(js=ci===bu&&Wn==Eu),(Su||js||ci===Jp||ci===qp||ci===Ks||Be+dn>Cu)&&Be&&lr(),Fe&&qs())),Ei===" "&&ns!==!0&&Fe+Be===0||(ci===Jp?(Ei===" "&&Be&&lr(),Tu(Ei,dn),lr()):((Su||js)&&Be&&lr(),Tu(Ei,dn))),Wn=ci);Be&&lr(),Fe&&qs(),es.length>0&&(es[es.length-1].paraEnd=!0)}else t.split(`
`).forEach(y=>{uo.paraNumber++,Fe=h.measureText(y).width,es.push({x:o||0,text:y,width:Fe,paraStart:!0}),Vu&&sy()})}function Tu(i,t){fs&&!lo&&(lo=fs),ro.data.push({char:i,width:t}),Be+=t}function lr(){Fe+=Be,ro.width=Be,Hi.words.push(ro),ro={data:[]},Be=0}function qs(){ns&&(uo.paraNumber++,Hi.paraStart=!0,ns=!1),fs&&(Hi.startCharSize=lo,Hi.endCharSize=fs,lo=0),Hi.width=Fe,Da.width?xB(Hi):Vu&&sy(),es.push(Hi),Hi={words:[]},Fe=0}function sy(){Fe>(uo.maxWidth||0)&&(uo.maxWidth=Fe)}const CB=0,Qp=1,tg=2;function SB(i,t,e,n){const{rows:o}=i,{textAlign:a,paraIndent:h,letterSpacing:u}=t;let d,f,y,x,E;o.forEach(m=>{m.words&&(y=h&&m.paraStart?h:0,f=e&&a==="justify"&&m.words.length>1?(e-m.width-y)/(m.words.length-1):0,x=u||m.isOverflow?CB:f>.01?Qp:tg,m.isOverflow&&!u&&(m.textMode=!0),x===tg?(m.x+=y,TB(m)):(m.x+=y,d=m.x,m.data=[],m.words.forEach(S=>{x===Qp?(E={char:"",x:d},d=RB(S.data,d,E),(m.isOverflow||E.char!==" ")&&m.data.push(E)):d=LB(S.data,d,m.data,m.isOverflow),!m.paraEnd&&f&&(d+=f,m.width+=f)})),m.words=null)})}function TB(i){i.text="",i.words.forEach(t=>{t.data.forEach(e=>{i.text+=e.char})})}function RB(i,t,e){return i.forEach(n=>{e.char+=n.char,t+=n.width}),t}function LB(i,t,e,n){return i.forEach(o=>{(n||o.char!==" ")&&(o.x=t,e.push(o)),t+=o.width}),t}function kB(i,t){const{rows:e,bounds:n}=i,{__lineHeight:o,__baseLine:a,__letterSpacing:h,__clipText:u,textAlign:d,verticalAlign:f,paraSpacing:y,autoSizeAlign:x}=t;let{x:E,y:m,width:S,height:B}=n,P=o*e.length+(y?y*(i.paraNumber-1):0),$=a;if(u&&P>B)P=Math.max(B,o),i.overflow=e.length;else if(B||x)switch(f){case"middle":m+=(B-P)/2;break;case"bottom":m+=B-P}$+=m;let I,F,L,T=S||x?S:i.maxWidth;for(let U=0,W=e.length;U<W;U++){if(I=e[U],I.x=E,I.width<S||I.width>S&&!u)switch(d){case"center":I.x+=(T-I.width)/2;break;case"right":I.x+=T-I.width}I.paraStart&&y&&U>0&&($+=y),I.y=$,$+=o,i.overflow>U&&$>P&&(I.isOverflow=!0,i.overflow=U+1),F=I.x,L=I.width,h<0&&(I.width<0?(L=-I.width+t.fontSize+h,F-=L,L+=t.fontSize):L-=h),F<n.x&&(n.x=F),L>n.width&&(n.width=L),u&&S&&S<L&&(I.isOverflow=!0,i.overflow||(i.overflow=e.length))}n.y=m,n.height=P}function BB(i,t,e,n){if(!n)return;const{rows:o,overflow:a}=i;let{textOverflow:h}=t;if(o.splice(a),h&&h!=="show"){h==="hide"?h="":h==="ellipsis"&&(h="...");let u,d;const f=h?V.canvas.measureText(h).width:0,y=e+n-f;(t.textWrap==="none"?o:[o[a-1]]).forEach(E=>{if(E.isOverflow&&E.data){let m=E.data.length-1;for(let S=m;S>-1&&(u=E.data[S],d=u.x+u.width,!(S===m&&d<y));S--){if(d<y&&u.char!==" "){E.data.splice(S+1),E.width-=u.width;break}E.width-=u.width}E.width+=f,E.data.push({char:h,x:d}),E.textMode&&OB(E)}})}}function OB(i){i.text="",i.data.forEach(t=>{i.text+=t.char}),i.data=null}function PB(i,t){const{fontSize:e}=t;switch(i.decorationHeight=e/11,t.textDecoration){case"under":i.decorationY=e*.15;break;case"delete":i.decorationY=-e*.35}}const{top:Wa,right:oy,bottom:ay,left:Fa}=Lu;function AB(i,t){typeof i!="string"&&(i=String(i));let e=0,n=0,o=t.__getInput("width")||0,a=t.__getInput("height")||0;const{textDecoration:h,__font:u,__padding:d}=t;d&&(o?(e=d[Fa],o-=d[oy]+d[Fa]):t.autoSizeAlign||(e=d[Fa]),a?(n=d[Wa],a-=d[Wa]+d[ay]):t.autoSizeAlign||(n=d[Wa]));const f={bounds:{x:e,y:n,width:o,height:a},rows:[],paraNumber:0,font:V.canvas.font=u};return EB(f,i,t),d&&MB(d,f,t,o,a),kB(f,t),SB(f,t,o),f.overflow&&BB(f,t,e,o),h!=="none"&&PB(f,t),f}function MB(i,t,e,n,o){if(!n&&e.autoSizeAlign)switch(e.textAlign){case"left":Pa(t,"x",i[Fa]);break;case"right":Pa(t,"x",-i[oy])}if(!o&&e.autoSizeAlign)switch(e.verticalAlign){case"top":Pa(t,"y",i[Wa]);break;case"bottom":Pa(t,"y",-i[ay])}}function Pa(i,t,e){const{bounds:n,rows:o}=i;n[t]+=e;for(let a=0;a<o.length;a++)o[a][t]+=e}const IB={getDrawData:AB};function DB(i,t){const e=typeof t=="number"&&t!==1;if(typeof i=="string")if(e&&vr.object)i=vr.object(i);else return i;let n=i.a===void 0?1:i.a;e&&(n*=t);const o=i.r+","+i.g+","+i.b;return n===1?"rgb("+o+")":"rgba("+o+","+n+")"}const WB={string:DB},{setPoint:FB,addPoint:$B,toBounds:zB}=co;function HB(i){const{width:t,height:e}=i.view,{data:n}=i.context.getImageData(0,0,t,e);let o,a,h,u=0;for(let f=0;f<n.length;f+=4)n[f+3]!==0&&(o=u%t,a=(u-o)/t,h?$B(h,o,a):FB(h={},o,a)),u++;const d=new zt;return zB(h,d),d.scale(1/i.pixelRatio).ceil()}const NB={export(i,t,e){this.running=!0;const n=_n.fileType(t),o=t.includes(".");return e=_n.getExportOptions(e),UB(a=>new Promise(h=>{const u=x=>{a(x),h(),this.running=!1},{toURL:d}=V,{download:f}=V.origin;if(n==="json")return o&&f(d(JSON.stringify(i.toJSON(e.json)),"text"),t),u({data:o?!0:i.toJSON(e.json)});if(n==="svg")return o&&f(d(i.toSVG(),"svg"),t),u({data:o?!0:i.toSVG()});const{leafer:y}=i;y?(hy(i),y.waitViewCompleted(()=>dc(this,void 0,void 0,function*(){let x,E,m=1,S=1;const{worldTransform:B,isLeafer:P,isFrame:$}=i,{slice:I,trim:F,onCanvas:L}=e,T=e.smooth===void 0?y.config.smooth:e.smooth,U=e.contextSettings||y.config.contextSettings,W=e.screenshot||i.isApp,nt=P&&W&&e.fill===void 0?i.fill:e.fill,pt=_n.isOpaqueImage(t)||nt,Q=new ze;if(W)x=W===!0?P?y.canvas.bounds:i.worldRenderBounds:W;else{let Vt=e.relative||(P?"inner":"local");switch(m=B.scaleX,S=B.scaleY,Vt){case"inner":Q.set(B);break;case"local":Q.set(B).divide(i.localTransform),m/=i.scaleX,S/=i.scaleY;break;case"world":m=1,S=1;break;case"page":Vt=i.leafer;default:Q.set(B).divide(i.getTransform(Vt));const Ki=Vt.worldTransform;m/=m/Ki.scaleX,S/=S/Ki.scaleY}x=i.getBounds("render",Vt)}const J={scaleX:1,scaleY:1};fe.getScaleData(e.scale,e.size,x,J);let Z=e.pixelRatio||1;i.isApp&&(J.scaleX*=Z,J.scaleY*=Z,Z=i.app.pixelRatio);const{x:ct,y:Dt,width:Wt,height:le}=new zt(x).scale(J.scaleX,J.scaleY),ne={matrix:Q.scale(1/J.scaleX,1/J.scaleY).invert().translate(-ct,-Dt).withScale(1/m*J.scaleX,1/S*J.scaleY)};let vt=qt.canvas({width:Math.round(Wt),height:Math.round(le),pixelRatio:Z,smooth:T,contextSettings:U}),xe;if(I&&(xe=i,xe.__worldOpacity=0,i=y,ne.bounds=vt.bounds),vt.save(),$&&nt!==void 0){const Vt=i.get("fill");i.fill="",i.__render(vt,ne),i.fill=Vt}else i.__render(vt,ne);if(vt.restore(),xe&&xe.__updateWorldOpacity(),F){E=HB(vt);const Vt=vt,{width:Ki,height:Er}=E,Cr={x:0,y:0,width:Ki,height:Er,pixelRatio:Z};vt=qt.canvas(Cr),vt.copyWorld(Vt,E,Cr)}pt&&vt.fillWorld(vt.bounds,nt||"#FFFFFF","destination-over"),L&&L(vt);const gi=t==="canvas"?vt:yield vt.export(t,e);u({data:gi,width:vt.pixelWidth,height:vt.pixelHeight,renderBounds:x,trimBounds:E})}))):u({data:!1})}))}};let Ru;function UB(i){return Ru||(Ru=new Bu),new Promise(t=>{Ru.add(()=>dc(this,void 0,void 0,function*(){return yield i(t)}),{parallel:!1})})}function hy(i){i.__.__needComputePaint&&i.__.__computePaint(),i.isBranch&&i.children.forEach(t=>hy(t))}const ih=ju.prototype,ly=Tt.get("@leafer-ui/export");ih.export=function(i,t){const{quality:e,blob:n}=_n.getExportOptions(t);return i.includes(".")?this.saveAs(i,e):n?this.toBlob(i,e):this.toDataURL(i,e)};ih.toBlob=function(i,t){return new Promise(e=>{V.origin.canvasToBolb(this.view,i,t).then(n=>{e(n)}).catch(n=>{ly.error(n),e(null)})})};ih.toDataURL=function(i,t){return V.origin.canvasToDataURL(this.view,i,t)};ih.saveAs=function(i,t){return new Promise(e=>{V.origin.canvasSaveAs(this.view,i,t).then(()=>{e(!0)}).catch(n=>{ly.error(n),e(!1)})})};Object.assign(kg,IB);Object.assign(vr,WB);Object.assign(Zt,Ek);Object.assign(mr,Ak);Object.assign(Ma,Hk);Object.assign(Pu,Zk);Object.assign(rs,NB);Object.assign(qt,{interaction:(i,t,e,n)=>new ck(i,t,e,n),hitCanvas:(i,t)=>new Xg(i,t),hitCanvasManager:()=>new qR});GL();function pc(i){const t=zn(i);return{createRect:a=>{const h=new pi({width:300,height:300,editable:!0,fill:"rgb(50,205,121)"});t.value.add(h)},createText:a=>{const h=new Bt({fill:"rgb(50,205,121)",text:"Welcome to LeaferJS",editable:!0,fontSize:30});t.value.add(h)},createImage:a=>{const h=new oo({url:new URL("/design-workshop/png/icon-tupian-DF6voxQz.png",import.meta.url).href,draggable:!0,editable:!0});t.value.add(h)}}}const GB={},VB={xmlns:"http://www.w3.org/2000/svg",height:"200px",width:"200px",viewBox:"0 0 200 200",class:"pencil"};function YB(i,t){return Ri(),Hn("svg",VB,t[0]||(t[0]=[hg('<defs data-v-e9ef1164><clipPath id="pencil-eraser" data-v-e9ef1164><rect height="30" width="30" ry="5" rx="5" data-v-e9ef1164></rect></clipPath></defs><circle transform="rotate(-113,100,100)" stroke-linecap="round" stroke-dashoffset="439.82" stroke-dasharray="439.82 439.82" stroke-width="2" stroke="currentColor" fill="none" r="70" class="pencil__stroke" data-v-e9ef1164></circle><g transform="translate(100,100)" class="pencil__rotate" data-v-e9ef1164><g fill="none" data-v-e9ef1164><circle transform="rotate(-90)" stroke-dashoffset="402" stroke-dasharray="402.12 402.12" stroke-width="30" stroke="hsl(223,90%,50%)" r="64" class="pencil__body1" data-v-e9ef1164></circle><circle transform="rotate(-90)" stroke-dashoffset="465" stroke-dasharray="464.96 464.96" stroke-width="10" stroke="hsl(223,90%,60%)" r="74" class="pencil__body2" data-v-e9ef1164></circle><circle transform="rotate(-90)" stroke-dashoffset="339" stroke-dasharray="339.29 339.29" stroke-width="10" stroke="hsl(223,90%,40%)" r="54" class="pencil__body3" data-v-e9ef1164></circle></g><g transform="rotate(-90) translate(49,0)" class="pencil__eraser" data-v-e9ef1164><g class="pencil__eraser-skew" data-v-e9ef1164><rect height="30" width="30" ry="5" rx="5" fill="hsl(223,90%,70%)" data-v-e9ef1164></rect><rect clip-path="url(#pencil-eraser)" height="30" width="5" fill="hsl(223,90%,60%)" data-v-e9ef1164></rect><rect height="20" width="30" fill="hsl(223,10%,90%)" data-v-e9ef1164></rect><rect height="20" width="15" fill="hsl(223,10%,70%)" data-v-e9ef1164></rect><rect height="20" width="5" fill="hsl(223,10%,80%)" data-v-e9ef1164></rect><rect height="2" width="30" y="6" fill="hsla(223,10%,10%,0.2)" data-v-e9ef1164></rect><rect height="2" width="30" y="13" fill="hsla(223,10%,10%,0.2)" data-v-e9ef1164></rect></g></g><g transform="rotate(-90) translate(49,-30)" class="pencil__point" data-v-e9ef1164><polygon points="15 0,30 30,0 30" fill="hsl(33,90%,70%)" data-v-e9ef1164></polygon><polygon points="15 0,6 30,0 30" fill="hsl(33,90%,50%)" data-v-e9ef1164></polygon><polygon points="15 0,20 10,10 10" fill="hsl(223,10%,10%)" data-v-e9ef1164></polygon></g></g>',3)]))}const XB=_s(GB,[["render",YB],["__scopeId","data-v-e9ef1164"]]),ZB={class:"sidebar"},KB={class:"sidebar-login"},jB={class:"sidebar-box"},qB=["onClick"],JB=Va({__name:"index",props:{modelValue:{type:String,default:()=>"text"},workspace:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(i,{emit:t}){const e=i,n=t;pc(e.workspace);const o=h=>{n("update:modelValue",h)},a=zn([{title:"文字",value:"text",icon:"icon-wenzi1",path:""},{title:"元素",value:"element",icon:"icon-cryo",path:""},{title:"图片",value:"image",icon:"icon-tupian",path:""},{title:"背景",value:"background",icon:"icon-beijing",path:""}]);return(h,u)=>{const d=Yu("jy-icon");return Ri(),Hn("div",ZB,[jt("div",KB,[fr(XB)]),jt("div",jB,[(Ri(!0),Hn(Jb,null,Qb(a.value,(f,y)=>(Ri(),Hn("div",{key:y,class:lg(["sidebar-box-list",i.modelValue===f.value?"sidebar-box-list-active":""]),onClick:x=>o(f.value)},[fr(d,{size:"24",type:f.icon,color:i.modelValue===f.value?"#fff":""},null,8,["type","color"]),jt("span",null,tE(f.title),1)],10,qB))),128))])])}}}),QB=_s(JB,[["__scopeId","data-v-7a651d00"]]),tO={class:"characters"},eO=Va({__name:"characters",props:{workspace:{type:Object,default:()=>{}}},setup(i){let e=pc(i.workspace);const n=()=>{e==null||e.createText()};return(o,a)=>(Ri(),Hn("div",tO,[jt("div",{class:"characters-list",onClick:n},"吉云设计"),a[0]||(a[0]=jt("div",{class:"characters-list"},"吉云设计",-1))]))}}),iO=_s(eO,[["__scopeId","data-v-af6e589d"]]),nO={},rO={class:"navigation"},sO={class:"navigation-left"},oO={class:"navigation-list"},aO={href:"https://github.com/zhuhong96/design-workshop",target:"_blank"},hO={class:"navigation-list"},lO={class:"navigation-box"},uO={class:"navigation-model"},cO={class:"navigation-list"};function dO(i,t){const e=Yu("jy-icon");return Ri(),Hn("div",rO,[jt("div",sO,[jt("div",oO,[jt("a",aO,[fr(e,{type:"icon-github",size:"24"},{default:Xf(()=>t[0]||(t[0]=[Zf("Github")])),_:1})])]),jt("div",hO,[fr(e,{type:"icon-Gitee",size:"24"},{default:Xf(()=>t[1]||(t[1]=[Zf("Gitee")])),_:1})])]),jt("div",lO,[jt("div",uO,[t[2]||(t[2]=jt("div",{class:"navigation-list button-style"},"创建画布",-1)),t[3]||(t[3]=jt("div",{class:"navigation-list button-style"},"预览",-1)),jt("div",cO,[fr(e,{type:"icon-chexiao",size:"24"})])]),t[4]||(t[4]=jt("div",{class:"navigation-right"},[jt("div",{class:"navigation-list button-style"},"导出")],-1))])])}const fO=_s(nO,[["render",dO],["__scopeId","data-v-194ffe52"]]),_O={class:"element"},pO=Va({__name:"element",props:{workspace:{type:Object,default:()=>{}}},setup(i){return pc(i.workspace),(e,n)=>(Ri(),Hn("div",_O,n[0]||(n[0]=[hg('<div class="element-list" data-v-3262c8bb><div class="element-rect" data-v-3262c8bb></div></div><div class="element-list" data-v-3262c8bb><div class="element-rect-1" data-v-3262c8bb></div></div><div class="element-list" data-v-3262c8bb><div class="element-rect-2" data-v-3262c8bb></div></div><div class="element-list" data-v-3262c8bb><div class="element-circle" data-v-3262c8bb></div></div><div class="element-list" data-v-3262c8bb><div class="element-circle-1" data-v-3262c8bb></div></div><div class="element-list" data-v-3262c8bb><div class="element-line" data-v-3262c8bb></div></div><div class="element-list" data-v-3262c8bb><div class="element-m" data-v-3262c8bb>M</div></div>',7)])))}}),gO=_s(pO,[["__scopeId","data-v-3262c8bb"]]),yO=Math.PI/180;class vO{constructor(t,e,n){this.app=t,this.rulerLeafer=t.addLeafer(),this.contextContainer=this.rulerLeafer.canvas.context,this.options=n||{ruleSize:20,fontSize:10,themes:new Map([["light",{backgroundColor:"#fff",textColor:"#444",borderColor:"#ccc",highlightColor:"#165dff3b"}],["dark",{backgroundColor:"#242424",textColor:"#ddd",borderColor:"#555",highlightColor:"rgba(22,93,255,0.55)"}]])},this.config=e||{enabled:!0,theme:"light"},this.forceRender=this.forceRender.bind(this),this.resize=this.resize.bind(this),this.enabled=this.config.enabled}changeTheme(t){this.theme=t}set theme(t){this.config.theme=t,this.forceRender()}get theme(){return this.config.theme}addTheme(t,e){this.options.themes.set(t,e)}removeTheme(t){this.options.themes.delete(t)}changeEnabled(t){this.enabled=t}get enabled(){return this.config.enabled}set enabled(t){var e,n;this.config.enabled=t,t?(this.app.tree.on(Ct.AFTER,this.forceRender),this.app.tree.on(yn.RESIZE,this.resize),(e=this.app.editor)===null||e===void 0||e.on(ge.SELECT,this.forceRender),this.resize()):(this.app.tree.off(Ct.AFTER,this.forceRender),this.app.tree.off(yn.RESIZE,this.resize),(n=this.app.editor)===null||n===void 0||n.off(ge.SELECT,this.forceRender),this.rulerLeafer.forceRender())}forceRender(){this.enabled&&this.render({ctx:this.contextContainer})}resize(){setTimeout(()=>{this.enabled&&this.render({ctx:this.contextContainer})},100)}getSize(){return{width:this.app.width,height:this.app.height}}render({ctx:t}){this.rulerLeafer.canvas.setWorld({a:1,b:0,c:0,d:1,e:0,f:0});const{worldTransform:e}=this.app.tree,n=[e.a,e.b,e.c,e.d,e.e,e.f];this.calcObjectRect(),this.draw({ctx:t,isHorizontal:!0,rulerLength:this.getSize().width,startCalibration:-(n[4]/n[0])}),this.draw({ctx:t,isHorizontal:!1,rulerLength:this.getSize().height,startCalibration:-(n[5]/n[3])});const o=this.options.themes.get(this.config.theme);this.darwRect(t,{left:0,top:0,width:this.options.ruleSize,height:this.options.ruleSize,fill:o.backgroundColor,stroke:o.borderColor}),this.darwText(t,{text:"px",left:this.options.ruleSize/2,top:this.options.ruleSize/2,align:"center",baseline:"middle",fill:o.textColor}),this.app.tree.emit(St.END,{renderBounds:this.app.tree.canvas.bounds})}draw(t){const{ctx:e,isHorizontal:n,rulerLength:o,startCalibration:a}=t,h=this.getZoom(),u=this.getGap(h),d=Math.ceil(o/h),f=Math.floor(a/u)*u,y=f-a,x=this.getSize(),E=this.options.themes.get(this.config.theme),{ruleSize:m}=this.options,S=2.5;this.darwRect(e,{left:0,top:0,width:n?x.width:m,height:n?m:x.height,fill:E.backgroundColor,stroke:E.borderColor});for(let B=0;B+y<=d;B+=u)for(let P=0;P<10;P++){const $=Math.round((y+B+u*P/10)*h),I=P===0,[F,L]=n?[$,I?0:m-8]:[I?0:m-8,$],[T,U]=n?[0,m-L]:[m-F,0];this.darwLine(e,{left:F,top:L,width:T,height:U,stroke:E.borderColor})}if(this.objectRect){const B=n?"x":"y";this.objectRect[B].forEach(P=>{if(P.skip===B)return;const[$,I,F,L]=n?[(P.left-a)*h,0,P.width*h,m]:[0,(P.top-a)*h,m,P.height*h];this.darwRect(e,{left:$,top:I,width:F,height:L,fill:E.highlightColor})})}for(let B=0;B+y<=d;B+=u){const P=(y+B)*h,$=(f+B).toString(),[I,F,L]=n?[P+6,S,0]:[S,P-6,-90];this.darwText(e,{text:$,left:I,top:F,fill:E.textColor,angle:L})}}getGap(t){const e=[.02,.03,.05,.1,.2,.5,1,2,5],n=[5e3,2500,1e3,500,200,100,50,20,10];let o=0;for(;o<e.length&&e[o]<t;)o++;return n[o-1]||1e4}darwRect(t,{left:e,top:n,width:o,height:a,fill:h,stroke:u,strokeWidth:d}){t.save(),t.beginPath(),h&&(t.fillStyle=h),t.rect(e,n,o,a),t.fill(),u&&(t.strokeStyle=u,t.lineWidth=d??1,t.stroke()),t.restore()}darwText(t,{left:e,top:n,text:o,fill:a,align:h,angle:u,fontSize:d,baseline:f}){t.save(),a&&(t.fillStyle=a),t.textAlign=h??"left",t.textBaseline=f??"top",t.font=`${d??12}px Helvetica`,u&&(t.translate(e,n),t.rotate(yO*u),t.translate(-e,-n)),t.fillText(o,e,n),t.restore()}darwLine(t,{left:e,top:n,width:o,height:a,stroke:h,lineWidth:u}){t.save(),t.beginPath(),h&&(t.strokeStyle=h),t.lineWidth=u??1,t.moveTo(e,n),t.lineTo(e+o,n+a),t.stroke(),t.restore()}calcObjectRect(){var t;const e=((t=this.app.editor)===null||t===void 0?void 0:t.list)||[];if(e.length===0){this.objectRect=void 0;return}const n=e.reduce((o,a)=>{const h=a.getBounds("box",this.app.tree),u={left:h.x,top:h.y,width:h.width,height:h.height};return o.push(u),o},[]);n.length!==0&&(this.objectRect={x:this.mergeLines(n,!0),y:this.mergeLines(n,!1)})}mergeLines(t,e){const n=e?"left":"top",o=e?"width":"height";t.sort((u,d)=>u[n]-d[n]);const a=[];let h=Object.assign({},t[0]);for(let u=1;u<t.length;u++){const d=Object.assign({},t[u]);h[n]+h[o]>=d[n]?h[o]=Math.max(h[n]+h[o],d[n]+d[o])-h[n]:(a.push(h),h=Object.assign({},d))}return a.push(h),a}getZoom(){return this.app.tree&&typeof this.app.tree.scale=="number"?this.app.tree.scale:1}dispose(){this.rulerLeafer.destroy(),this.enabled=!1}}function mO(){const i=zn(),t=zn(1);return{workspaceInit:n=>{if(!n.width||!n.height)return;const o=(n.width-100)/1920,a=(n.height-100)/1080;t.value=o<a?o:a;const h=n.width/2-1920/2*t.value,u=n.height/2-1080/2*t.value;i.value=new us({width:1920,height:1080,editable:!1,lockRatio:!0,x:0,y:0,resizeChildren:!0}),n.tree.add(i.value);const d=i.value.scale;i.value.scaleOf("top-left",t.value/d),n.tree.move({x:Math.abs(h)+10,y:u+10});const f=new pi({width:300,height:300,editable:!0,fill:"rgb(50,205,121)"});i.value.add(f)},workspace:i}}const eg=mO();class wO{constructor(t){ua(this,"app");ua(this,"ruler");ua(this,"workspace");this.app=new Mu({view:t||"canvas",ground:{type:"draw"},tree:{},editor:{lockRatio:"corner",hover:!0,middlePoint:{cornerRadius:10,width:10,height:10},rotatePoint:{width:10,height:10,fill:"#fff"}},sky:{type:"draw",usePartRender:!1}}),this.ruler=new vO(this.app,{enabled:!0,theme:"dark"}),eg.workspaceInit(this.app)}getApp(){return this.app}getWorkspace(){return eg.workspace.value}}var Js=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xO(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Ga={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/Ga.exports;(function(i,t){(function(){var e,n="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",u="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",f=500,y="__lodash_placeholder__",x=1,E=2,m=4,S=1,B=2,P=1,$=2,I=4,F=8,L=16,T=32,U=64,W=128,nt=256,pt=512,Q=30,J="...",Z=800,ct=16,Dt=1,Wt=2,le=3,ne=1/0,vt=9007199254740991,xe=17976931348623157e292,gi=NaN,Vt=4294967295,Ki=Vt-1,Er=Vt>>>1,Cr=[["ary",W],["bind",P],["bindKey",$],["curry",F],["curryRight",L],["flip",pt],["partial",T],["partialRight",U],["rearg",nt]],xn="[object Arguments]",Sr="[object Array]",nh="[object AsyncFunction]",bn="[object Boolean]",G="[object Date]",mt="[object DOMException]",Ot="[object Error]",be="[object Function]",Mi="[object GeneratorFunction]",ue="[object Map]",Je="[object Number]",Ee="[object Null]",ft="[object Object]",Ce="[object Promise]",ji="[object Proxy]",Se="[object RegExp]",Qt="[object Set]",Qe="[object String]",Yn="[object Symbol]",Tr="[object Undefined]",En="[object WeakMap]",xo="[object WeakSet]",Cn="[object ArrayBuffer]",Ft="[object DataView]",Ue="[object Float32Array]",Ii="[object Float64Array]",yi="[object Int8Array]",gs="[object Int16Array]",Sn="[object Int32Array]",ys="[object Uint8Array]",Xn="[object Uint8ClampedArray]",vs="[object Uint16Array]",rh="[object Uint32Array]",yy=/\b__p \+= '';/g,vy=/\b(__p \+=) '' \+/g,my=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yc=/&(?:amp|lt|gt|quot|#39);/g,vc=/[&<>"']/g,wy=RegExp(yc.source),xy=RegExp(vc.source),by=/<%-([\s\S]+?)%>/g,Ey=/<%([\s\S]+?)%>/g,mc=/<%=([\s\S]+?)%>/g,Cy=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Sy=/^\w*$/,Ty=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,sh=/[\\^$.*+?()[\]{}|]/g,Ry=RegExp(sh.source),oh=/^\s+/,Ly=/\s/,ky=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,By=/\{\n\/\* \[wrapped with (.+)\] \*/,Oy=/,? & /,Py=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ay=/[()=,{}\[\]\/\s]/,My=/\\(\\)?/g,Iy=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wc=/\w*$/,Dy=/^[-+]0x[0-9a-f]+$/i,Wy=/^0b[01]+$/i,Fy=/^\[object .+?Constructor\]$/,$y=/^0o[0-7]+$/i,zy=/^(?:0|[1-9]\d*)$/,Hy=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bo=/($^)/,Ny=/['\n\r\u2028\u2029\\]/g,Eo="\\ud800-\\udfff",Uy="\\u0300-\\u036f",Gy="\\ufe20-\\ufe2f",Vy="\\u20d0-\\u20ff",xc=Uy+Gy+Vy,bc="\\u2700-\\u27bf",Ec="a-z\\xdf-\\xf6\\xf8-\\xff",Yy="\\xac\\xb1\\xd7\\xf7",Xy="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zy="\\u2000-\\u206f",Ky=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Cc="A-Z\\xc0-\\xd6\\xd8-\\xde",Sc="\\ufe0e\\ufe0f",Tc=Yy+Xy+Zy+Ky,ah="['’]",jy="["+Eo+"]",Rc="["+Tc+"]",Co="["+xc+"]",Lc="\\d+",qy="["+bc+"]",kc="["+Ec+"]",Bc="[^"+Eo+Tc+Lc+bc+Ec+Cc+"]",hh="\\ud83c[\\udffb-\\udfff]",Jy="(?:"+Co+"|"+hh+")",Oc="[^"+Eo+"]",lh="(?:\\ud83c[\\udde6-\\uddff]){2}",uh="[\\ud800-\\udbff][\\udc00-\\udfff]",Rr="["+Cc+"]",Pc="\\u200d",Ac="(?:"+kc+"|"+Bc+")",Qy="(?:"+Rr+"|"+Bc+")",Mc="(?:"+ah+"(?:d|ll|m|re|s|t|ve))?",Ic="(?:"+ah+"(?:D|LL|M|RE|S|T|VE))?",Dc=Jy+"?",Wc="["+Sc+"]?",tv="(?:"+Pc+"(?:"+[Oc,lh,uh].join("|")+")"+Wc+Dc+")*",ev="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",iv="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Fc=Wc+Dc+tv,nv="(?:"+[qy,lh,uh].join("|")+")"+Fc,rv="(?:"+[Oc+Co+"?",Co,lh,uh,jy].join("|")+")",sv=RegExp(ah,"g"),ov=RegExp(Co,"g"),ch=RegExp(hh+"(?="+hh+")|"+rv+Fc,"g"),av=RegExp([Rr+"?"+kc+"+"+Mc+"(?="+[Rc,Rr,"$"].join("|")+")",Qy+"+"+Ic+"(?="+[Rc,Rr+Ac,"$"].join("|")+")",Rr+"?"+Ac+"+"+Mc,Rr+"+"+Ic,iv,ev,Lc,nv].join("|"),"g"),hv=RegExp("["+Pc+Eo+xc+Sc+"]"),lv=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,uv=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],cv=-1,$t={};$t[Ue]=$t[Ii]=$t[yi]=$t[gs]=$t[Sn]=$t[ys]=$t[Xn]=$t[vs]=$t[rh]=!0,$t[xn]=$t[Sr]=$t[Cn]=$t[bn]=$t[Ft]=$t[G]=$t[Ot]=$t[be]=$t[ue]=$t[Je]=$t[ft]=$t[Se]=$t[Qt]=$t[Qe]=$t[En]=!1;var Mt={};Mt[xn]=Mt[Sr]=Mt[Cn]=Mt[Ft]=Mt[bn]=Mt[G]=Mt[Ue]=Mt[Ii]=Mt[yi]=Mt[gs]=Mt[Sn]=Mt[ue]=Mt[Je]=Mt[ft]=Mt[Se]=Mt[Qt]=Mt[Qe]=Mt[Yn]=Mt[ys]=Mt[Xn]=Mt[vs]=Mt[rh]=!0,Mt[Ot]=Mt[be]=Mt[En]=!1;var dv={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},fv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_v={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pv={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},gv=parseFloat,yv=parseInt,$c=typeof Js=="object"&&Js&&Js.Object===Object&&Js,vv=typeof self=="object"&&self&&self.Object===Object&&self,_e=$c||vv||Function("return this")(),dh=t&&!t.nodeType&&t,Zn=dh&&!0&&i&&!i.nodeType&&i,zc=Zn&&Zn.exports===dh,fh=zc&&$c.process,ti=function(){try{var b=Zn&&Zn.require&&Zn.require("util").types;return b||fh&&fh.binding&&fh.binding("util")}catch{}}(),Hc=ti&&ti.isArrayBuffer,Nc=ti&&ti.isDate,Uc=ti&&ti.isMap,Gc=ti&&ti.isRegExp,Vc=ti&&ti.isSet,Yc=ti&&ti.isTypedArray;function Ge(b,O,k){switch(k.length){case 0:return b.call(O);case 1:return b.call(O,k[0]);case 2:return b.call(O,k[0],k[1]);case 3:return b.call(O,k[0],k[1],k[2])}return b.apply(O,k)}function mv(b,O,k,N){for(var st=-1,xt=b==null?0:b.length;++st<xt;){var se=b[st];O(N,se,k(se),b)}return N}function ei(b,O){for(var k=-1,N=b==null?0:b.length;++k<N&&O(b[k],k,b)!==!1;);return b}function wv(b,O){for(var k=b==null?0:b.length;k--&&O(b[k],k,b)!==!1;);return b}function Xc(b,O){for(var k=-1,N=b==null?0:b.length;++k<N;)if(!O(b[k],k,b))return!1;return!0}function Tn(b,O){for(var k=-1,N=b==null?0:b.length,st=0,xt=[];++k<N;){var se=b[k];O(se,k,b)&&(xt[st++]=se)}return xt}function So(b,O){var k=b==null?0:b.length;return!!k&&Lr(b,O,0)>-1}function _h(b,O,k){for(var N=-1,st=b==null?0:b.length;++N<st;)if(k(O,b[N]))return!0;return!1}function Nt(b,O){for(var k=-1,N=b==null?0:b.length,st=Array(N);++k<N;)st[k]=O(b[k],k,b);return st}function Rn(b,O){for(var k=-1,N=O.length,st=b.length;++k<N;)b[st+k]=O[k];return b}function ph(b,O,k,N){var st=-1,xt=b==null?0:b.length;for(N&&xt&&(k=b[++st]);++st<xt;)k=O(k,b[st],st,b);return k}function xv(b,O,k,N){var st=b==null?0:b.length;for(N&&st&&(k=b[--st]);st--;)k=O(k,b[st],st,b);return k}function gh(b,O){for(var k=-1,N=b==null?0:b.length;++k<N;)if(O(b[k],k,b))return!0;return!1}var bv=yh("length");function Ev(b){return b.split("")}function Cv(b){return b.match(Py)||[]}function Zc(b,O,k){var N;return k(b,function(st,xt,se){if(O(st,xt,se))return N=xt,!1}),N}function To(b,O,k,N){for(var st=b.length,xt=k+(N?1:-1);N?xt--:++xt<st;)if(O(b[xt],xt,b))return xt;return-1}function Lr(b,O,k){return O===O?Dv(b,O,k):To(b,Kc,k)}function Sv(b,O,k,N){for(var st=k-1,xt=b.length;++st<xt;)if(N(b[st],O))return st;return-1}function Kc(b){return b!==b}function jc(b,O){var k=b==null?0:b.length;return k?mh(b,O)/k:gi}function yh(b){return function(O){return O==null?e:O[b]}}function vh(b){return function(O){return b==null?e:b[O]}}function qc(b,O,k,N,st){return st(b,function(xt,se,At){k=N?(N=!1,xt):O(k,xt,se,At)}),k}function Tv(b,O){var k=b.length;for(b.sort(O);k--;)b[k]=b[k].value;return b}function mh(b,O){for(var k,N=-1,st=b.length;++N<st;){var xt=O(b[N]);xt!==e&&(k=k===e?xt:k+xt)}return k}function wh(b,O){for(var k=-1,N=Array(b);++k<b;)N[k]=O(k);return N}function Rv(b,O){return Nt(O,function(k){return[k,b[k]]})}function Jc(b){return b&&b.slice(0,id(b)+1).replace(oh,"")}function Ve(b){return function(O){return b(O)}}function xh(b,O){return Nt(O,function(k){return b[k]})}function ms(b,O){return b.has(O)}function Qc(b,O){for(var k=-1,N=b.length;++k<N&&Lr(O,b[k],0)>-1;);return k}function td(b,O){for(var k=b.length;k--&&Lr(O,b[k],0)>-1;);return k}function Lv(b,O){for(var k=b.length,N=0;k--;)b[k]===O&&++N;return N}var kv=vh(dv),Bv=vh(fv);function Ov(b){return"\\"+pv[b]}function Pv(b,O){return b==null?e:b[O]}function kr(b){return hv.test(b)}function Av(b){return lv.test(b)}function Mv(b){for(var O,k=[];!(O=b.next()).done;)k.push(O.value);return k}function bh(b){var O=-1,k=Array(b.size);return b.forEach(function(N,st){k[++O]=[st,N]}),k}function ed(b,O){return function(k){return b(O(k))}}function Ln(b,O){for(var k=-1,N=b.length,st=0,xt=[];++k<N;){var se=b[k];(se===O||se===y)&&(b[k]=y,xt[st++]=k)}return xt}function Ro(b){var O=-1,k=Array(b.size);return b.forEach(function(N){k[++O]=N}),k}function Iv(b){var O=-1,k=Array(b.size);return b.forEach(function(N){k[++O]=[N,N]}),k}function Dv(b,O,k){for(var N=k-1,st=b.length;++N<st;)if(b[N]===O)return N;return-1}function Wv(b,O,k){for(var N=k+1;N--;)if(b[N]===O)return N;return N}function Br(b){return kr(b)?$v(b):bv(b)}function vi(b){return kr(b)?zv(b):Ev(b)}function id(b){for(var O=b.length;O--&&Ly.test(b.charAt(O)););return O}var Fv=vh(_v);function $v(b){for(var O=ch.lastIndex=0;ch.test(b);)++O;return O}function zv(b){return b.match(ch)||[]}function Hv(b){return b.match(av)||[]}var Nv=function b(O){O=O==null?_e:Or.defaults(_e.Object(),O,Or.pick(_e,uv));var k=O.Array,N=O.Date,st=O.Error,xt=O.Function,se=O.Math,At=O.Object,Eh=O.RegExp,Uv=O.String,ii=O.TypeError,Lo=k.prototype,Gv=xt.prototype,Pr=At.prototype,ko=O["__core-js_shared__"],Bo=Gv.toString,Rt=Pr.hasOwnProperty,Vv=0,nd=function(){var r=/[^.]+$/.exec(ko&&ko.keys&&ko.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Oo=Pr.toString,Yv=Bo.call(At),Xv=_e._,Zv=Eh("^"+Bo.call(Rt).replace(sh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Po=zc?O.Buffer:e,kn=O.Symbol,Ao=O.Uint8Array,rd=Po?Po.allocUnsafe:e,Mo=ed(At.getPrototypeOf,At),sd=At.create,od=Pr.propertyIsEnumerable,Io=Lo.splice,ad=kn?kn.isConcatSpreadable:e,ws=kn?kn.iterator:e,Kn=kn?kn.toStringTag:e,Do=function(){try{var r=tr(At,"defineProperty");return r({},"",{}),r}catch{}}(),Kv=O.clearTimeout!==_e.clearTimeout&&O.clearTimeout,jv=N&&N.now!==_e.Date.now&&N.now,qv=O.setTimeout!==_e.setTimeout&&O.setTimeout,Wo=se.ceil,Fo=se.floor,Ch=At.getOwnPropertySymbols,Jv=Po?Po.isBuffer:e,hd=O.isFinite,Qv=Lo.join,t0=ed(At.keys,At),oe=se.max,ye=se.min,e0=N.now,i0=O.parseInt,ld=se.random,n0=Lo.reverse,Sh=tr(O,"DataView"),xs=tr(O,"Map"),Th=tr(O,"Promise"),Ar=tr(O,"Set"),bs=tr(O,"WeakMap"),Es=tr(At,"create"),$o=bs&&new bs,Mr={},r0=er(Sh),s0=er(xs),o0=er(Th),a0=er(Ar),h0=er(bs),zo=kn?kn.prototype:e,Cs=zo?zo.valueOf:e,ud=zo?zo.toString:e;function p(r){if(Yt(r)&&!at(r)&&!(r instanceof gt)){if(r instanceof ni)return r;if(Rt.call(r,"__wrapped__"))return df(r)}return new ni(r)}var Ir=function(){function r(){}return function(s){if(!Gt(s))return{};if(sd)return sd(s);r.prototype=s;var l=new r;return r.prototype=e,l}}();function Ho(){}function ni(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=e}p.templateSettings={escape:by,evaluate:Ey,interpolate:mc,variable:"",imports:{_:p}},p.prototype=Ho.prototype,p.prototype.constructor=p,ni.prototype=Ir(Ho.prototype),ni.prototype.constructor=ni;function gt(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Vt,this.__views__=[]}function l0(){var r=new gt(this.__wrapped__);return r.__actions__=Pe(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=Pe(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=Pe(this.__views__),r}function u0(){if(this.__filtered__){var r=new gt(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function c0(){var r=this.__wrapped__.value(),s=this.__dir__,l=at(r),c=s<0,_=l?r.length:0,g=Em(0,_,this.__views__),v=g.start,w=g.end,C=w-v,A=c?w:v-1,M=this.__iteratees__,D=M.length,H=0,Y=ye(C,this.__takeCount__);if(!l||!c&&_==C&&Y==C)return Md(r,this.__actions__);var et=[];t:for(;C--&&H<Y;){A+=s;for(var lt=-1,it=r[A];++lt<D;){var _t=M[lt],yt=_t.iteratee,Ze=_t.type,Le=yt(it);if(Ze==Wt)it=Le;else if(!Le){if(Ze==Dt)continue t;break t}}et[H++]=it}return et}gt.prototype=Ir(Ho.prototype),gt.prototype.constructor=gt;function jn(r){var s=-1,l=r==null?0:r.length;for(this.clear();++s<l;){var c=r[s];this.set(c[0],c[1])}}function d0(){this.__data__=Es?Es(null):{},this.size=0}function f0(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}function _0(r){var s=this.__data__;if(Es){var l=s[r];return l===d?e:l}return Rt.call(s,r)?s[r]:e}function p0(r){var s=this.__data__;return Es?s[r]!==e:Rt.call(s,r)}function g0(r,s){var l=this.__data__;return this.size+=this.has(r)?0:1,l[r]=Es&&s===e?d:s,this}jn.prototype.clear=d0,jn.prototype.delete=f0,jn.prototype.get=_0,jn.prototype.has=p0,jn.prototype.set=g0;function qi(r){var s=-1,l=r==null?0:r.length;for(this.clear();++s<l;){var c=r[s];this.set(c[0],c[1])}}function y0(){this.__data__=[],this.size=0}function v0(r){var s=this.__data__,l=No(s,r);if(l<0)return!1;var c=s.length-1;return l==c?s.pop():Io.call(s,l,1),--this.size,!0}function m0(r){var s=this.__data__,l=No(s,r);return l<0?e:s[l][1]}function w0(r){return No(this.__data__,r)>-1}function x0(r,s){var l=this.__data__,c=No(l,r);return c<0?(++this.size,l.push([r,s])):l[c][1]=s,this}qi.prototype.clear=y0,qi.prototype.delete=v0,qi.prototype.get=m0,qi.prototype.has=w0,qi.prototype.set=x0;function Ji(r){var s=-1,l=r==null?0:r.length;for(this.clear();++s<l;){var c=r[s];this.set(c[0],c[1])}}function b0(){this.size=0,this.__data__={hash:new jn,map:new(xs||qi),string:new jn}}function E0(r){var s=ta(this,r).delete(r);return this.size-=s?1:0,s}function C0(r){return ta(this,r).get(r)}function S0(r){return ta(this,r).has(r)}function T0(r,s){var l=ta(this,r),c=l.size;return l.set(r,s),this.size+=l.size==c?0:1,this}Ji.prototype.clear=b0,Ji.prototype.delete=E0,Ji.prototype.get=C0,Ji.prototype.has=S0,Ji.prototype.set=T0;function qn(r){var s=-1,l=r==null?0:r.length;for(this.__data__=new Ji;++s<l;)this.add(r[s])}function R0(r){return this.__data__.set(r,d),this}function L0(r){return this.__data__.has(r)}qn.prototype.add=qn.prototype.push=R0,qn.prototype.has=L0;function mi(r){var s=this.__data__=new qi(r);this.size=s.size}function k0(){this.__data__=new qi,this.size=0}function B0(r){var s=this.__data__,l=s.delete(r);return this.size=s.size,l}function O0(r){return this.__data__.get(r)}function P0(r){return this.__data__.has(r)}function A0(r,s){var l=this.__data__;if(l instanceof qi){var c=l.__data__;if(!xs||c.length<o-1)return c.push([r,s]),this.size=++l.size,this;l=this.__data__=new Ji(c)}return l.set(r,s),this.size=l.size,this}mi.prototype.clear=k0,mi.prototype.delete=B0,mi.prototype.get=O0,mi.prototype.has=P0,mi.prototype.set=A0;function cd(r,s){var l=at(r),c=!l&&ir(r),_=!l&&!c&&Mn(r),g=!l&&!c&&!_&&$r(r),v=l||c||_||g,w=v?wh(r.length,Uv):[],C=w.length;for(var A in r)(s||Rt.call(r,A))&&!(v&&(A=="length"||_&&(A=="offset"||A=="parent")||g&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||nn(A,C)))&&w.push(A);return w}function dd(r){var s=r.length;return s?r[Wh(0,s-1)]:e}function M0(r,s){return ea(Pe(r),Jn(s,0,r.length))}function I0(r){return ea(Pe(r))}function Rh(r,s,l){(l!==e&&!wi(r[s],l)||l===e&&!(s in r))&&Qi(r,s,l)}function Ss(r,s,l){var c=r[s];(!(Rt.call(r,s)&&wi(c,l))||l===e&&!(s in r))&&Qi(r,s,l)}function No(r,s){for(var l=r.length;l--;)if(wi(r[l][0],s))return l;return-1}function D0(r,s,l,c){return Bn(r,function(_,g,v){s(c,_,l(_),v)}),c}function fd(r,s){return r&&Wi(s,ce(s),r)}function W0(r,s){return r&&Wi(s,Me(s),r)}function Qi(r,s,l){s=="__proto__"&&Do?Do(r,s,{configurable:!0,enumerable:!0,value:l,writable:!0}):r[s]=l}function Lh(r,s){for(var l=-1,c=s.length,_=k(c),g=r==null;++l<c;)_[l]=g?e:hl(r,s[l]);return _}function Jn(r,s,l){return r===r&&(l!==e&&(r=r<=l?r:l),s!==e&&(r=r>=s?r:s)),r}function ri(r,s,l,c,_,g){var v,w=s&x,C=s&E,A=s&m;if(l&&(v=_?l(r,c,_,g):l(r)),v!==e)return v;if(!Gt(r))return r;var M=at(r);if(M){if(v=Sm(r),!w)return Pe(r,v)}else{var D=ve(r),H=D==be||D==Mi;if(Mn(r))return Wd(r,w);if(D==ft||D==xn||H&&!_){if(v=C||H?{}:nf(r),!w)return C?_m(r,W0(v,r)):fm(r,fd(v,r))}else{if(!Mt[D])return _?r:{};v=Tm(r,D,w)}}g||(g=new mi);var Y=g.get(r);if(Y)return Y;g.set(r,v),Pf(r)?r.forEach(function(it){v.add(ri(it,s,l,it,r,g))}):Bf(r)&&r.forEach(function(it,_t){v.set(_t,ri(it,s,l,_t,r,g))});var et=A?C?Zh:Xh:C?Me:ce,lt=M?e:et(r);return ei(lt||r,function(it,_t){lt&&(_t=it,it=r[_t]),Ss(v,_t,ri(it,s,l,_t,r,g))}),v}function F0(r){var s=ce(r);return function(l){return _d(l,r,s)}}function _d(r,s,l){var c=l.length;if(r==null)return!c;for(r=At(r);c--;){var _=l[c],g=s[_],v=r[_];if(v===e&&!(_ in r)||!g(v))return!1}return!0}function pd(r,s,l){if(typeof r!="function")throw new ii(h);return Ps(function(){r.apply(e,l)},s)}function Ts(r,s,l,c){var _=-1,g=So,v=!0,w=r.length,C=[],A=s.length;if(!w)return C;l&&(s=Nt(s,Ve(l))),c?(g=_h,v=!1):s.length>=o&&(g=ms,v=!1,s=new qn(s));t:for(;++_<w;){var M=r[_],D=l==null?M:l(M);if(M=c||M!==0?M:0,v&&D===D){for(var H=A;H--;)if(s[H]===D)continue t;C.push(M)}else g(s,D,c)||C.push(M)}return C}var Bn=Nd(Di),gd=Nd(Bh,!0);function $0(r,s){var l=!0;return Bn(r,function(c,_,g){return l=!!s(c,_,g),l}),l}function Uo(r,s,l){for(var c=-1,_=r.length;++c<_;){var g=r[c],v=s(g);if(v!=null&&(w===e?v===v&&!Xe(v):l(v,w)))var w=v,C=g}return C}function z0(r,s,l,c){var _=r.length;for(l=ht(l),l<0&&(l=-l>_?0:_+l),c=c===e||c>_?_:ht(c),c<0&&(c+=_),c=l>c?0:Mf(c);l<c;)r[l++]=s;return r}function yd(r,s){var l=[];return Bn(r,function(c,_,g){s(c,_,g)&&l.push(c)}),l}function pe(r,s,l,c,_){var g=-1,v=r.length;for(l||(l=Lm),_||(_=[]);++g<v;){var w=r[g];s>0&&l(w)?s>1?pe(w,s-1,l,c,_):Rn(_,w):c||(_[_.length]=w)}return _}var kh=Ud(),vd=Ud(!0);function Di(r,s){return r&&kh(r,s,ce)}function Bh(r,s){return r&&vd(r,s,ce)}function Go(r,s){return Tn(s,function(l){return rn(r[l])})}function Qn(r,s){s=Pn(s,r);for(var l=0,c=s.length;r!=null&&l<c;)r=r[Fi(s[l++])];return l&&l==c?r:e}function md(r,s,l){var c=s(r);return at(r)?c:Rn(c,l(r))}function Te(r){return r==null?r===e?Tr:Ee:Kn&&Kn in At(r)?bm(r):Im(r)}function Oh(r,s){return r>s}function H0(r,s){return r!=null&&Rt.call(r,s)}function N0(r,s){return r!=null&&s in At(r)}function U0(r,s,l){return r>=ye(s,l)&&r<oe(s,l)}function Ph(r,s,l){for(var c=l?_h:So,_=r[0].length,g=r.length,v=g,w=k(g),C=1/0,A=[];v--;){var M=r[v];v&&s&&(M=Nt(M,Ve(s))),C=ye(M.length,C),w[v]=!l&&(s||_>=120&&M.length>=120)?new qn(v&&M):e}M=r[0];var D=-1,H=w[0];t:for(;++D<_&&A.length<C;){var Y=M[D],et=s?s(Y):Y;if(Y=l||Y!==0?Y:0,!(H?ms(H,et):c(A,et,l))){for(v=g;--v;){var lt=w[v];if(!(lt?ms(lt,et):c(r[v],et,l)))continue t}H&&H.push(et),A.push(Y)}}return A}function G0(r,s,l,c){return Di(r,function(_,g,v){s(c,l(_),g,v)}),c}function Rs(r,s,l){s=Pn(s,r),r=af(r,s);var c=r==null?r:r[Fi(oi(s))];return c==null?e:Ge(c,r,l)}function wd(r){return Yt(r)&&Te(r)==xn}function V0(r){return Yt(r)&&Te(r)==Cn}function Y0(r){return Yt(r)&&Te(r)==G}function Ls(r,s,l,c,_){return r===s?!0:r==null||s==null||!Yt(r)&&!Yt(s)?r!==r&&s!==s:X0(r,s,l,c,Ls,_)}function X0(r,s,l,c,_,g){var v=at(r),w=at(s),C=v?Sr:ve(r),A=w?Sr:ve(s);C=C==xn?ft:C,A=A==xn?ft:A;var M=C==ft,D=A==ft,H=C==A;if(H&&Mn(r)){if(!Mn(s))return!1;v=!0,M=!1}if(H&&!M)return g||(g=new mi),v||$r(r)?Qd(r,s,l,c,_,g):wm(r,s,C,l,c,_,g);if(!(l&S)){var Y=M&&Rt.call(r,"__wrapped__"),et=D&&Rt.call(s,"__wrapped__");if(Y||et){var lt=Y?r.value():r,it=et?s.value():s;return g||(g=new mi),_(lt,it,l,c,g)}}return H?(g||(g=new mi),xm(r,s,l,c,_,g)):!1}function Z0(r){return Yt(r)&&ve(r)==ue}function Ah(r,s,l,c){var _=l.length,g=_,v=!c;if(r==null)return!g;for(r=At(r);_--;){var w=l[_];if(v&&w[2]?w[1]!==r[w[0]]:!(w[0]in r))return!1}for(;++_<g;){w=l[_];var C=w[0],A=r[C],M=w[1];if(v&&w[2]){if(A===e&&!(C in r))return!1}else{var D=new mi;if(c)var H=c(A,M,C,r,s,D);if(!(H===e?Ls(M,A,S|B,c,D):H))return!1}}return!0}function xd(r){if(!Gt(r)||Bm(r))return!1;var s=rn(r)?Zv:Fy;return s.test(er(r))}function K0(r){return Yt(r)&&Te(r)==Se}function j0(r){return Yt(r)&&ve(r)==Qt}function q0(r){return Yt(r)&&aa(r.length)&&!!$t[Te(r)]}function bd(r){return typeof r=="function"?r:r==null?Ie:typeof r=="object"?at(r)?Sd(r[0],r[1]):Cd(r):Vf(r)}function Mh(r){if(!Os(r))return t0(r);var s=[];for(var l in At(r))Rt.call(r,l)&&l!="constructor"&&s.push(l);return s}function J0(r){if(!Gt(r))return Mm(r);var s=Os(r),l=[];for(var c in r)c=="constructor"&&(s||!Rt.call(r,c))||l.push(c);return l}function Ih(r,s){return r<s}function Ed(r,s){var l=-1,c=Ae(r)?k(r.length):[];return Bn(r,function(_,g,v){c[++l]=s(_,g,v)}),c}function Cd(r){var s=jh(r);return s.length==1&&s[0][2]?sf(s[0][0],s[0][1]):function(l){return l===r||Ah(l,r,s)}}function Sd(r,s){return Jh(r)&&rf(s)?sf(Fi(r),s):function(l){var c=hl(l,r);return c===e&&c===s?ll(l,r):Ls(s,c,S|B)}}function Vo(r,s,l,c,_){r!==s&&kh(s,function(g,v){if(_||(_=new mi),Gt(g))Q0(r,s,v,l,Vo,c,_);else{var w=c?c(tl(r,v),g,v+"",r,s,_):e;w===e&&(w=g),Rh(r,v,w)}},Me)}function Q0(r,s,l,c,_,g,v){var w=tl(r,l),C=tl(s,l),A=v.get(C);if(A){Rh(r,l,A);return}var M=g?g(w,C,l+"",r,s,v):e,D=M===e;if(D){var H=at(C),Y=!H&&Mn(C),et=!H&&!Y&&$r(C);M=C,H||Y||et?at(w)?M=w:te(w)?M=Pe(w):Y?(D=!1,M=Wd(C,!0)):et?(D=!1,M=Fd(C,!0)):M=[]:As(C)||ir(C)?(M=w,ir(w)?M=If(w):(!Gt(w)||rn(w))&&(M=nf(C))):D=!1}D&&(v.set(C,M),_(M,C,c,g,v),v.delete(C)),Rh(r,l,M)}function Td(r,s){var l=r.length;if(l)return s+=s<0?l:0,nn(s,l)?r[s]:e}function Rd(r,s,l){s.length?s=Nt(s,function(g){return at(g)?function(v){return Qn(v,g.length===1?g[0]:g)}:g}):s=[Ie];var c=-1;s=Nt(s,Ve(tt()));var _=Ed(r,function(g,v,w){var C=Nt(s,function(A){return A(g)});return{criteria:C,index:++c,value:g}});return Tv(_,function(g,v){return dm(g,v,l)})}function tm(r,s){return Ld(r,s,function(l,c){return ll(r,c)})}function Ld(r,s,l){for(var c=-1,_=s.length,g={};++c<_;){var v=s[c],w=Qn(r,v);l(w,v)&&ks(g,Pn(v,r),w)}return g}function em(r){return function(s){return Qn(s,r)}}function Dh(r,s,l,c){var _=c?Sv:Lr,g=-1,v=s.length,w=r;for(r===s&&(s=Pe(s)),l&&(w=Nt(r,Ve(l)));++g<v;)for(var C=0,A=s[g],M=l?l(A):A;(C=_(w,M,C,c))>-1;)w!==r&&Io.call(w,C,1),Io.call(r,C,1);return r}function kd(r,s){for(var l=r?s.length:0,c=l-1;l--;){var _=s[l];if(l==c||_!==g){var g=_;nn(_)?Io.call(r,_,1):zh(r,_)}}return r}function Wh(r,s){return r+Fo(ld()*(s-r+1))}function im(r,s,l,c){for(var _=-1,g=oe(Wo((s-r)/(l||1)),0),v=k(g);g--;)v[c?g:++_]=r,r+=l;return v}function Fh(r,s){var l="";if(!r||s<1||s>vt)return l;do s%2&&(l+=r),s=Fo(s/2),s&&(r+=r);while(s);return l}function dt(r,s){return el(of(r,s,Ie),r+"")}function nm(r){return dd(zr(r))}function rm(r,s){var l=zr(r);return ea(l,Jn(s,0,l.length))}function ks(r,s,l,c){if(!Gt(r))return r;s=Pn(s,r);for(var _=-1,g=s.length,v=g-1,w=r;w!=null&&++_<g;){var C=Fi(s[_]),A=l;if(C==="__proto__"||C==="constructor"||C==="prototype")return r;if(_!=v){var M=w[C];A=c?c(M,C,w):e,A===e&&(A=Gt(M)?M:nn(s[_+1])?[]:{})}Ss(w,C,A),w=w[C]}return r}var Bd=$o?function(r,s){return $o.set(r,s),r}:Ie,sm=Do?function(r,s){return Do(r,"toString",{configurable:!0,enumerable:!1,value:cl(s),writable:!0})}:Ie;function om(r){return ea(zr(r))}function si(r,s,l){var c=-1,_=r.length;s<0&&(s=-s>_?0:_+s),l=l>_?_:l,l<0&&(l+=_),_=s>l?0:l-s>>>0,s>>>=0;for(var g=k(_);++c<_;)g[c]=r[c+s];return g}function am(r,s){var l;return Bn(r,function(c,_,g){return l=s(c,_,g),!l}),!!l}function Yo(r,s,l){var c=0,_=r==null?c:r.length;if(typeof s=="number"&&s===s&&_<=Er){for(;c<_;){var g=c+_>>>1,v=r[g];v!==null&&!Xe(v)&&(l?v<=s:v<s)?c=g+1:_=g}return _}return $h(r,s,Ie,l)}function $h(r,s,l,c){var _=0,g=r==null?0:r.length;if(g===0)return 0;s=l(s);for(var v=s!==s,w=s===null,C=Xe(s),A=s===e;_<g;){var M=Fo((_+g)/2),D=l(r[M]),H=D!==e,Y=D===null,et=D===D,lt=Xe(D);if(v)var it=c||et;else A?it=et&&(c||H):w?it=et&&H&&(c||!Y):C?it=et&&H&&!Y&&(c||!lt):Y||lt?it=!1:it=c?D<=s:D<s;it?_=M+1:g=M}return ye(g,Ki)}function Od(r,s){for(var l=-1,c=r.length,_=0,g=[];++l<c;){var v=r[l],w=s?s(v):v;if(!l||!wi(w,C)){var C=w;g[_++]=v===0?0:v}}return g}function Pd(r){return typeof r=="number"?r:Xe(r)?gi:+r}function Ye(r){if(typeof r=="string")return r;if(at(r))return Nt(r,Ye)+"";if(Xe(r))return ud?ud.call(r):"";var s=r+"";return s=="0"&&1/r==-ne?"-0":s}function On(r,s,l){var c=-1,_=So,g=r.length,v=!0,w=[],C=w;if(l)v=!1,_=_h;else if(g>=o){var A=s?null:vm(r);if(A)return Ro(A);v=!1,_=ms,C=new qn}else C=s?[]:w;t:for(;++c<g;){var M=r[c],D=s?s(M):M;if(M=l||M!==0?M:0,v&&D===D){for(var H=C.length;H--;)if(C[H]===D)continue t;s&&C.push(D),w.push(M)}else _(C,D,l)||(C!==w&&C.push(D),w.push(M))}return w}function zh(r,s){return s=Pn(s,r),r=af(r,s),r==null||delete r[Fi(oi(s))]}function Ad(r,s,l,c){return ks(r,s,l(Qn(r,s)),c)}function Xo(r,s,l,c){for(var _=r.length,g=c?_:-1;(c?g--:++g<_)&&s(r[g],g,r););return l?si(r,c?0:g,c?g+1:_):si(r,c?g+1:0,c?_:g)}function Md(r,s){var l=r;return l instanceof gt&&(l=l.value()),ph(s,function(c,_){return _.func.apply(_.thisArg,Rn([c],_.args))},l)}function Hh(r,s,l){var c=r.length;if(c<2)return c?On(r[0]):[];for(var _=-1,g=k(c);++_<c;)for(var v=r[_],w=-1;++w<c;)w!=_&&(g[_]=Ts(g[_]||v,r[w],s,l));return On(pe(g,1),s,l)}function Id(r,s,l){for(var c=-1,_=r.length,g=s.length,v={};++c<_;){var w=c<g?s[c]:e;l(v,r[c],w)}return v}function Nh(r){return te(r)?r:[]}function Uh(r){return typeof r=="function"?r:Ie}function Pn(r,s){return at(r)?r:Jh(r,s)?[r]:cf(Et(r))}var hm=dt;function An(r,s,l){var c=r.length;return l=l===e?c:l,!s&&l>=c?r:si(r,s,l)}var Dd=Kv||function(r){return _e.clearTimeout(r)};function Wd(r,s){if(s)return r.slice();var l=r.length,c=rd?rd(l):new r.constructor(l);return r.copy(c),c}function Gh(r){var s=new r.constructor(r.byteLength);return new Ao(s).set(new Ao(r)),s}function lm(r,s){var l=s?Gh(r.buffer):r.buffer;return new r.constructor(l,r.byteOffset,r.byteLength)}function um(r){var s=new r.constructor(r.source,wc.exec(r));return s.lastIndex=r.lastIndex,s}function cm(r){return Cs?At(Cs.call(r)):{}}function Fd(r,s){var l=s?Gh(r.buffer):r.buffer;return new r.constructor(l,r.byteOffset,r.length)}function $d(r,s){if(r!==s){var l=r!==e,c=r===null,_=r===r,g=Xe(r),v=s!==e,w=s===null,C=s===s,A=Xe(s);if(!w&&!A&&!g&&r>s||g&&v&&C&&!w&&!A||c&&v&&C||!l&&C||!_)return 1;if(!c&&!g&&!A&&r<s||A&&l&&_&&!c&&!g||w&&l&&_||!v&&_||!C)return-1}return 0}function dm(r,s,l){for(var c=-1,_=r.criteria,g=s.criteria,v=_.length,w=l.length;++c<v;){var C=$d(_[c],g[c]);if(C){if(c>=w)return C;var A=l[c];return C*(A=="desc"?-1:1)}}return r.index-s.index}function zd(r,s,l,c){for(var _=-1,g=r.length,v=l.length,w=-1,C=s.length,A=oe(g-v,0),M=k(C+A),D=!c;++w<C;)M[w]=s[w];for(;++_<v;)(D||_<g)&&(M[l[_]]=r[_]);for(;A--;)M[w++]=r[_++];return M}function Hd(r,s,l,c){for(var _=-1,g=r.length,v=-1,w=l.length,C=-1,A=s.length,M=oe(g-w,0),D=k(M+A),H=!c;++_<M;)D[_]=r[_];for(var Y=_;++C<A;)D[Y+C]=s[C];for(;++v<w;)(H||_<g)&&(D[Y+l[v]]=r[_++]);return D}function Pe(r,s){var l=-1,c=r.length;for(s||(s=k(c));++l<c;)s[l]=r[l];return s}function Wi(r,s,l,c){var _=!l;l||(l={});for(var g=-1,v=s.length;++g<v;){var w=s[g],C=c?c(l[w],r[w],w,l,r):e;C===e&&(C=r[w]),_?Qi(l,w,C):Ss(l,w,C)}return l}function fm(r,s){return Wi(r,qh(r),s)}function _m(r,s){return Wi(r,tf(r),s)}function Zo(r,s){return function(l,c){var _=at(l)?mv:D0,g=s?s():{};return _(l,r,tt(c,2),g)}}function Dr(r){return dt(function(s,l){var c=-1,_=l.length,g=_>1?l[_-1]:e,v=_>2?l[2]:e;for(g=r.length>3&&typeof g=="function"?(_--,g):e,v&&Re(l[0],l[1],v)&&(g=_<3?e:g,_=1),s=At(s);++c<_;){var w=l[c];w&&r(s,w,c,g)}return s})}function Nd(r,s){return function(l,c){if(l==null)return l;if(!Ae(l))return r(l,c);for(var _=l.length,g=s?_:-1,v=At(l);(s?g--:++g<_)&&c(v[g],g,v)!==!1;);return l}}function Ud(r){return function(s,l,c){for(var _=-1,g=At(s),v=c(s),w=v.length;w--;){var C=v[r?w:++_];if(l(g[C],C,g)===!1)break}return s}}function pm(r,s,l){var c=s&P,_=Bs(r);function g(){var v=this&&this!==_e&&this instanceof g?_:r;return v.apply(c?l:this,arguments)}return g}function Gd(r){return function(s){s=Et(s);var l=kr(s)?vi(s):e,c=l?l[0]:s.charAt(0),_=l?An(l,1).join(""):s.slice(1);return c[r]()+_}}function Wr(r){return function(s){return ph(Uf(Nf(s).replace(sv,"")),r,"")}}function Bs(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var l=Ir(r.prototype),c=r.apply(l,s);return Gt(c)?c:l}}function gm(r,s,l){var c=Bs(r);function _(){for(var g=arguments.length,v=k(g),w=g,C=Fr(_);w--;)v[w]=arguments[w];var A=g<3&&v[0]!==C&&v[g-1]!==C?[]:Ln(v,C);if(g-=A.length,g<l)return Kd(r,s,Ko,_.placeholder,e,v,A,e,e,l-g);var M=this&&this!==_e&&this instanceof _?c:r;return Ge(M,this,v)}return _}function Vd(r){return function(s,l,c){var _=At(s);if(!Ae(s)){var g=tt(l,3);s=ce(s),l=function(w){return g(_[w],w,_)}}var v=r(s,l,c);return v>-1?_[g?s[v]:v]:e}}function Yd(r){return en(function(s){var l=s.length,c=l,_=ni.prototype.thru;for(r&&s.reverse();c--;){var g=s[c];if(typeof g!="function")throw new ii(h);if(_&&!v&&Qo(g)=="wrapper")var v=new ni([],!0)}for(c=v?c:l;++c<l;){g=s[c];var w=Qo(g),C=w=="wrapper"?Kh(g):e;C&&Qh(C[0])&&C[1]==(W|F|T|nt)&&!C[4].length&&C[9]==1?v=v[Qo(C[0])].apply(v,C[3]):v=g.length==1&&Qh(g)?v[w]():v.thru(g)}return function(){var A=arguments,M=A[0];if(v&&A.length==1&&at(M))return v.plant(M).value();for(var D=0,H=l?s[D].apply(this,A):M;++D<l;)H=s[D].call(this,H);return H}})}function Ko(r,s,l,c,_,g,v,w,C,A){var M=s&W,D=s&P,H=s&$,Y=s&(F|L),et=s&pt,lt=H?e:Bs(r);function it(){for(var _t=arguments.length,yt=k(_t),Ze=_t;Ze--;)yt[Ze]=arguments[Ze];if(Y)var Le=Fr(it),Ke=Lv(yt,Le);if(c&&(yt=zd(yt,c,_,Y)),g&&(yt=Hd(yt,g,v,Y)),_t-=Ke,Y&&_t<A){var ee=Ln(yt,Le);return Kd(r,s,Ko,it.placeholder,l,yt,ee,w,C,A-_t)}var xi=D?l:this,on=H?xi[r]:r;return _t=yt.length,w?yt=Dm(yt,w):et&&_t>1&&yt.reverse(),M&&C<_t&&(yt.length=C),this&&this!==_e&&this instanceof it&&(on=lt||Bs(on)),on.apply(xi,yt)}return it}function Xd(r,s){return function(l,c){return G0(l,r,s(c),{})}}function jo(r,s){return function(l,c){var _;if(l===e&&c===e)return s;if(l!==e&&(_=l),c!==e){if(_===e)return c;typeof l=="string"||typeof c=="string"?(l=Ye(l),c=Ye(c)):(l=Pd(l),c=Pd(c)),_=r(l,c)}return _}}function Vh(r){return en(function(s){return s=Nt(s,Ve(tt())),dt(function(l){var c=this;return r(s,function(_){return Ge(_,c,l)})})})}function qo(r,s){s=s===e?" ":Ye(s);var l=s.length;if(l<2)return l?Fh(s,r):s;var c=Fh(s,Wo(r/Br(s)));return kr(s)?An(vi(c),0,r).join(""):c.slice(0,r)}function ym(r,s,l,c){var _=s&P,g=Bs(r);function v(){for(var w=-1,C=arguments.length,A=-1,M=c.length,D=k(M+C),H=this&&this!==_e&&this instanceof v?g:r;++A<M;)D[A]=c[A];for(;C--;)D[A++]=arguments[++w];return Ge(H,_?l:this,D)}return v}function Zd(r){return function(s,l,c){return c&&typeof c!="number"&&Re(s,l,c)&&(l=c=e),s=sn(s),l===e?(l=s,s=0):l=sn(l),c=c===e?s<l?1:-1:sn(c),im(s,l,c,r)}}function Jo(r){return function(s,l){return typeof s=="string"&&typeof l=="string"||(s=ai(s),l=ai(l)),r(s,l)}}function Kd(r,s,l,c,_,g,v,w,C,A){var M=s&F,D=M?v:e,H=M?e:v,Y=M?g:e,et=M?e:g;s|=M?T:U,s&=~(M?U:T),s&I||(s&=~(P|$));var lt=[r,s,_,Y,D,et,H,w,C,A],it=l.apply(e,lt);return Qh(r)&&hf(it,lt),it.placeholder=c,lf(it,r,s)}function Yh(r){var s=se[r];return function(l,c){if(l=ai(l),c=c==null?0:ye(ht(c),292),c&&hd(l)){var _=(Et(l)+"e").split("e"),g=s(_[0]+"e"+(+_[1]+c));return _=(Et(g)+"e").split("e"),+(_[0]+"e"+(+_[1]-c))}return s(l)}}var vm=Ar&&1/Ro(new Ar([,-0]))[1]==ne?function(r){return new Ar(r)}:_l;function jd(r){return function(s){var l=ve(s);return l==ue?bh(s):l==Qt?Iv(s):Rv(s,r(s))}}function tn(r,s,l,c,_,g,v,w){var C=s&$;if(!C&&typeof r!="function")throw new ii(h);var A=c?c.length:0;if(A||(s&=~(T|U),c=_=e),v=v===e?v:oe(ht(v),0),w=w===e?w:ht(w),A-=_?_.length:0,s&U){var M=c,D=_;c=_=e}var H=C?e:Kh(r),Y=[r,s,l,c,_,M,D,g,v,w];if(H&&Am(Y,H),r=Y[0],s=Y[1],l=Y[2],c=Y[3],_=Y[4],w=Y[9]=Y[9]===e?C?0:r.length:oe(Y[9]-A,0),!w&&s&(F|L)&&(s&=~(F|L)),!s||s==P)var et=pm(r,s,l);else s==F||s==L?et=gm(r,s,w):(s==T||s==(P|T))&&!_.length?et=ym(r,s,l,c):et=Ko.apply(e,Y);var lt=H?Bd:hf;return lf(lt(et,Y),r,s)}function qd(r,s,l,c){return r===e||wi(r,Pr[l])&&!Rt.call(c,l)?s:r}function Jd(r,s,l,c,_,g){return Gt(r)&&Gt(s)&&(g.set(s,r),Vo(r,s,e,Jd,g),g.delete(s)),r}function mm(r){return As(r)?e:r}function Qd(r,s,l,c,_,g){var v=l&S,w=r.length,C=s.length;if(w!=C&&!(v&&C>w))return!1;var A=g.get(r),M=g.get(s);if(A&&M)return A==s&&M==r;var D=-1,H=!0,Y=l&B?new qn:e;for(g.set(r,s),g.set(s,r);++D<w;){var et=r[D],lt=s[D];if(c)var it=v?c(lt,et,D,s,r,g):c(et,lt,D,r,s,g);if(it!==e){if(it)continue;H=!1;break}if(Y){if(!gh(s,function(_t,yt){if(!ms(Y,yt)&&(et===_t||_(et,_t,l,c,g)))return Y.push(yt)})){H=!1;break}}else if(!(et===lt||_(et,lt,l,c,g))){H=!1;break}}return g.delete(r),g.delete(s),H}function wm(r,s,l,c,_,g,v){switch(l){case Ft:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case Cn:return!(r.byteLength!=s.byteLength||!g(new Ao(r),new Ao(s)));case bn:case G:case Je:return wi(+r,+s);case Ot:return r.name==s.name&&r.message==s.message;case Se:case Qe:return r==s+"";case ue:var w=bh;case Qt:var C=c&S;if(w||(w=Ro),r.size!=s.size&&!C)return!1;var A=v.get(r);if(A)return A==s;c|=B,v.set(r,s);var M=Qd(w(r),w(s),c,_,g,v);return v.delete(r),M;case Yn:if(Cs)return Cs.call(r)==Cs.call(s)}return!1}function xm(r,s,l,c,_,g){var v=l&S,w=Xh(r),C=w.length,A=Xh(s),M=A.length;if(C!=M&&!v)return!1;for(var D=C;D--;){var H=w[D];if(!(v?H in s:Rt.call(s,H)))return!1}var Y=g.get(r),et=g.get(s);if(Y&&et)return Y==s&&et==r;var lt=!0;g.set(r,s),g.set(s,r);for(var it=v;++D<C;){H=w[D];var _t=r[H],yt=s[H];if(c)var Ze=v?c(yt,_t,H,s,r,g):c(_t,yt,H,r,s,g);if(!(Ze===e?_t===yt||_(_t,yt,l,c,g):Ze)){lt=!1;break}it||(it=H=="constructor")}if(lt&&!it){var Le=r.constructor,Ke=s.constructor;Le!=Ke&&"constructor"in r&&"constructor"in s&&!(typeof Le=="function"&&Le instanceof Le&&typeof Ke=="function"&&Ke instanceof Ke)&&(lt=!1)}return g.delete(r),g.delete(s),lt}function en(r){return el(of(r,e,pf),r+"")}function Xh(r){return md(r,ce,qh)}function Zh(r){return md(r,Me,tf)}var Kh=$o?function(r){return $o.get(r)}:_l;function Qo(r){for(var s=r.name+"",l=Mr[s],c=Rt.call(Mr,s)?l.length:0;c--;){var _=l[c],g=_.func;if(g==null||g==r)return _.name}return s}function Fr(r){var s=Rt.call(p,"placeholder")?p:r;return s.placeholder}function tt(){var r=p.iteratee||dl;return r=r===dl?bd:r,arguments.length?r(arguments[0],arguments[1]):r}function ta(r,s){var l=r.__data__;return km(s)?l[typeof s=="string"?"string":"hash"]:l.map}function jh(r){for(var s=ce(r),l=s.length;l--;){var c=s[l],_=r[c];s[l]=[c,_,rf(_)]}return s}function tr(r,s){var l=Pv(r,s);return xd(l)?l:e}function bm(r){var s=Rt.call(r,Kn),l=r[Kn];try{r[Kn]=e;var c=!0}catch{}var _=Oo.call(r);return c&&(s?r[Kn]=l:delete r[Kn]),_}var qh=Ch?function(r){return r==null?[]:(r=At(r),Tn(Ch(r),function(s){return od.call(r,s)}))}:pl,tf=Ch?function(r){for(var s=[];r;)Rn(s,qh(r)),r=Mo(r);return s}:pl,ve=Te;(Sh&&ve(new Sh(new ArrayBuffer(1)))!=Ft||xs&&ve(new xs)!=ue||Th&&ve(Th.resolve())!=Ce||Ar&&ve(new Ar)!=Qt||bs&&ve(new bs)!=En)&&(ve=function(r){var s=Te(r),l=s==ft?r.constructor:e,c=l?er(l):"";if(c)switch(c){case r0:return Ft;case s0:return ue;case o0:return Ce;case a0:return Qt;case h0:return En}return s});function Em(r,s,l){for(var c=-1,_=l.length;++c<_;){var g=l[c],v=g.size;switch(g.type){case"drop":r+=v;break;case"dropRight":s-=v;break;case"take":s=ye(s,r+v);break;case"takeRight":r=oe(r,s-v);break}}return{start:r,end:s}}function Cm(r){var s=r.match(By);return s?s[1].split(Oy):[]}function ef(r,s,l){s=Pn(s,r);for(var c=-1,_=s.length,g=!1;++c<_;){var v=Fi(s[c]);if(!(g=r!=null&&l(r,v)))break;r=r[v]}return g||++c!=_?g:(_=r==null?0:r.length,!!_&&aa(_)&&nn(v,_)&&(at(r)||ir(r)))}function Sm(r){var s=r.length,l=new r.constructor(s);return s&&typeof r[0]=="string"&&Rt.call(r,"index")&&(l.index=r.index,l.input=r.input),l}function nf(r){return typeof r.constructor=="function"&&!Os(r)?Ir(Mo(r)):{}}function Tm(r,s,l){var c=r.constructor;switch(s){case Cn:return Gh(r);case bn:case G:return new c(+r);case Ft:return lm(r,l);case Ue:case Ii:case yi:case gs:case Sn:case ys:case Xn:case vs:case rh:return Fd(r,l);case ue:return new c;case Je:case Qe:return new c(r);case Se:return um(r);case Qt:return new c;case Yn:return cm(r)}}function Rm(r,s){var l=s.length;if(!l)return r;var c=l-1;return s[c]=(l>1?"& ":"")+s[c],s=s.join(l>2?", ":" "),r.replace(ky,`{
/* [wrapped with `+s+`] */
`)}function Lm(r){return at(r)||ir(r)||!!(ad&&r&&r[ad])}function nn(r,s){var l=typeof r;return s=s??vt,!!s&&(l=="number"||l!="symbol"&&zy.test(r))&&r>-1&&r%1==0&&r<s}function Re(r,s,l){if(!Gt(l))return!1;var c=typeof s;return(c=="number"?Ae(l)&&nn(s,l.length):c=="string"&&s in l)?wi(l[s],r):!1}function Jh(r,s){if(at(r))return!1;var l=typeof r;return l=="number"||l=="symbol"||l=="boolean"||r==null||Xe(r)?!0:Sy.test(r)||!Cy.test(r)||s!=null&&r in At(s)}function km(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function Qh(r){var s=Qo(r),l=p[s];if(typeof l!="function"||!(s in gt.prototype))return!1;if(r===l)return!0;var c=Kh(l);return!!c&&r===c[0]}function Bm(r){return!!nd&&nd in r}var Om=ko?rn:gl;function Os(r){var s=r&&r.constructor,l=typeof s=="function"&&s.prototype||Pr;return r===l}function rf(r){return r===r&&!Gt(r)}function sf(r,s){return function(l){return l==null?!1:l[r]===s&&(s!==e||r in At(l))}}function Pm(r){var s=sa(r,function(c){return l.size===f&&l.clear(),c}),l=s.cache;return s}function Am(r,s){var l=r[1],c=s[1],_=l|c,g=_<(P|$|W),v=c==W&&l==F||c==W&&l==nt&&r[7].length<=s[8]||c==(W|nt)&&s[7].length<=s[8]&&l==F;if(!(g||v))return r;c&P&&(r[2]=s[2],_|=l&P?0:I);var w=s[3];if(w){var C=r[3];r[3]=C?zd(C,w,s[4]):w,r[4]=C?Ln(r[3],y):s[4]}return w=s[5],w&&(C=r[5],r[5]=C?Hd(C,w,s[6]):w,r[6]=C?Ln(r[5],y):s[6]),w=s[7],w&&(r[7]=w),c&W&&(r[8]=r[8]==null?s[8]:ye(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=_,r}function Mm(r){var s=[];if(r!=null)for(var l in At(r))s.push(l);return s}function Im(r){return Oo.call(r)}function of(r,s,l){return s=oe(s===e?r.length-1:s,0),function(){for(var c=arguments,_=-1,g=oe(c.length-s,0),v=k(g);++_<g;)v[_]=c[s+_];_=-1;for(var w=k(s+1);++_<s;)w[_]=c[_];return w[s]=l(v),Ge(r,this,w)}}function af(r,s){return s.length<2?r:Qn(r,si(s,0,-1))}function Dm(r,s){for(var l=r.length,c=ye(s.length,l),_=Pe(r);c--;){var g=s[c];r[c]=nn(g,l)?_[g]:e}return r}function tl(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}var hf=uf(Bd),Ps=qv||function(r,s){return _e.setTimeout(r,s)},el=uf(sm);function lf(r,s,l){var c=s+"";return el(r,Rm(c,Wm(Cm(c),l)))}function uf(r){var s=0,l=0;return function(){var c=e0(),_=ct-(c-l);if(l=c,_>0){if(++s>=Z)return arguments[0]}else s=0;return r.apply(e,arguments)}}function ea(r,s){var l=-1,c=r.length,_=c-1;for(s=s===e?c:s;++l<s;){var g=Wh(l,_),v=r[g];r[g]=r[l],r[l]=v}return r.length=s,r}var cf=Pm(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(Ty,function(l,c,_,g){s.push(_?g.replace(My,"$1"):c||l)}),s});function Fi(r){if(typeof r=="string"||Xe(r))return r;var s=r+"";return s=="0"&&1/r==-ne?"-0":s}function er(r){if(r!=null){try{return Bo.call(r)}catch{}try{return r+""}catch{}}return""}function Wm(r,s){return ei(Cr,function(l){var c="_."+l[0];s&l[1]&&!So(r,c)&&r.push(c)}),r.sort()}function df(r){if(r instanceof gt)return r.clone();var s=new ni(r.__wrapped__,r.__chain__);return s.__actions__=Pe(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}function Fm(r,s,l){(l?Re(r,s,l):s===e)?s=1:s=oe(ht(s),0);var c=r==null?0:r.length;if(!c||s<1)return[];for(var _=0,g=0,v=k(Wo(c/s));_<c;)v[g++]=si(r,_,_+=s);return v}function $m(r){for(var s=-1,l=r==null?0:r.length,c=0,_=[];++s<l;){var g=r[s];g&&(_[c++]=g)}return _}function zm(){var r=arguments.length;if(!r)return[];for(var s=k(r-1),l=arguments[0],c=r;c--;)s[c-1]=arguments[c];return Rn(at(l)?Pe(l):[l],pe(s,1))}var Hm=dt(function(r,s){return te(r)?Ts(r,pe(s,1,te,!0)):[]}),Nm=dt(function(r,s){var l=oi(s);return te(l)&&(l=e),te(r)?Ts(r,pe(s,1,te,!0),tt(l,2)):[]}),Um=dt(function(r,s){var l=oi(s);return te(l)&&(l=e),te(r)?Ts(r,pe(s,1,te,!0),e,l):[]});function Gm(r,s,l){var c=r==null?0:r.length;return c?(s=l||s===e?1:ht(s),si(r,s<0?0:s,c)):[]}function Vm(r,s,l){var c=r==null?0:r.length;return c?(s=l||s===e?1:ht(s),s=c-s,si(r,0,s<0?0:s)):[]}function Ym(r,s){return r&&r.length?Xo(r,tt(s,3),!0,!0):[]}function Xm(r,s){return r&&r.length?Xo(r,tt(s,3),!0):[]}function Zm(r,s,l,c){var _=r==null?0:r.length;return _?(l&&typeof l!="number"&&Re(r,s,l)&&(l=0,c=_),z0(r,s,l,c)):[]}function ff(r,s,l){var c=r==null?0:r.length;if(!c)return-1;var _=l==null?0:ht(l);return _<0&&(_=oe(c+_,0)),To(r,tt(s,3),_)}function _f(r,s,l){var c=r==null?0:r.length;if(!c)return-1;var _=c-1;return l!==e&&(_=ht(l),_=l<0?oe(c+_,0):ye(_,c-1)),To(r,tt(s,3),_,!0)}function pf(r){var s=r==null?0:r.length;return s?pe(r,1):[]}function Km(r){var s=r==null?0:r.length;return s?pe(r,ne):[]}function jm(r,s){var l=r==null?0:r.length;return l?(s=s===e?1:ht(s),pe(r,s)):[]}function qm(r){for(var s=-1,l=r==null?0:r.length,c={};++s<l;){var _=r[s];c[_[0]]=_[1]}return c}function gf(r){return r&&r.length?r[0]:e}function Jm(r,s,l){var c=r==null?0:r.length;if(!c)return-1;var _=l==null?0:ht(l);return _<0&&(_=oe(c+_,0)),Lr(r,s,_)}function Qm(r){var s=r==null?0:r.length;return s?si(r,0,-1):[]}var tw=dt(function(r){var s=Nt(r,Nh);return s.length&&s[0]===r[0]?Ph(s):[]}),ew=dt(function(r){var s=oi(r),l=Nt(r,Nh);return s===oi(l)?s=e:l.pop(),l.length&&l[0]===r[0]?Ph(l,tt(s,2)):[]}),iw=dt(function(r){var s=oi(r),l=Nt(r,Nh);return s=typeof s=="function"?s:e,s&&l.pop(),l.length&&l[0]===r[0]?Ph(l,e,s):[]});function nw(r,s){return r==null?"":Qv.call(r,s)}function oi(r){var s=r==null?0:r.length;return s?r[s-1]:e}function rw(r,s,l){var c=r==null?0:r.length;if(!c)return-1;var _=c;return l!==e&&(_=ht(l),_=_<0?oe(c+_,0):ye(_,c-1)),s===s?Wv(r,s,_):To(r,Kc,_,!0)}function sw(r,s){return r&&r.length?Td(r,ht(s)):e}var ow=dt(yf);function yf(r,s){return r&&r.length&&s&&s.length?Dh(r,s):r}function aw(r,s,l){return r&&r.length&&s&&s.length?Dh(r,s,tt(l,2)):r}function hw(r,s,l){return r&&r.length&&s&&s.length?Dh(r,s,e,l):r}var lw=en(function(r,s){var l=r==null?0:r.length,c=Lh(r,s);return kd(r,Nt(s,function(_){return nn(_,l)?+_:_}).sort($d)),c});function uw(r,s){var l=[];if(!(r&&r.length))return l;var c=-1,_=[],g=r.length;for(s=tt(s,3);++c<g;){var v=r[c];s(v,c,r)&&(l.push(v),_.push(c))}return kd(r,_),l}function il(r){return r==null?r:n0.call(r)}function cw(r,s,l){var c=r==null?0:r.length;return c?(l&&typeof l!="number"&&Re(r,s,l)?(s=0,l=c):(s=s==null?0:ht(s),l=l===e?c:ht(l)),si(r,s,l)):[]}function dw(r,s){return Yo(r,s)}function fw(r,s,l){return $h(r,s,tt(l,2))}function _w(r,s){var l=r==null?0:r.length;if(l){var c=Yo(r,s);if(c<l&&wi(r[c],s))return c}return-1}function pw(r,s){return Yo(r,s,!0)}function gw(r,s,l){return $h(r,s,tt(l,2),!0)}function yw(r,s){var l=r==null?0:r.length;if(l){var c=Yo(r,s,!0)-1;if(wi(r[c],s))return c}return-1}function vw(r){return r&&r.length?Od(r):[]}function mw(r,s){return r&&r.length?Od(r,tt(s,2)):[]}function ww(r){var s=r==null?0:r.length;return s?si(r,1,s):[]}function xw(r,s,l){return r&&r.length?(s=l||s===e?1:ht(s),si(r,0,s<0?0:s)):[]}function bw(r,s,l){var c=r==null?0:r.length;return c?(s=l||s===e?1:ht(s),s=c-s,si(r,s<0?0:s,c)):[]}function Ew(r,s){return r&&r.length?Xo(r,tt(s,3),!1,!0):[]}function Cw(r,s){return r&&r.length?Xo(r,tt(s,3)):[]}var Sw=dt(function(r){return On(pe(r,1,te,!0))}),Tw=dt(function(r){var s=oi(r);return te(s)&&(s=e),On(pe(r,1,te,!0),tt(s,2))}),Rw=dt(function(r){var s=oi(r);return s=typeof s=="function"?s:e,On(pe(r,1,te,!0),e,s)});function Lw(r){return r&&r.length?On(r):[]}function kw(r,s){return r&&r.length?On(r,tt(s,2)):[]}function Bw(r,s){return s=typeof s=="function"?s:e,r&&r.length?On(r,e,s):[]}function nl(r){if(!(r&&r.length))return[];var s=0;return r=Tn(r,function(l){if(te(l))return s=oe(l.length,s),!0}),wh(s,function(l){return Nt(r,yh(l))})}function vf(r,s){if(!(r&&r.length))return[];var l=nl(r);return s==null?l:Nt(l,function(c){return Ge(s,e,c)})}var Ow=dt(function(r,s){return te(r)?Ts(r,s):[]}),Pw=dt(function(r){return Hh(Tn(r,te))}),Aw=dt(function(r){var s=oi(r);return te(s)&&(s=e),Hh(Tn(r,te),tt(s,2))}),Mw=dt(function(r){var s=oi(r);return s=typeof s=="function"?s:e,Hh(Tn(r,te),e,s)}),Iw=dt(nl);function Dw(r,s){return Id(r||[],s||[],Ss)}function Ww(r,s){return Id(r||[],s||[],ks)}var Fw=dt(function(r){var s=r.length,l=s>1?r[s-1]:e;return l=typeof l=="function"?(r.pop(),l):e,vf(r,l)});function mf(r){var s=p(r);return s.__chain__=!0,s}function $w(r,s){return s(r),r}function ia(r,s){return s(r)}var zw=en(function(r){var s=r.length,l=s?r[0]:0,c=this.__wrapped__,_=function(g){return Lh(g,r)};return s>1||this.__actions__.length||!(c instanceof gt)||!nn(l)?this.thru(_):(c=c.slice(l,+l+(s?1:0)),c.__actions__.push({func:ia,args:[_],thisArg:e}),new ni(c,this.__chain__).thru(function(g){return s&&!g.length&&g.push(e),g}))});function Hw(){return mf(this)}function Nw(){return new ni(this.value(),this.__chain__)}function Uw(){this.__values__===e&&(this.__values__=Af(this.value()));var r=this.__index__>=this.__values__.length,s=r?e:this.__values__[this.__index__++];return{done:r,value:s}}function Gw(){return this}function Vw(r){for(var s,l=this;l instanceof Ho;){var c=df(l);c.__index__=0,c.__values__=e,s?_.__wrapped__=c:s=c;var _=c;l=l.__wrapped__}return _.__wrapped__=r,s}function Yw(){var r=this.__wrapped__;if(r instanceof gt){var s=r;return this.__actions__.length&&(s=new gt(this)),s=s.reverse(),s.__actions__.push({func:ia,args:[il],thisArg:e}),new ni(s,this.__chain__)}return this.thru(il)}function Xw(){return Md(this.__wrapped__,this.__actions__)}var Zw=Zo(function(r,s,l){Rt.call(r,l)?++r[l]:Qi(r,l,1)});function Kw(r,s,l){var c=at(r)?Xc:$0;return l&&Re(r,s,l)&&(s=e),c(r,tt(s,3))}function jw(r,s){var l=at(r)?Tn:yd;return l(r,tt(s,3))}var qw=Vd(ff),Jw=Vd(_f);function Qw(r,s){return pe(na(r,s),1)}function t1(r,s){return pe(na(r,s),ne)}function e1(r,s,l){return l=l===e?1:ht(l),pe(na(r,s),l)}function wf(r,s){var l=at(r)?ei:Bn;return l(r,tt(s,3))}function xf(r,s){var l=at(r)?wv:gd;return l(r,tt(s,3))}var i1=Zo(function(r,s,l){Rt.call(r,l)?r[l].push(s):Qi(r,l,[s])});function n1(r,s,l,c){r=Ae(r)?r:zr(r),l=l&&!c?ht(l):0;var _=r.length;return l<0&&(l=oe(_+l,0)),ha(r)?l<=_&&r.indexOf(s,l)>-1:!!_&&Lr(r,s,l)>-1}var r1=dt(function(r,s,l){var c=-1,_=typeof s=="function",g=Ae(r)?k(r.length):[];return Bn(r,function(v){g[++c]=_?Ge(s,v,l):Rs(v,s,l)}),g}),s1=Zo(function(r,s,l){Qi(r,l,s)});function na(r,s){var l=at(r)?Nt:Ed;return l(r,tt(s,3))}function o1(r,s,l,c){return r==null?[]:(at(s)||(s=s==null?[]:[s]),l=c?e:l,at(l)||(l=l==null?[]:[l]),Rd(r,s,l))}var a1=Zo(function(r,s,l){r[l?0:1].push(s)},function(){return[[],[]]});function h1(r,s,l){var c=at(r)?ph:qc,_=arguments.length<3;return c(r,tt(s,4),l,_,Bn)}function l1(r,s,l){var c=at(r)?xv:qc,_=arguments.length<3;return c(r,tt(s,4),l,_,gd)}function u1(r,s){var l=at(r)?Tn:yd;return l(r,oa(tt(s,3)))}function c1(r){var s=at(r)?dd:nm;return s(r)}function d1(r,s,l){(l?Re(r,s,l):s===e)?s=1:s=ht(s);var c=at(r)?M0:rm;return c(r,s)}function f1(r){var s=at(r)?I0:om;return s(r)}function _1(r){if(r==null)return 0;if(Ae(r))return ha(r)?Br(r):r.length;var s=ve(r);return s==ue||s==Qt?r.size:Mh(r).length}function p1(r,s,l){var c=at(r)?gh:am;return l&&Re(r,s,l)&&(s=e),c(r,tt(s,3))}var g1=dt(function(r,s){if(r==null)return[];var l=s.length;return l>1&&Re(r,s[0],s[1])?s=[]:l>2&&Re(s[0],s[1],s[2])&&(s=[s[0]]),Rd(r,pe(s,1),[])}),ra=jv||function(){return _e.Date.now()};function y1(r,s){if(typeof s!="function")throw new ii(h);return r=ht(r),function(){if(--r<1)return s.apply(this,arguments)}}function bf(r,s,l){return s=l?e:s,s=r&&s==null?r.length:s,tn(r,W,e,e,e,e,s)}function Ef(r,s){var l;if(typeof s!="function")throw new ii(h);return r=ht(r),function(){return--r>0&&(l=s.apply(this,arguments)),r<=1&&(s=e),l}}var rl=dt(function(r,s,l){var c=P;if(l.length){var _=Ln(l,Fr(rl));c|=T}return tn(r,c,s,l,_)}),Cf=dt(function(r,s,l){var c=P|$;if(l.length){var _=Ln(l,Fr(Cf));c|=T}return tn(s,c,r,l,_)});function Sf(r,s,l){s=l?e:s;var c=tn(r,F,e,e,e,e,e,s);return c.placeholder=Sf.placeholder,c}function Tf(r,s,l){s=l?e:s;var c=tn(r,L,e,e,e,e,e,s);return c.placeholder=Tf.placeholder,c}function Rf(r,s,l){var c,_,g,v,w,C,A=0,M=!1,D=!1,H=!0;if(typeof r!="function")throw new ii(h);s=ai(s)||0,Gt(l)&&(M=!!l.leading,D="maxWait"in l,g=D?oe(ai(l.maxWait)||0,s):g,H="trailing"in l?!!l.trailing:H);function Y(ee){var xi=c,on=_;return c=_=e,A=ee,v=r.apply(on,xi),v}function et(ee){return A=ee,w=Ps(_t,s),M?Y(ee):v}function lt(ee){var xi=ee-C,on=ee-A,Yf=s-xi;return D?ye(Yf,g-on):Yf}function it(ee){var xi=ee-C,on=ee-A;return C===e||xi>=s||xi<0||D&&on>=g}function _t(){var ee=ra();if(it(ee))return yt(ee);w=Ps(_t,lt(ee))}function yt(ee){return w=e,H&&c?Y(ee):(c=_=e,v)}function Ze(){w!==e&&Dd(w),A=0,c=C=_=w=e}function Le(){return w===e?v:yt(ra())}function Ke(){var ee=ra(),xi=it(ee);if(c=arguments,_=this,C=ee,xi){if(w===e)return et(C);if(D)return Dd(w),w=Ps(_t,s),Y(C)}return w===e&&(w=Ps(_t,s)),v}return Ke.cancel=Ze,Ke.flush=Le,Ke}var v1=dt(function(r,s){return pd(r,1,s)}),m1=dt(function(r,s,l){return pd(r,ai(s)||0,l)});function w1(r){return tn(r,pt)}function sa(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new ii(h);var l=function(){var c=arguments,_=s?s.apply(this,c):c[0],g=l.cache;if(g.has(_))return g.get(_);var v=r.apply(this,c);return l.cache=g.set(_,v)||g,v};return l.cache=new(sa.Cache||Ji),l}sa.Cache=Ji;function oa(r){if(typeof r!="function")throw new ii(h);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}function x1(r){return Ef(2,r)}var b1=hm(function(r,s){s=s.length==1&&at(s[0])?Nt(s[0],Ve(tt())):Nt(pe(s,1),Ve(tt()));var l=s.length;return dt(function(c){for(var _=-1,g=ye(c.length,l);++_<g;)c[_]=s[_].call(this,c[_]);return Ge(r,this,c)})}),sl=dt(function(r,s){var l=Ln(s,Fr(sl));return tn(r,T,e,s,l)}),Lf=dt(function(r,s){var l=Ln(s,Fr(Lf));return tn(r,U,e,s,l)}),E1=en(function(r,s){return tn(r,nt,e,e,e,s)});function C1(r,s){if(typeof r!="function")throw new ii(h);return s=s===e?s:ht(s),dt(r,s)}function S1(r,s){if(typeof r!="function")throw new ii(h);return s=s==null?0:oe(ht(s),0),dt(function(l){var c=l[s],_=An(l,0,s);return c&&Rn(_,c),Ge(r,this,_)})}function T1(r,s,l){var c=!0,_=!0;if(typeof r!="function")throw new ii(h);return Gt(l)&&(c="leading"in l?!!l.leading:c,_="trailing"in l?!!l.trailing:_),Rf(r,s,{leading:c,maxWait:s,trailing:_})}function R1(r){return bf(r,1)}function L1(r,s){return sl(Uh(s),r)}function k1(){if(!arguments.length)return[];var r=arguments[0];return at(r)?r:[r]}function B1(r){return ri(r,m)}function O1(r,s){return s=typeof s=="function"?s:e,ri(r,m,s)}function P1(r){return ri(r,x|m)}function A1(r,s){return s=typeof s=="function"?s:e,ri(r,x|m,s)}function M1(r,s){return s==null||_d(r,s,ce(s))}function wi(r,s){return r===s||r!==r&&s!==s}var I1=Jo(Oh),D1=Jo(function(r,s){return r>=s}),ir=wd(function(){return arguments}())?wd:function(r){return Yt(r)&&Rt.call(r,"callee")&&!od.call(r,"callee")},at=k.isArray,W1=Hc?Ve(Hc):V0;function Ae(r){return r!=null&&aa(r.length)&&!rn(r)}function te(r){return Yt(r)&&Ae(r)}function F1(r){return r===!0||r===!1||Yt(r)&&Te(r)==bn}var Mn=Jv||gl,$1=Nc?Ve(Nc):Y0;function z1(r){return Yt(r)&&r.nodeType===1&&!As(r)}function H1(r){if(r==null)return!0;if(Ae(r)&&(at(r)||typeof r=="string"||typeof r.splice=="function"||Mn(r)||$r(r)||ir(r)))return!r.length;var s=ve(r);if(s==ue||s==Qt)return!r.size;if(Os(r))return!Mh(r).length;for(var l in r)if(Rt.call(r,l))return!1;return!0}function N1(r,s){return Ls(r,s)}function U1(r,s,l){l=typeof l=="function"?l:e;var c=l?l(r,s):e;return c===e?Ls(r,s,e,l):!!c}function ol(r){if(!Yt(r))return!1;var s=Te(r);return s==Ot||s==mt||typeof r.message=="string"&&typeof r.name=="string"&&!As(r)}function G1(r){return typeof r=="number"&&hd(r)}function rn(r){if(!Gt(r))return!1;var s=Te(r);return s==be||s==Mi||s==nh||s==ji}function kf(r){return typeof r=="number"&&r==ht(r)}function aa(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=vt}function Gt(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function Yt(r){return r!=null&&typeof r=="object"}var Bf=Uc?Ve(Uc):Z0;function V1(r,s){return r===s||Ah(r,s,jh(s))}function Y1(r,s,l){return l=typeof l=="function"?l:e,Ah(r,s,jh(s),l)}function X1(r){return Of(r)&&r!=+r}function Z1(r){if(Om(r))throw new st(a);return xd(r)}function K1(r){return r===null}function j1(r){return r==null}function Of(r){return typeof r=="number"||Yt(r)&&Te(r)==Je}function As(r){if(!Yt(r)||Te(r)!=ft)return!1;var s=Mo(r);if(s===null)return!0;var l=Rt.call(s,"constructor")&&s.constructor;return typeof l=="function"&&l instanceof l&&Bo.call(l)==Yv}var al=Gc?Ve(Gc):K0;function q1(r){return kf(r)&&r>=-vt&&r<=vt}var Pf=Vc?Ve(Vc):j0;function ha(r){return typeof r=="string"||!at(r)&&Yt(r)&&Te(r)==Qe}function Xe(r){return typeof r=="symbol"||Yt(r)&&Te(r)==Yn}var $r=Yc?Ve(Yc):q0;function J1(r){return r===e}function Q1(r){return Yt(r)&&ve(r)==En}function tx(r){return Yt(r)&&Te(r)==xo}var ex=Jo(Ih),ix=Jo(function(r,s){return r<=s});function Af(r){if(!r)return[];if(Ae(r))return ha(r)?vi(r):Pe(r);if(ws&&r[ws])return Mv(r[ws]());var s=ve(r),l=s==ue?bh:s==Qt?Ro:zr;return l(r)}function sn(r){if(!r)return r===0?r:0;if(r=ai(r),r===ne||r===-ne){var s=r<0?-1:1;return s*xe}return r===r?r:0}function ht(r){var s=sn(r),l=s%1;return s===s?l?s-l:s:0}function Mf(r){return r?Jn(ht(r),0,Vt):0}function ai(r){if(typeof r=="number")return r;if(Xe(r))return gi;if(Gt(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=Gt(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=Jc(r);var l=Wy.test(r);return l||$y.test(r)?yv(r.slice(2),l?2:8):Dy.test(r)?gi:+r}function If(r){return Wi(r,Me(r))}function nx(r){return r?Jn(ht(r),-vt,vt):r===0?r:0}function Et(r){return r==null?"":Ye(r)}var rx=Dr(function(r,s){if(Os(s)||Ae(s)){Wi(s,ce(s),r);return}for(var l in s)Rt.call(s,l)&&Ss(r,l,s[l])}),Df=Dr(function(r,s){Wi(s,Me(s),r)}),la=Dr(function(r,s,l,c){Wi(s,Me(s),r,c)}),sx=Dr(function(r,s,l,c){Wi(s,ce(s),r,c)}),ox=en(Lh);function ax(r,s){var l=Ir(r);return s==null?l:fd(l,s)}var hx=dt(function(r,s){r=At(r);var l=-1,c=s.length,_=c>2?s[2]:e;for(_&&Re(s[0],s[1],_)&&(c=1);++l<c;)for(var g=s[l],v=Me(g),w=-1,C=v.length;++w<C;){var A=v[w],M=r[A];(M===e||wi(M,Pr[A])&&!Rt.call(r,A))&&(r[A]=g[A])}return r}),lx=dt(function(r){return r.push(e,Jd),Ge(Wf,e,r)});function ux(r,s){return Zc(r,tt(s,3),Di)}function cx(r,s){return Zc(r,tt(s,3),Bh)}function dx(r,s){return r==null?r:kh(r,tt(s,3),Me)}function fx(r,s){return r==null?r:vd(r,tt(s,3),Me)}function _x(r,s){return r&&Di(r,tt(s,3))}function px(r,s){return r&&Bh(r,tt(s,3))}function gx(r){return r==null?[]:Go(r,ce(r))}function yx(r){return r==null?[]:Go(r,Me(r))}function hl(r,s,l){var c=r==null?e:Qn(r,s);return c===e?l:c}function vx(r,s){return r!=null&&ef(r,s,H0)}function ll(r,s){return r!=null&&ef(r,s,N0)}var mx=Xd(function(r,s,l){s!=null&&typeof s.toString!="function"&&(s=Oo.call(s)),r[s]=l},cl(Ie)),wx=Xd(function(r,s,l){s!=null&&typeof s.toString!="function"&&(s=Oo.call(s)),Rt.call(r,s)?r[s].push(l):r[s]=[l]},tt),xx=dt(Rs);function ce(r){return Ae(r)?cd(r):Mh(r)}function Me(r){return Ae(r)?cd(r,!0):J0(r)}function bx(r,s){var l={};return s=tt(s,3),Di(r,function(c,_,g){Qi(l,s(c,_,g),c)}),l}function Ex(r,s){var l={};return s=tt(s,3),Di(r,function(c,_,g){Qi(l,_,s(c,_,g))}),l}var Cx=Dr(function(r,s,l){Vo(r,s,l)}),Wf=Dr(function(r,s,l,c){Vo(r,s,l,c)}),Sx=en(function(r,s){var l={};if(r==null)return l;var c=!1;s=Nt(s,function(g){return g=Pn(g,r),c||(c=g.length>1),g}),Wi(r,Zh(r),l),c&&(l=ri(l,x|E|m,mm));for(var _=s.length;_--;)zh(l,s[_]);return l});function Tx(r,s){return Ff(r,oa(tt(s)))}var Rx=en(function(r,s){return r==null?{}:tm(r,s)});function Ff(r,s){if(r==null)return{};var l=Nt(Zh(r),function(c){return[c]});return s=tt(s),Ld(r,l,function(c,_){return s(c,_[0])})}function Lx(r,s,l){s=Pn(s,r);var c=-1,_=s.length;for(_||(_=1,r=e);++c<_;){var g=r==null?e:r[Fi(s[c])];g===e&&(c=_,g=l),r=rn(g)?g.call(r):g}return r}function kx(r,s,l){return r==null?r:ks(r,s,l)}function Bx(r,s,l,c){return c=typeof c=="function"?c:e,r==null?r:ks(r,s,l,c)}var $f=jd(ce),zf=jd(Me);function Ox(r,s,l){var c=at(r),_=c||Mn(r)||$r(r);if(s=tt(s,4),l==null){var g=r&&r.constructor;_?l=c?new g:[]:Gt(r)?l=rn(g)?Ir(Mo(r)):{}:l={}}return(_?ei:Di)(r,function(v,w,C){return s(l,v,w,C)}),l}function Px(r,s){return r==null?!0:zh(r,s)}function Ax(r,s,l){return r==null?r:Ad(r,s,Uh(l))}function Mx(r,s,l,c){return c=typeof c=="function"?c:e,r==null?r:Ad(r,s,Uh(l),c)}function zr(r){return r==null?[]:xh(r,ce(r))}function Ix(r){return r==null?[]:xh(r,Me(r))}function Dx(r,s,l){return l===e&&(l=s,s=e),l!==e&&(l=ai(l),l=l===l?l:0),s!==e&&(s=ai(s),s=s===s?s:0),Jn(ai(r),s,l)}function Wx(r,s,l){return s=sn(s),l===e?(l=s,s=0):l=sn(l),r=ai(r),U0(r,s,l)}function Fx(r,s,l){if(l&&typeof l!="boolean"&&Re(r,s,l)&&(s=l=e),l===e&&(typeof s=="boolean"?(l=s,s=e):typeof r=="boolean"&&(l=r,r=e)),r===e&&s===e?(r=0,s=1):(r=sn(r),s===e?(s=r,r=0):s=sn(s)),r>s){var c=r;r=s,s=c}if(l||r%1||s%1){var _=ld();return ye(r+_*(s-r+gv("1e-"+((_+"").length-1))),s)}return Wh(r,s)}var $x=Wr(function(r,s,l){return s=s.toLowerCase(),r+(l?Hf(s):s)});function Hf(r){return ul(Et(r).toLowerCase())}function Nf(r){return r=Et(r),r&&r.replace(Hy,kv).replace(ov,"")}function zx(r,s,l){r=Et(r),s=Ye(s);var c=r.length;l=l===e?c:Jn(ht(l),0,c);var _=l;return l-=s.length,l>=0&&r.slice(l,_)==s}function Hx(r){return r=Et(r),r&&xy.test(r)?r.replace(vc,Bv):r}function Nx(r){return r=Et(r),r&&Ry.test(r)?r.replace(sh,"\\$&"):r}var Ux=Wr(function(r,s,l){return r+(l?"-":"")+s.toLowerCase()}),Gx=Wr(function(r,s,l){return r+(l?" ":"")+s.toLowerCase()}),Vx=Gd("toLowerCase");function Yx(r,s,l){r=Et(r),s=ht(s);var c=s?Br(r):0;if(!s||c>=s)return r;var _=(s-c)/2;return qo(Fo(_),l)+r+qo(Wo(_),l)}function Xx(r,s,l){r=Et(r),s=ht(s);var c=s?Br(r):0;return s&&c<s?r+qo(s-c,l):r}function Zx(r,s,l){r=Et(r),s=ht(s);var c=s?Br(r):0;return s&&c<s?qo(s-c,l)+r:r}function Kx(r,s,l){return l||s==null?s=0:s&&(s=+s),i0(Et(r).replace(oh,""),s||0)}function jx(r,s,l){return(l?Re(r,s,l):s===e)?s=1:s=ht(s),Fh(Et(r),s)}function qx(){var r=arguments,s=Et(r[0]);return r.length<3?s:s.replace(r[1],r[2])}var Jx=Wr(function(r,s,l){return r+(l?"_":"")+s.toLowerCase()});function Qx(r,s,l){return l&&typeof l!="number"&&Re(r,s,l)&&(s=l=e),l=l===e?Vt:l>>>0,l?(r=Et(r),r&&(typeof s=="string"||s!=null&&!al(s))&&(s=Ye(s),!s&&kr(r))?An(vi(r),0,l):r.split(s,l)):[]}var tb=Wr(function(r,s,l){return r+(l?" ":"")+ul(s)});function eb(r,s,l){return r=Et(r),l=l==null?0:Jn(ht(l),0,r.length),s=Ye(s),r.slice(l,l+s.length)==s}function ib(r,s,l){var c=p.templateSettings;l&&Re(r,s,l)&&(s=e),r=Et(r),s=la({},s,c,qd);var _=la({},s.imports,c.imports,qd),g=ce(_),v=xh(_,g),w,C,A=0,M=s.interpolate||bo,D="__p += '",H=Eh((s.escape||bo).source+"|"+M.source+"|"+(M===mc?Iy:bo).source+"|"+(s.evaluate||bo).source+"|$","g"),Y="//# sourceURL="+(Rt.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++cv+"]")+`
`;r.replace(H,function(it,_t,yt,Ze,Le,Ke){return yt||(yt=Ze),D+=r.slice(A,Ke).replace(Ny,Ov),_t&&(w=!0,D+=`' +
__e(`+_t+`) +
'`),Le&&(C=!0,D+=`';
`+Le+`;
__p += '`),yt&&(D+=`' +
((__t = (`+yt+`)) == null ? '' : __t) +
'`),A=Ke+it.length,it}),D+=`';
`;var et=Rt.call(s,"variable")&&s.variable;if(!et)D=`with (obj) {
`+D+`
}
`;else if(Ay.test(et))throw new st(u);D=(C?D.replace(yy,""):D).replace(vy,"$1").replace(my,"$1;"),D="function("+(et||"obj")+`) {
`+(et?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(C?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+D+`return __p
}`;var lt=Gf(function(){return xt(g,Y+"return "+D).apply(e,v)});if(lt.source=D,ol(lt))throw lt;return lt}function nb(r){return Et(r).toLowerCase()}function rb(r){return Et(r).toUpperCase()}function sb(r,s,l){if(r=Et(r),r&&(l||s===e))return Jc(r);if(!r||!(s=Ye(s)))return r;var c=vi(r),_=vi(s),g=Qc(c,_),v=td(c,_)+1;return An(c,g,v).join("")}function ob(r,s,l){if(r=Et(r),r&&(l||s===e))return r.slice(0,id(r)+1);if(!r||!(s=Ye(s)))return r;var c=vi(r),_=td(c,vi(s))+1;return An(c,0,_).join("")}function ab(r,s,l){if(r=Et(r),r&&(l||s===e))return r.replace(oh,"");if(!r||!(s=Ye(s)))return r;var c=vi(r),_=Qc(c,vi(s));return An(c,_).join("")}function hb(r,s){var l=Q,c=J;if(Gt(s)){var _="separator"in s?s.separator:_;l="length"in s?ht(s.length):l,c="omission"in s?Ye(s.omission):c}r=Et(r);var g=r.length;if(kr(r)){var v=vi(r);g=v.length}if(l>=g)return r;var w=l-Br(c);if(w<1)return c;var C=v?An(v,0,w).join(""):r.slice(0,w);if(_===e)return C+c;if(v&&(w+=C.length-w),al(_)){if(r.slice(w).search(_)){var A,M=C;for(_.global||(_=Eh(_.source,Et(wc.exec(_))+"g")),_.lastIndex=0;A=_.exec(M);)var D=A.index;C=C.slice(0,D===e?w:D)}}else if(r.indexOf(Ye(_),w)!=w){var H=C.lastIndexOf(_);H>-1&&(C=C.slice(0,H))}return C+c}function lb(r){return r=Et(r),r&&wy.test(r)?r.replace(yc,Fv):r}var ub=Wr(function(r,s,l){return r+(l?" ":"")+s.toUpperCase()}),ul=Gd("toUpperCase");function Uf(r,s,l){return r=Et(r),s=l?e:s,s===e?Av(r)?Hv(r):Cv(r):r.match(s)||[]}var Gf=dt(function(r,s){try{return Ge(r,e,s)}catch(l){return ol(l)?l:new st(l)}}),cb=en(function(r,s){return ei(s,function(l){l=Fi(l),Qi(r,l,rl(r[l],r))}),r});function db(r){var s=r==null?0:r.length,l=tt();return r=s?Nt(r,function(c){if(typeof c[1]!="function")throw new ii(h);return[l(c[0]),c[1]]}):[],dt(function(c){for(var _=-1;++_<s;){var g=r[_];if(Ge(g[0],this,c))return Ge(g[1],this,c)}})}function fb(r){return F0(ri(r,x))}function cl(r){return function(){return r}}function _b(r,s){return r==null||r!==r?s:r}var pb=Yd(),gb=Yd(!0);function Ie(r){return r}function dl(r){return bd(typeof r=="function"?r:ri(r,x))}function yb(r){return Cd(ri(r,x))}function vb(r,s){return Sd(r,ri(s,x))}var mb=dt(function(r,s){return function(l){return Rs(l,r,s)}}),wb=dt(function(r,s){return function(l){return Rs(r,l,s)}});function fl(r,s,l){var c=ce(s),_=Go(s,c);l==null&&!(Gt(s)&&(_.length||!c.length))&&(l=s,s=r,r=this,_=Go(s,ce(s)));var g=!(Gt(l)&&"chain"in l)||!!l.chain,v=rn(r);return ei(_,function(w){var C=s[w];r[w]=C,v&&(r.prototype[w]=function(){var A=this.__chain__;if(g||A){var M=r(this.__wrapped__),D=M.__actions__=Pe(this.__actions__);return D.push({func:C,args:arguments,thisArg:r}),M.__chain__=A,M}return C.apply(r,Rn([this.value()],arguments))})}),r}function xb(){return _e._===this&&(_e._=Xv),this}function _l(){}function bb(r){return r=ht(r),dt(function(s){return Td(s,r)})}var Eb=Vh(Nt),Cb=Vh(Xc),Sb=Vh(gh);function Vf(r){return Jh(r)?yh(Fi(r)):em(r)}function Tb(r){return function(s){return r==null?e:Qn(r,s)}}var Rb=Zd(),Lb=Zd(!0);function pl(){return[]}function gl(){return!1}function kb(){return{}}function Bb(){return""}function Ob(){return!0}function Pb(r,s){if(r=ht(r),r<1||r>vt)return[];var l=Vt,c=ye(r,Vt);s=tt(s),r-=Vt;for(var _=wh(c,s);++l<r;)s(l);return _}function Ab(r){return at(r)?Nt(r,Fi):Xe(r)?[r]:Pe(cf(Et(r)))}function Mb(r){var s=++Vv;return Et(r)+s}var Ib=jo(function(r,s){return r+s},0),Db=Yh("ceil"),Wb=jo(function(r,s){return r/s},1),Fb=Yh("floor");function $b(r){return r&&r.length?Uo(r,Ie,Oh):e}function zb(r,s){return r&&r.length?Uo(r,tt(s,2),Oh):e}function Hb(r){return jc(r,Ie)}function Nb(r,s){return jc(r,tt(s,2))}function Ub(r){return r&&r.length?Uo(r,Ie,Ih):e}function Gb(r,s){return r&&r.length?Uo(r,tt(s,2),Ih):e}var Vb=jo(function(r,s){return r*s},1),Yb=Yh("round"),Xb=jo(function(r,s){return r-s},0);function Zb(r){return r&&r.length?mh(r,Ie):0}function Kb(r,s){return r&&r.length?mh(r,tt(s,2)):0}return p.after=y1,p.ary=bf,p.assign=rx,p.assignIn=Df,p.assignInWith=la,p.assignWith=sx,p.at=ox,p.before=Ef,p.bind=rl,p.bindAll=cb,p.bindKey=Cf,p.castArray=k1,p.chain=mf,p.chunk=Fm,p.compact=$m,p.concat=zm,p.cond=db,p.conforms=fb,p.constant=cl,p.countBy=Zw,p.create=ax,p.curry=Sf,p.curryRight=Tf,p.debounce=Rf,p.defaults=hx,p.defaultsDeep=lx,p.defer=v1,p.delay=m1,p.difference=Hm,p.differenceBy=Nm,p.differenceWith=Um,p.drop=Gm,p.dropRight=Vm,p.dropRightWhile=Ym,p.dropWhile=Xm,p.fill=Zm,p.filter=jw,p.flatMap=Qw,p.flatMapDeep=t1,p.flatMapDepth=e1,p.flatten=pf,p.flattenDeep=Km,p.flattenDepth=jm,p.flip=w1,p.flow=pb,p.flowRight=gb,p.fromPairs=qm,p.functions=gx,p.functionsIn=yx,p.groupBy=i1,p.initial=Qm,p.intersection=tw,p.intersectionBy=ew,p.intersectionWith=iw,p.invert=mx,p.invertBy=wx,p.invokeMap=r1,p.iteratee=dl,p.keyBy=s1,p.keys=ce,p.keysIn=Me,p.map=na,p.mapKeys=bx,p.mapValues=Ex,p.matches=yb,p.matchesProperty=vb,p.memoize=sa,p.merge=Cx,p.mergeWith=Wf,p.method=mb,p.methodOf=wb,p.mixin=fl,p.negate=oa,p.nthArg=bb,p.omit=Sx,p.omitBy=Tx,p.once=x1,p.orderBy=o1,p.over=Eb,p.overArgs=b1,p.overEvery=Cb,p.overSome=Sb,p.partial=sl,p.partialRight=Lf,p.partition=a1,p.pick=Rx,p.pickBy=Ff,p.property=Vf,p.propertyOf=Tb,p.pull=ow,p.pullAll=yf,p.pullAllBy=aw,p.pullAllWith=hw,p.pullAt=lw,p.range=Rb,p.rangeRight=Lb,p.rearg=E1,p.reject=u1,p.remove=uw,p.rest=C1,p.reverse=il,p.sampleSize=d1,p.set=kx,p.setWith=Bx,p.shuffle=f1,p.slice=cw,p.sortBy=g1,p.sortedUniq=vw,p.sortedUniqBy=mw,p.split=Qx,p.spread=S1,p.tail=ww,p.take=xw,p.takeRight=bw,p.takeRightWhile=Ew,p.takeWhile=Cw,p.tap=$w,p.throttle=T1,p.thru=ia,p.toArray=Af,p.toPairs=$f,p.toPairsIn=zf,p.toPath=Ab,p.toPlainObject=If,p.transform=Ox,p.unary=R1,p.union=Sw,p.unionBy=Tw,p.unionWith=Rw,p.uniq=Lw,p.uniqBy=kw,p.uniqWith=Bw,p.unset=Px,p.unzip=nl,p.unzipWith=vf,p.update=Ax,p.updateWith=Mx,p.values=zr,p.valuesIn=Ix,p.without=Ow,p.words=Uf,p.wrap=L1,p.xor=Pw,p.xorBy=Aw,p.xorWith=Mw,p.zip=Iw,p.zipObject=Dw,p.zipObjectDeep=Ww,p.zipWith=Fw,p.entries=$f,p.entriesIn=zf,p.extend=Df,p.extendWith=la,fl(p,p),p.add=Ib,p.attempt=Gf,p.camelCase=$x,p.capitalize=Hf,p.ceil=Db,p.clamp=Dx,p.clone=B1,p.cloneDeep=P1,p.cloneDeepWith=A1,p.cloneWith=O1,p.conformsTo=M1,p.deburr=Nf,p.defaultTo=_b,p.divide=Wb,p.endsWith=zx,p.eq=wi,p.escape=Hx,p.escapeRegExp=Nx,p.every=Kw,p.find=qw,p.findIndex=ff,p.findKey=ux,p.findLast=Jw,p.findLastIndex=_f,p.findLastKey=cx,p.floor=Fb,p.forEach=wf,p.forEachRight=xf,p.forIn=dx,p.forInRight=fx,p.forOwn=_x,p.forOwnRight=px,p.get=hl,p.gt=I1,p.gte=D1,p.has=vx,p.hasIn=ll,p.head=gf,p.identity=Ie,p.includes=n1,p.indexOf=Jm,p.inRange=Wx,p.invoke=xx,p.isArguments=ir,p.isArray=at,p.isArrayBuffer=W1,p.isArrayLike=Ae,p.isArrayLikeObject=te,p.isBoolean=F1,p.isBuffer=Mn,p.isDate=$1,p.isElement=z1,p.isEmpty=H1,p.isEqual=N1,p.isEqualWith=U1,p.isError=ol,p.isFinite=G1,p.isFunction=rn,p.isInteger=kf,p.isLength=aa,p.isMap=Bf,p.isMatch=V1,p.isMatchWith=Y1,p.isNaN=X1,p.isNative=Z1,p.isNil=j1,p.isNull=K1,p.isNumber=Of,p.isObject=Gt,p.isObjectLike=Yt,p.isPlainObject=As,p.isRegExp=al,p.isSafeInteger=q1,p.isSet=Pf,p.isString=ha,p.isSymbol=Xe,p.isTypedArray=$r,p.isUndefined=J1,p.isWeakMap=Q1,p.isWeakSet=tx,p.join=nw,p.kebabCase=Ux,p.last=oi,p.lastIndexOf=rw,p.lowerCase=Gx,p.lowerFirst=Vx,p.lt=ex,p.lte=ix,p.max=$b,p.maxBy=zb,p.mean=Hb,p.meanBy=Nb,p.min=Ub,p.minBy=Gb,p.stubArray=pl,p.stubFalse=gl,p.stubObject=kb,p.stubString=Bb,p.stubTrue=Ob,p.multiply=Vb,p.nth=sw,p.noConflict=xb,p.noop=_l,p.now=ra,p.pad=Yx,p.padEnd=Xx,p.padStart=Zx,p.parseInt=Kx,p.random=Fx,p.reduce=h1,p.reduceRight=l1,p.repeat=jx,p.replace=qx,p.result=Lx,p.round=Yb,p.runInContext=b,p.sample=c1,p.size=_1,p.snakeCase=Jx,p.some=p1,p.sortedIndex=dw,p.sortedIndexBy=fw,p.sortedIndexOf=_w,p.sortedLastIndex=pw,p.sortedLastIndexBy=gw,p.sortedLastIndexOf=yw,p.startCase=tb,p.startsWith=eb,p.subtract=Xb,p.sum=Zb,p.sumBy=Kb,p.template=ib,p.times=Pb,p.toFinite=sn,p.toInteger=ht,p.toLength=Mf,p.toLower=nb,p.toNumber=ai,p.toSafeInteger=nx,p.toString=Et,p.toUpper=rb,p.trim=sb,p.trimEnd=ob,p.trimStart=ab,p.truncate=hb,p.unescape=lb,p.uniqueId=Mb,p.upperCase=ub,p.upperFirst=ul,p.each=wf,p.eachRight=xf,p.first=gf,fl(p,function(){var r={};return Di(p,function(s,l){Rt.call(p.prototype,l)||(r[l]=s)}),r}(),{chain:!1}),p.VERSION=n,ei(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){p[r].placeholder=p}),ei(["drop","take"],function(r,s){gt.prototype[r]=function(l){l=l===e?1:oe(ht(l),0);var c=this.__filtered__&&!s?new gt(this):this.clone();return c.__filtered__?c.__takeCount__=ye(l,c.__takeCount__):c.__views__.push({size:ye(l,Vt),type:r+(c.__dir__<0?"Right":"")}),c},gt.prototype[r+"Right"]=function(l){return this.reverse()[r](l).reverse()}}),ei(["filter","map","takeWhile"],function(r,s){var l=s+1,c=l==Dt||l==le;gt.prototype[r]=function(_){var g=this.clone();return g.__iteratees__.push({iteratee:tt(_,3),type:l}),g.__filtered__=g.__filtered__||c,g}}),ei(["head","last"],function(r,s){var l="take"+(s?"Right":"");gt.prototype[r]=function(){return this[l](1).value()[0]}}),ei(["initial","tail"],function(r,s){var l="drop"+(s?"":"Right");gt.prototype[r]=function(){return this.__filtered__?new gt(this):this[l](1)}}),gt.prototype.compact=function(){return this.filter(Ie)},gt.prototype.find=function(r){return this.filter(r).head()},gt.prototype.findLast=function(r){return this.reverse().find(r)},gt.prototype.invokeMap=dt(function(r,s){return typeof r=="function"?new gt(this):this.map(function(l){return Rs(l,r,s)})}),gt.prototype.reject=function(r){return this.filter(oa(tt(r)))},gt.prototype.slice=function(r,s){r=ht(r);var l=this;return l.__filtered__&&(r>0||s<0)?new gt(l):(r<0?l=l.takeRight(-r):r&&(l=l.drop(r)),s!==e&&(s=ht(s),l=s<0?l.dropRight(-s):l.take(s-r)),l)},gt.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},gt.prototype.toArray=function(){return this.take(Vt)},Di(gt.prototype,function(r,s){var l=/^(?:filter|find|map|reject)|While$/.test(s),c=/^(?:head|last)$/.test(s),_=p[c?"take"+(s=="last"?"Right":""):s],g=c||/^find/.test(s);_&&(p.prototype[s]=function(){var v=this.__wrapped__,w=c?[1]:arguments,C=v instanceof gt,A=w[0],M=C||at(v),D=function(_t){var yt=_.apply(p,Rn([_t],w));return c&&H?yt[0]:yt};M&&l&&typeof A=="function"&&A.length!=1&&(C=M=!1);var H=this.__chain__,Y=!!this.__actions__.length,et=g&&!H,lt=C&&!Y;if(!g&&M){v=lt?v:new gt(this);var it=r.apply(v,w);return it.__actions__.push({func:ia,args:[D],thisArg:e}),new ni(it,H)}return et&&lt?r.apply(this,w):(it=this.thru(D),et?c?it.value()[0]:it.value():it)})}),ei(["pop","push","shift","sort","splice","unshift"],function(r){var s=Lo[r],l=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",c=/^(?:pop|shift)$/.test(r);p.prototype[r]=function(){var _=arguments;if(c&&!this.__chain__){var g=this.value();return s.apply(at(g)?g:[],_)}return this[l](function(v){return s.apply(at(v)?v:[],_)})}}),Di(gt.prototype,function(r,s){var l=p[s];if(l){var c=l.name+"";Rt.call(Mr,c)||(Mr[c]=[]),Mr[c].push({name:s,func:l})}}),Mr[Ko(e,$).name]=[{name:"wrapper",func:e}],gt.prototype.clone=l0,gt.prototype.reverse=u0,gt.prototype.value=c0,p.prototype.at=zw,p.prototype.chain=Hw,p.prototype.commit=Nw,p.prototype.next=Uw,p.prototype.plant=Vw,p.prototype.reverse=Yw,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Xw,p.prototype.first=p.prototype.head,ws&&(p.prototype[ws]=Gw),p},Or=Nv();Zn?((Zn.exports=Or)._=Or,dh._=Or):_e._=Or}).call(Js)})(Ga,Ga.exports);var bO=Ga.exports,uy={exports:{}},EO=uy.exports={};EO.forEach=function(i,t){for(var e=0;e<i.length;e++){var n=t(i[e]);if(n)return n}};var cy=uy.exports,CO=function(i){var t=i.stateHandler.getState;function e(h){var u=t(h);return u&&!!u.isDetectable}function n(h){t(h).isDetectable=!0}function o(h){return!!t(h).busy}function a(h,u){t(h).busy=!!u}return{isDetectable:e,markAsDetectable:n,isBusy:o,markBusy:a}},SO=function(i){var t={};function e(h){var u=i.get(h);return u===void 0?[]:t[u]||[]}function n(h,u){var d=i.get(h);t[d]||(t[d]=[]),t[d].push(u)}function o(h,u){for(var d=e(h),f=0,y=d.length;f<y;++f)if(d[f]===u){d.splice(f,1);break}}function a(h){var u=e(h);u&&(u.length=0)}return{get:e,add:n,removeListener:o,removeAllListeners:a}},TO=function(){var i=1;function t(){return i++}return{generate:t}},RO=function(i){var t=i.idGenerator,e=i.stateHandler.getState;function n(a){var h=e(a);return h&&h.id!==void 0?h.id:null}function o(a){var h=e(a);if(!h)throw new Error("setId required the element to have a resize detection state.");var u=t.generate();return h.id=u,u}return{get:n,set:o}},LO=function(i){function t(){}var e={log:t,warn:t,error:t};if(!i&&window.console){var n=function(o,a){o[a]=function(){var u=console[a];if(u.apply)u.apply(console,arguments);else for(var d=0;d<arguments.length;d++)u(arguments[d])}};n(e,"log"),n(e,"warn"),n(e,"error")}return e},dy={exports:{}},fy=dy.exports={};fy.isIE=function(i){function t(){var n=navigator.userAgent.toLowerCase();return n.indexOf("msie")!==-1||n.indexOf("trident")!==-1||n.indexOf(" edge/")!==-1}if(!t())return!1;if(!i)return!0;var e=function(){var n,o=3,a=document.createElement("div"),h=a.getElementsByTagName("i");do a.innerHTML="<!--[if gt IE "+ ++o+"]><i></i><![endif]-->";while(h[0]);return o>4?o:n}();return i===e};fy.isLegacyOpera=function(){return!!window.opera};var _y=dy.exports,py={exports:{}},kO=py.exports={};kO.getOption=BO;function BO(i,t,e){var n=i[t];return n==null&&e!==void 0?e:n}var OO=py.exports,ig=OO,PO=function(t){t=t||{};var e=t.reporter,n=ig.getOption(t,"async",!0),o=ig.getOption(t,"auto",!0);o&&!n&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),n=!0);var a=ng(),h,u=!1;function d(S,B){!u&&o&&n&&a.size()===0&&x(),a.add(S,B)}function f(){for(u=!0;a.size();){var S=a;a=ng(),S.process()}u=!1}function y(S){u||(S===void 0&&(S=n),h&&(E(h),h=null),S?x():f())}function x(){h=m(f)}function E(S){var B=clearTimeout;return B(S)}function m(S){var B=function(P){return setTimeout(P,0)};return B(S)}return{add:d,force:y}};function ng(){var i={},t=0,e=0,n=0;function o(u,d){d||(d=u,u=0),u>e?e=u:u<n&&(n=u),i[u]||(i[u]=[]),i[u].push(d),t++}function a(){for(var u=n;u<=e;u++)for(var d=i[u],f=0;f<d.length;f++){var y=d[f];y()}}function h(){return t}return{add:o,process:a,size:h}}var gc="_erd";function AO(i){return i[gc]={},gy(i)}function gy(i){return i[gc]}function MO(i){delete i[gc]}var IO={initState:AO,getState:gy,cleanState:MO},Qs=_y,DO=function(i){i=i||{};var t=i.reporter,e=i.batchProcessor,n=i.stateHandler.getState;if(!t)throw new Error("Missing required dependency: reporter.");function o(f,y){function x(){y(f)}if(Qs.isIE(8))n(f).object={proxy:x},f.attachEvent("onresize",x);else{var E=u(f);if(!E)throw new Error("Element is not detectable by this strategy.");E.contentDocument.defaultView.addEventListener("resize",x)}}function a(f){var y=i.important?" !important; ":"; ";return(f.join(y)+y).trim()}function h(f,y,x){x||(x=y,y=f,f=null),f=f||{},f.debug;function E(m,S){var B=a(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),P=!1,$=window.getComputedStyle(m),I=m.offsetWidth,F=m.offsetHeight;n(m).startSize={width:I,height:F};function L(){function T(){if($.position==="static"){m.style.setProperty("position","relative",f.important?"important":"");var nt=function(pt,Q,J,Z){function ct(Wt){return Wt.replace(/[^-\d\.]/g,"")}var Dt=J[Z];Dt!=="auto"&&ct(Dt)!=="0"&&(pt.warn("An element that is positioned static has style."+Z+"="+Dt+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Z+" will be set to 0. Element: ",Q),Q.style.setProperty(Z,"0",f.important?"important":""))};nt(t,m,$,"top"),nt(t,m,$,"right"),nt(t,m,$,"bottom"),nt(t,m,$,"left")}}function U(){P||T();function nt(Q,J){if(!Q.contentDocument){var Z=n(Q);Z.checkForObjectDocumentTimeoutId&&window.clearTimeout(Z.checkForObjectDocumentTimeoutId),Z.checkForObjectDocumentTimeoutId=setTimeout(function(){Z.checkForObjectDocumentTimeoutId=0,nt(Q,J)},100);return}J(Q.contentDocument)}var pt=this;nt(pt,function(J){S(m)})}$.position!==""&&(T(),P=!0);var W=document.createElement("object");W.style.cssText=B,W.tabIndex=-1,W.type="text/html",W.setAttribute("aria-hidden","true"),W.onload=U,Qs.isIE()||(W.data="about:blank"),n(m)&&(m.appendChild(W),n(m).object=W,Qs.isIE()&&(W.data="about:blank"))}e?e.add(L):L()}Qs.isIE(8)?x(y):E(y,x)}function u(f){return n(f).object}function d(f){if(n(f)){var y=u(f);y&&(Qs.isIE(8)?f.detachEvent("onresize",y.proxy):f.removeChild(y),n(f).checkForObjectDocumentTimeoutId&&window.clearTimeout(n(f).checkForObjectDocumentTimeoutId),delete n(f).object)}}return{makeDetectable:h,addListener:o,uninstall:d}},WO=cy.forEach,FO=function(i){i=i||{};var t=i.reporter,e=i.batchProcessor,n=i.stateHandler.getState;i.stateHandler.hasState;var o=i.idHandler;if(!e)throw new Error("Missing required dependency: batchProcessor");if(!t)throw new Error("Missing required dependency: reporter.");var a=y(),h="erd_scroll_detection_scrollbar_style",u="erd_scroll_detection_container";function d(L){x(L,h,u)}d(window.document);function f(L){var T=i.important?" !important; ":"; ";return(L.join(T)+T).trim()}function y(){var L=500,T=500,U=document.createElement("div");U.style.cssText=f(["position: absolute","width: "+L*2+"px","height: "+T*2+"px","visibility: hidden","margin: 0","padding: 0"]);var W=document.createElement("div");W.style.cssText=f(["position: absolute","width: "+L+"px","height: "+T+"px","overflow: scroll","visibility: none","top: "+-L*3+"px","left: "+-T*3+"px","visibility: hidden","margin: 0","padding: 0"]),W.appendChild(U),document.body.insertBefore(W,document.body.firstChild);var nt=L-W.clientWidth,pt=T-W.clientHeight;return document.body.removeChild(W),{width:nt,height:pt}}function x(L,T,U){function W(J,Z){Z=Z||function(Dt){L.head.appendChild(Dt)};var ct=L.createElement("style");return ct.innerHTML=J,ct.id=T,Z(ct),ct}if(!L.getElementById(T)){var nt=U+"_animation",pt=U+"_animation_active",Q=`/* Created by the element-resize-detector library. */
`;Q+="."+U+" > div::-webkit-scrollbar { "+f(["display: none"])+` }

`,Q+="."+pt+" { "+f(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+nt,"animation-name: "+nt])+` }
`,Q+="@-webkit-keyframes "+nt+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,Q+="@keyframes "+nt+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",W(Q)}}function E(L){L.className+=" "+u+"_animation_active"}function m(L,T,U){if(L.addEventListener)L.addEventListener(T,U);else if(L.attachEvent)L.attachEvent("on"+T,U);else return t.error("[scroll] Don't know how to add event listeners.")}function S(L,T,U){if(L.removeEventListener)L.removeEventListener(T,U);else if(L.detachEvent)L.detachEvent("on"+T,U);else return t.error("[scroll] Don't know how to remove event listeners.")}function B(L){return n(L).container.childNodes[0].childNodes[0].childNodes[0]}function P(L){return n(L).container.childNodes[0].childNodes[0].childNodes[1]}function $(L,T){var U=n(L).listeners;if(!U.push)throw new Error("Cannot add listener to an element that is not detectable.");n(L).listeners.push(T)}function I(L,T,U){U||(U=T,T=L,L=null),L=L||{};function W(){if(L.debug){var G=Array.prototype.slice.call(arguments);if(G.unshift(o.get(T),"Scroll: "),t.log.apply)t.log.apply(null,G);else for(var mt=0;mt<G.length;mt++)t.log(G[mt])}}function nt(G){function mt(Ot){var be=Ot.getRootNode&&Ot.getRootNode().contains(Ot);return Ot===Ot.ownerDocument.body||Ot.ownerDocument.body.contains(Ot)||be}return!mt(G)||window.getComputedStyle(G)===null}function pt(G){var mt=n(G).container.childNodes[0],Ot=window.getComputedStyle(mt);return!Ot.width||Ot.width.indexOf("px")===-1}function Q(){var G=window.getComputedStyle(T),mt={};return mt.position=G.position,mt.width=T.offsetWidth,mt.height=T.offsetHeight,mt.top=G.top,mt.right=G.right,mt.bottom=G.bottom,mt.left=G.left,mt.widthCSS=G.width,mt.heightCSS=G.height,mt}function J(){var G=Q();n(T).startSize={width:G.width,height:G.height},W("Element start size",n(T).startSize)}function Z(){n(T).listeners=[]}function ct(){if(W("storeStyle invoked."),!n(T)){W("Aborting because element has been uninstalled");return}var G=Q();n(T).style=G}function Dt(G,mt,Ot){n(G).lastWidth=mt,n(G).lastHeight=Ot}function Wt(G){return B(G).childNodes[0]}function le(){return 2*a.width+1}function ne(){return 2*a.height+1}function vt(G){return G+10+le()}function xe(G){return G+10+ne()}function gi(G){return G*2+le()}function Vt(G){return G*2+ne()}function Ki(G,mt,Ot){var be=B(G),Mi=P(G),ue=vt(mt),Je=xe(Ot),Ee=gi(mt),ft=Vt(Ot);be.scrollLeft=ue,be.scrollTop=Je,Mi.scrollLeft=Ee,Mi.scrollTop=ft}function Er(){var G=n(T).container;if(!G){G=document.createElement("div"),G.className=u,G.style.cssText=f(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),n(T).container=G,E(G),T.appendChild(G);var mt=function(){n(T).onRendered&&n(T).onRendered()};m(G,"animationstart",mt),n(T).onAnimationStart=mt}return G}function Cr(){function G(){var Ft=n(T).style;if(Ft.position==="static"){T.style.setProperty("position","relative",L.important?"important":"");var Ue=function(Ii,yi,gs,Sn){function ys(vs){return vs.replace(/[^-\d\.]/g,"")}var Xn=gs[Sn];Xn!=="auto"&&ys(Xn)!=="0"&&(Ii.warn("An element that is positioned static has style."+Sn+"="+Xn+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Sn+" will be set to 0. Element: ",yi),yi.style[Sn]=0)};Ue(t,T,Ft,"top"),Ue(t,T,Ft,"right"),Ue(t,T,Ft,"bottom"),Ue(t,T,Ft,"left")}}function mt(Ft,Ue,Ii,yi){return Ft=Ft?Ft+"px":"0",Ue=Ue?Ue+"px":"0",Ii=Ii?Ii+"px":"0",yi=yi?yi+"px":"0",["left: "+Ft,"top: "+Ue,"right: "+yi,"bottom: "+Ii]}if(W("Injecting elements"),!n(T)){W("Aborting because element has been uninstalled");return}G();var Ot=n(T).container;Ot||(Ot=Er());var be=a.width,Mi=a.height,ue=f(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),Je=f(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(mt(-(1+be),-(1+Mi),-Mi,-be))),Ee=f(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ft=f(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Ce=f(["position: absolute","left: 0","top: 0"]),ji=f(["position: absolute","width: 200%","height: 200%"]),Se=document.createElement("div"),Qt=document.createElement("div"),Qe=document.createElement("div"),Yn=document.createElement("div"),Tr=document.createElement("div"),En=document.createElement("div");Se.dir="ltr",Se.style.cssText=ue,Se.className=u,Qt.className=u,Qt.style.cssText=Je,Qe.style.cssText=Ee,Yn.style.cssText=Ce,Tr.style.cssText=ft,En.style.cssText=ji,Qe.appendChild(Yn),Tr.appendChild(En),Qt.appendChild(Qe),Qt.appendChild(Tr),Se.appendChild(Qt),Ot.appendChild(Se);function xo(){var Ft=n(T);Ft&&Ft.onExpand?Ft.onExpand():W("Aborting expand scroll handler: element has been uninstalled")}function Cn(){var Ft=n(T);Ft&&Ft.onShrink?Ft.onShrink():W("Aborting shrink scroll handler: element has been uninstalled")}m(Qe,"scroll",xo),m(Tr,"scroll",Cn),n(T).onExpandScroll=xo,n(T).onShrinkScroll=Cn}function xn(){function G(Ee,ft,Ce){var ji=Wt(Ee),Se=vt(ft),Qt=xe(Ce);ji.style.setProperty("width",Se+"px",L.important?"important":""),ji.style.setProperty("height",Qt+"px",L.important?"important":"")}function mt(Ee){var ft=T.offsetWidth,Ce=T.offsetHeight,ji=ft!==n(T).lastWidth||Ce!==n(T).lastHeight;W("Storing current size",ft,Ce),Dt(T,ft,Ce),e.add(0,function(){if(ji){if(!n(T)){W("Aborting because element has been uninstalled");return}if(!Ot()){W("Aborting because element container has not been initialized");return}if(L.debug){var Qt=T.offsetWidth,Qe=T.offsetHeight;(Qt!==ft||Qe!==Ce)&&t.warn(o.get(T),"Scroll: Size changed before updating detector elements.")}G(T,ft,Ce)}}),e.add(1,function(){if(!n(T)){W("Aborting because element has been uninstalled");return}if(!Ot()){W("Aborting because element container has not been initialized");return}Ki(T,ft,Ce)}),ji&&Ee&&e.add(2,function(){if(!n(T)){W("Aborting because element has been uninstalled");return}if(!Ot()){W("Aborting because element container has not been initialized");return}Ee()})}function Ot(){return!!n(T).container}function be(){function Ee(){return n(T).lastNotifiedWidth===void 0}W("notifyListenersIfNeeded invoked");var ft=n(T);if(Ee()&&ft.lastWidth===ft.startSize.width&&ft.lastHeight===ft.startSize.height)return W("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(ft.lastWidth===ft.lastNotifiedWidth&&ft.lastHeight===ft.lastNotifiedHeight)return W("Not notifying: Size already notified");W("Current size not notified, notifying..."),ft.lastNotifiedWidth=ft.lastWidth,ft.lastNotifiedHeight=ft.lastHeight,WO(n(T).listeners,function(Ce){Ce(T)})}function Mi(){if(W("startanimation triggered."),pt(T)){W("Ignoring since element is still unrendered...");return}W("Element rendered.");var Ee=B(T),ft=P(T);(Ee.scrollLeft===0||Ee.scrollTop===0||ft.scrollLeft===0||ft.scrollTop===0)&&(W("Scrollbars out of sync. Updating detector elements..."),mt(be))}function ue(){if(W("Scroll detected."),pt(T)){W("Scroll event fired while unrendered. Ignoring...");return}mt(be)}if(W("registerListenersAndPositionElements invoked."),!n(T)){W("Aborting because element has been uninstalled");return}n(T).onRendered=Mi,n(T).onExpand=ue,n(T).onShrink=ue;var Je=n(T).style;G(T,Je.width,Je.height)}function Sr(){if(W("finalizeDomMutation invoked."),!n(T)){W("Aborting because element has been uninstalled");return}var G=n(T).style;Dt(T,G.width,G.height),Ki(T,G.width,G.height)}function nh(){U(T)}function bn(){W("Installing..."),Z(),J(),e.add(0,ct),e.add(1,Cr),e.add(2,xn),e.add(3,Sr),e.add(4,nh)}W("Making detectable..."),nt(T)?(W("Element is detached"),Er(),W("Waiting until element is attached..."),n(T).onRendered=function(){W("Element is now attached"),bn()}):bn()}function F(L){var T=n(L);T&&(T.onExpandScroll&&S(B(L),"scroll",T.onExpandScroll),T.onShrinkScroll&&S(P(L),"scroll",T.onShrinkScroll),T.onAnimationStart&&S(T.container,"animationstart",T.onAnimationStart),T.container&&L.removeChild(T.container))}return{makeDetectable:I,addListener:$,uninstall:F,initDocument:d}},to=cy.forEach,$O=CO,zO=SO,HO=TO,NO=RO,UO=LO,rg=_y,GO=PO,Fn=IO,VO=DO,YO=FO;function sg(i){return Array.isArray(i)||i.length!==void 0}function og(i){if(Array.isArray(i))return i;var t=[];return to(i,function(e){t.push(e)}),t}function ag(i){return i&&i.nodeType===1}var XO=function(i){i=i||{};var t;if(i.idHandler)t={get:function(I){return i.idHandler.get(I,!0)},set:i.idHandler.set};else{var e=HO(),n=NO({idGenerator:e,stateHandler:Fn});t=n}var o=i.reporter;if(!o){var a=o===!1;o=UO(a)}var h=$n(i,"batchProcessor",GO({reporter:o})),u={};u.callOnAdd=!!$n(i,"callOnAdd",!0),u.debug=!!$n(i,"debug",!1);var d=zO(t),f=$O({stateHandler:Fn}),y,x=$n(i,"strategy","object"),E=$n(i,"important",!1),m={reporter:o,batchProcessor:h,stateHandler:Fn,idHandler:t,important:E};if(x==="scroll"&&(rg.isLegacyOpera()?(o.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),x="object"):rg.isIE(9)&&(o.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),x="object")),x==="scroll")y=YO(m);else if(x==="object")y=VO(m);else throw new Error("Invalid strategy name: "+x);var S={};function B(I,F,L){function T(J){var Z=d.get(J);to(Z,function(Dt){Dt(J)})}function U(J,Z,ct){d.add(Z,ct),J&&ct(Z)}if(L||(L=F,F=I,I={}),!F)throw new Error("At least one element required.");if(!L)throw new Error("Listener required.");if(ag(F))F=[F];else if(sg(F))F=og(F);else return o.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var W=0,nt=$n(I,"callOnAdd",u.callOnAdd),pt=$n(I,"onReady",function(){}),Q=$n(I,"debug",u.debug);to(F,function(Z){Fn.getState(Z)||(Fn.initState(Z),t.set(Z));var ct=t.get(Z);if(Q&&o.log("Attaching listener to element",ct,Z),!f.isDetectable(Z)){if(Q&&o.log(ct,"Not detectable."),f.isBusy(Z)){Q&&o.log(ct,"System busy making it detectable"),U(nt,Z,L),S[ct]=S[ct]||[],S[ct].push(function(){W++,W===F.length&&pt()});return}return Q&&o.log(ct,"Making detectable..."),f.markBusy(Z,!0),y.makeDetectable({debug:Q,important:E},Z,function(Wt){if(Q&&o.log(ct,"onElementDetectable"),Fn.getState(Wt)){f.markAsDetectable(Wt),f.markBusy(Wt,!1),y.addListener(Wt,T),U(nt,Wt,L);var le=Fn.getState(Wt);if(le&&le.startSize){var ne=Wt.offsetWidth,vt=Wt.offsetHeight;(le.startSize.width!==ne||le.startSize.height!==vt)&&T(Wt)}S[ct]&&to(S[ct],function(xe){xe()})}else Q&&o.log(ct,"Element uninstalled before being detectable.");delete S[ct],W++,W===F.length&&pt()})}Q&&o.log(ct,"Already detecable, adding listener."),U(nt,Z,L),W++}),W===F.length&&pt()}function P(I){if(!I)return o.error("At least one element is required.");if(ag(I))I=[I];else if(sg(I))I=og(I);else return o.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");to(I,function(F){d.removeAllListeners(F),y.uninstall(F),Fn.cleanState(F)})}function $(I){y.initDocument&&y.initDocument(I)}return{listenTo:B,removeListener:d.removeListener,removeAllListeners:d.removeAllListeners,uninstall:P,initDocument:$}};function $n(i,t,e){var n=i[t];return n==null&&e!==void 0?e:n}const ZO=xO(XO),KO={id:"content",class:"draw"},jO={class:"draw-sidebar"},qO={class:"draw-box"},JO={class:"draw-header"},QO={class:"layout-content"},tP=Va({__name:"index",setup(i){const t=zn(null),e=ZO(),n=zn(null),o=zn("text"),a=zn(!0);eE(()=>{n.value=new wO("canvas"),h()}),iE(()=>a.value,u=>{const d=document.getElementById("content");if(!d)return;const f=d.offsetWidth,y=d.offsetHeight;let x=f-60;const E=y-60;u&&(x=x-260),n.value.getApp().app.resize({width:x,height:E})});const h=()=>{const u=bO.debounce((d,f)=>{n.value.getApp().app.resize({width:d-60-260,height:f-60})},100);e.listenTo(document.getElementById("content"),function(d){const f=d.offsetWidth,y=d.offsetHeight;u(f,y)})};return nE(()=>{e.uninstall(document.getElementById("content"))}),(u,d)=>{var y,x,E,m,S,B;const f=Yu("jy-icon");return Ri(),Hn("div",KO,[jt("div",jO,[(y=n.value)!=null&&y.getWorkspace()?(Ri(),yl(QB,{key:0,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=P=>o.value=P),workspace:(x=n.value)==null?void 0:x.getWorkspace()},null,8,["modelValue","workspace"])):vl("",!0)]),jt("div",qO,[jt("div",JO,[fr(fO)]),jt("div",QO,[jt("div",{class:lg(["layout-content-sidebar",{"layout-content-sidebar-active":!a.value}])},[fr(f,{class:"icon",type:"icon-right",onClick:d[1]||(d[1]=P=>a.value=!a.value)}),(E=n.value)!=null&&E.getWorkspace()&&o.value==="text"?(Ri(),yl(iO,{key:0,workspace:(m=n.value)==null?void 0:m.getWorkspace()},null,8,["workspace"])):vl("",!0),(S=n.value)!=null&&S.getWorkspace()&&o.value==="element"?(Ri(),yl(gO,{key:1,workspace:(B=n.value)==null?void 0:B.getWorkspace()},null,8,["workspace"])):vl("",!0)],2),jt("div",{id:"canvas",ref_key:"canvasRef",ref:t},null,512)])])])}}}),PP=_s(tP,[["__scopeId","data-v-eba691a5"]]);export{PP as default};
